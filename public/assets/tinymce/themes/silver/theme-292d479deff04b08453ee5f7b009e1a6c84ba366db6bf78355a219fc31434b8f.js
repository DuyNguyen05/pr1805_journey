!function(x){"use strict";function v(o){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=r.concat(t);return o.apply(null,e)}}function h(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&(e[o[r]]=t[o[r]])}return e}function o(t,n,e,o,r){return t(e,o)?tt.some(e):et(r)&&r(e)?tt.none():n(e,o,r)}function t(o,r){var t=function(t){var n=r(t);if(n<=0||null===n){var e=Uu(t,o);return parseFloat(e)||0}return n},i=function(r,t){return pt(t,function(t,n){var e=Uu(r,n),o=e===undefined?0:parseInt(e,10);return isNaN(o)?t:t+o},0)};return{set:function(t,n){if(!ot(n)&&!n.match(/^[0-9]+$/))throw new Error(o+".set accepts only positive integer values. Value was "+n);var e=t.dom();Hu(e)&&(e.style[o]=n+"px")},get:t,getOuter:t,aggregate:i,max:function(t,n,e){var o=i(t,e);return o<n?n-o:0}}}function e(t){return t.uid!==undefined}function c(r,i,u){var a=i.backstage;return{open:function(t,n){var e=function(){n(),Xg.hide(r)},o=ua(Zg.sketch({text:t.text,level:ut(["success","error","warning","info"],t.type)?t.type:undefined,progress:!0===t.progressBar,icon:tt.from(t.icon),onAction:e,iconProvider:a.shared.providers.icons,translationProvider:a.shared.providers.translate})),r=ua(Xg.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:i.backstage.shared.getSink,fireDismissalEventInstead:{}}));return u.add(r),t.timeout&&tp.setTimeout(function(){e()},t.timeout),{close:e,moveTo:function(t,n){Xg.showAt(r,{anchor:"makeshift",x:t,y:n},aa(o))},moveRel:function(){Xg.showAt(r,i.backstage.shared.anchors.banner(),aa(o))},text:function(t){Zg.updateText(o,t)},settings:t,getEl:function(){},progressBar:{value:function(t){Zg.updateProgress(o,t)}}}},close:function(t){t.close()},reposition:function(t){ft(t,function(t){t.moveTo(0,0)}),function(e){if(0<e.length){var t=e.slice(0,1)[0],n=(o=r).inline?o.getElement():o.getContentAreaContainer();t.moveRel(n,"tc-tc"),ft(e,function(t,n){0<n&&t.moveRel(e[n-1].getEl(),"bc-tc")})}var o}(t)},getArgs:function(t){return t.settings}}}function s(e,o){var r=null;return{cancel:function(){null!==r&&(x.clearTimeout(r),r=null)},schedule:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r=x.setTimeout(function(){e.apply(null,t),r=null},o)}}}function n(){var i={};return{registerId:function(o,r,t){Ft(t,function(t,n){var e=i[n]!==undefined?i[n]:{};e[r]=yu(t,o),i[n]=e})},unregisterId:function(n){Ft(i,function(t){t.hasOwnProperty(n)&&delete t[n]})},filterByType:function(t){return nn(i,t).map(function(t){return Rt(t,function(t,n){return bv(n,t)})}).getOr([])},find:function(t,n,e){var r=Zt(n)(i);return Fi(e,function(t){return e=r,ru(o=t).fold(function(){return tt.none()},function(t){var n=Zt(t);return e.bind(n).map(function(t){return vv(o,t)})});var e,o},t)}}}function b(){var o=n(),r={},i=function(o){var t=o.element();return ru(t).fold(function(){return t="uid-",n=o.element(),e=Vo(nu+t),ou(n,e),e;var t,n,e},function(t){return t})},u=function(t){ru(t.element()).each(function(t){delete r[t],o.unregisterId(t)})};return{find:function(t,n,e){return o.find(t,n,e)},filter:function(t){return o.filterByType(t)},register:function(t){var n=i(t);un(r,n)&&function(t,n){var e=r[n];if(e!==t)throw new Error('The tagId "'+n+'" is already used by: '+Co(e.element())+"\nCannot use it for: "+Co(t.element())+"\nThe conflicting element is"+(Ei(e.element())?" ":" not ")+"already in the DOM");u(t)}(t,n);var e=[t];o.registerId(e,n,t.events()),r[n]=t},unregister:u,getById:function(t){return Zt(t)(r)}}}function r(t,n){return u(x.document.createElement("canvas"),t,n)}function i(t){return t.getContext("2d")}function u(t,n,e){return t.width=n,t.height=e,t}function a(){return new(He.getOrDie("FileReader"))}function f(a){return new yS(function(t,n){function e(){u(),t(i)}function o(){u(),n("Unable to load data of type "+a.type+": "+r)}var r=x.URL.createObjectURL(a),i=new x.Image,u=function(){i.removeEventListener("load",e),i.removeEventListener("error",o)};i.addEventListener("load",e),i.addEventListener("error",o),i.src=r,i.complete&&e()})}function l(o){return new yS(function(t,e){var n=new x.XMLHttpRequest;n.open("GET",o,!0),n.responseType="blob",n.onload=function(){200==this.status&&t(this.response)},n.onerror=function(){var t,n=this;e(0===this.status?((t=new Error("No access to download image")).code=18,t.name="SecurityError",t):new Error("Error "+n.status+" downloading image"))},n.send()})}function d(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return tt.none();for(var o,r=e[1],i=n[1],u=xS.atob(i),a=u.length,c=Math.ceil(a/1024),s=new Array(c),f=0;f<c;++f){for(var l=1024*f,d=Math.min(l+1024,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=(o=m,new(He.getOrDie("Uint8Array"))(o))}return tt.some(function h(t,n){return new(He.getOrDie("Blob"))(t,n)}(s,{type:r}))}function m(e){return new yS(function(t,n){d(e).fold(function(){n("uri is not base64: "+e)},t)})}function g(e){return new yS(function(t){var n=a();n.onloadend=function(){t(n.result)},n.readAsDataURL(e)})}function p(t,n,e){function o(n,e){return t.then(function(t){return wS.canvasToDataURL(t,n,e)})}var r=n.type;return{getType:Z(r),toBlob:function i(){return yS.resolve(n)},toDataURL:function u(){return e},toBase64:function a(){return e.split(",")[1]},toAdjustedBlob:function c(n,e){return t.then(function(t){return wS.canvasToBlob(t,n,e)})},toAdjustedDataURL:o,toAdjustedBase64:function s(t,n){return o(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function f(){return t.then(vS.clone)}}}function y(n){return wS.blobToDataUri(n).then(function(t){return p(wS.blobToCanvas(n),n,t)})}function w(t,n,e){return e<(t=parseFloat(t))?t=e:t<n&&(t=n),t}function S(t,n){var e,o,r,i,u=[],a=new Array(10);for(e=0;e<5;e++){for(o=0;o<5;o++)u[o]=n[o+5*e];for(o=0;o<5;o++){for(r=i=0;r<5;r++)i+=t[o+5*r]*u[r];a[o+5*e]=i}}return a}function k(t,e){return e=w(e,0,1),t.map(function(t,n){return n%6==0?t=1-(1-t)*e:t*=e,w(t,0,1)})}function C(n,e){return n.toCanvas().then(function(t){return function i(t,n,e){var o,r=vS.get2dContext(t);return o=function B(t,n){var e,o,r,i,u,a=t.data,c=n[0],s=n[1],f=n[2],l=n[3],d=n[4],m=n[5],g=n[6],p=n[7],h=n[8],v=n[9],b=n[10],y=n[11],x=n[12],w=n[13],S=n[14],k=n[15],C=n[16],O=n[17],T=n[18],E=n[19];for(u=0;u<a.length;u+=4)e=a[u],o=a[u+1],r=a[u+2],i=a[u+3],a[u]=e*c+o*s+r*f+i*l+d,a[u+1]=e*m+o*g+r*p+i*h+v,a[u+2]=e*b+o*y+r*x+i*w+S,a[u+3]=e*k+o*C+r*O+i*T+E;return t}(r.getImageData(0,0,t.width,t.height),e),r.putImageData(o,0,0),SS.fromCanvas(t,n)}(t,n.getType(),e)})}function O(n,e){return n.toCanvas().then(function(t){return function i(t,n,e){var o,r=vS.get2dContext(t);return o=function x(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}var r,i,u,a,c,s,f,l,d,m,g,p,h,v,b,y;for(u=Math.round(Math.sqrt(e.length)),a=Math.floor(u/2),r=t.data,i=n.data,b=t.width,y=t.height,s=0;s<y;s++)for(c=0;c<b;c++){for(f=l=d=0,g=0;g<u;g++)for(m=0;m<u;m++)p=o(c+m-a,0,b-1),h=4*(o(s+g-a,0,y-1)*b+p),v=e[g*u+m],f+=r[h]*v,l+=r[h+1]*v,d+=r[h+2]*v;i[h=4*(s*b+c)]=o(f,0,255),i[h+1]=o(l,0,255),i[h+2]=o(d,0,255)}return n}(r.getImageData(0,0,t.width,t.height),o=r.getImageData(0,0,t.width,t.height),e),r.putImageData(o,0,0),SS.fromCanvas(t,n)}(t,n.getType(),e)})}function T(c){return function(n,e){return n.toCanvas().then(function(t){return function(t,n,e){var o,r,i=vS.get2dContext(t),u=new Array(256);for(r=0;r<u.length;r++)u[r]=c(r,e);return o=function a(t,n){var e,o=t.data;for(e=0;e<o.length;e+=4)o[e]=n[o[e]],o[e+1]=n[o[e+1]],o[e+2]=n[o[e+2]];return t}(i.getImageData(0,0,t.width,t.height),u),i.putImageData(o,0,0),SS.fromCanvas(t,n)}(t,n.getType(),e)})}}function E(e){return function(t,n){return C(t,e(OS.identity(),n))}}function B(n){return function(t){return O(t,n)}}function A(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function D(t,r){var i,u,n,a,c,f,l,d=r.document||x.document;r=r||{};var m=d.getElementById(r.handle||t);n=function(t){var n,e,o=function s(t){var n,e,o,r,i,u,a,c=Math.max;return n=t.documentElement,e=t.body,o=c(n.scrollWidth,e.scrollWidth),r=c(n.clientWidth,e.clientWidth),i=c(n.offsetWidth,e.offsetWidth),u=c(n.scrollHeight,e.scrollHeight),a=c(n.clientHeight,e.clientHeight),{width:o<i?r:o,height:u<c(n.offsetHeight,e.offsetHeight)?a:u}}(d);A(t),t.preventDefault(),u=t.button,n=m,f=t.screenX,l=t.screenY,e=x.window.getComputedStyle?x.window.getComputedStyle(n,null).getPropertyValue("cursor"):n.runtimeStyle.cursor,i=lk("<div></div>").css({position:"absolute",top:0,left:0,width:o.width,height:o.height,zIndex:2147483647,opacity:1e-4,cursor:e}).appendTo(d.body),lk(d).on("mousemove touchmove",c).on("mouseup touchend",a),r.start(t)},c=function(t){if(A(t),t.button!==u)return a(t);t.deltaX=t.screenX-f,t.deltaY=t.screenY-l,t.preventDefault(),r.drag(t)},a=function(t){A(t),lk(d).off("mousemove touchmove",c).off("mouseup touchend",a),i.remove(),r.stop&&r.stop(t)},this.destroy=function(){lk(m).off()},lk(m).on("mousedown touchstart",n)}var _,M,F,I,V,Q=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]},R=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e()}},H=function(e,o){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(o.apply(null,t))}},Z=function(t){return function(){return t}},U=function(t){return t},N=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return!e.apply(null,t)}},P=function(t){return function(){throw new Error(t)}},z=Z(!1),L=Z(!0),j=z,W=L,G=function(){return X},X=(I={fold:function(t){return t()},is:j,isSome:j,isNone:W,getOr:F=function(t){return t},getOrThunk:M=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:function(){return null},getOrUndefined:function(){return undefined},or:F,orThunk:M,map:G,ap:G,each:function(){},bind:G,flatten:G,exists:j,forall:W,filter:G,equals:_=function(t){return t.isNone()},equals_:_,toArray:function(){return[]},toString:Z("none()")},Object.freeze&&Object.freeze(I),I),Y=function(e){var t=function(){return e},n=function(){return r},o=function(t){return t(e)},r={fold:function(t,n){return n(e)},is:function(t){return e===t},isSome:W,isNone:j,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:n,orThunk:n,map:function(t){return Y(t(e))},ap:function(t){return t.fold(G,function(t){return Y(t(e))})},each:function(t){t(e)},bind:o,flatten:t,exists:o,forall:o,filter:function(t){return t(e)?r:X},equals:function(t){return t.is(e)},equals_:function(t,n){return t.fold(j,function(t){return n(e,t)})},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return r},tt={some:Y,none:G,from:function(t){return null===t||t===undefined?X:Y(t)}},q=function(n){return function(t){return function(t){if(null===t)return"null";var n=typeof t;return"object"===n&&Array.prototype.isPrototypeOf(t)?"array":"object"===n&&String.prototype.isPrototypeOf(t)?"string":n}(t)===n}},K=q("string"),J=q("object"),$=q("array"),nt=(q("null"),q("boolean")),et=(q("undefined"),q("function")),ot=q("number"),rt=(V=Array.prototype.indexOf)===undefined?function(t,n){return bt(t,n)}:function(t,n){return V.call(t,n)},it=function(t,n){var e=rt(t,n);return-1===e?tt.none():tt.some(e)},ut=function(t,n){return-1<rt(t,n)},at=function(t,n){return vt(t,n).isSome()},ct=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=t.slice(o,o+n);e.push(r)}return e},st=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r,t)}return o},ft=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e,t)},lt=function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e,t)},dt=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r,t)?e:o).push(u)}return{pass:e,fail:o}},mt=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o,t)&&e.push(i)}return e},gt=function(t,n,e){return lt(t,function(t){e=n(e,t)}),e},pt=function(t,n,e){return ft(t,function(t){e=n(e,t)}),e},ht=function(t,n){for(var e=0,o=t.length;e<o;e++){var r=t[e];if(n(r,e,t))return tt.some(r)}return tt.none()},vt=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e,t))return tt.some(e);return tt.none()},bt=function(t,n){for(var e=0,o=t.length;e<o;++e)if(t[e]===n)return e;return-1},yt=Array.prototype.push,xt=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!Array.prototype.isPrototypeOf(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);yt.apply(n,t[e])}return n},wt=function(t,n){var e=st(t,n);return xt(e)},St=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e,t))return!1;return!0},kt=Array.prototype.slice,Ct=function(t){var n=kt.call(t,0);return n.reverse(),n},Ot=function(t,n){return mt(t,function(t){return!ut(n,t)})},Tt=function(t){return[t]},Et=function(t,n){var e=kt.call(t,0);return e.sort(n),e},Bt=function(t){return 0===t.length?tt.none():tt.some(t[0])},At=function(t){return 0===t.length?tt.none():tt.some(t[t.length-1])},Dt=et(Array.from)?Array.from:function(t){return kt.call(t)},_t=Object.keys,Mt=Object.hasOwnProperty,Ft=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i,t)}},It=function(t,o){return Vt(t,function(t,n,e){return{k:n,v:o(t,n,e)}})},Vt=function(o,r){var i={};return Ft(o,function(t,n){var e=r(t,n,o);i[e.k]=e.v}),i},Rt=function(t,e){var o=[];return Ft(t,function(t,n){o.push(e(t,n))}),o},Ht=function(t,n){for(var e=_t(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return tt.some(u)}return tt.none()},Nt=function(t){return Rt(t,function(t){return t})},Pt=function(t,n){return zt(t,n)?tt.from(t[n]):tt.none()},zt=function(t,n){return Mt.call(t,n)},Lt=function(n){return function(t){return zt(t,n)?tt.from(t[n]):tt.none()}},jt=function(t,n){return Lt(n)(t)},Ut=function(t,n){var e={};return e[t]=n,e},Wt=function(e){return{is:function(t){return e===t},isValue:L,isError:z,getOr:Z(e),getOrThunk:Z(e),getOrDie:Z(e),or:function(){return Wt(e)},orThunk:function(){return Wt(e)},fold:function(t,n){return n(e)},map:function(t){return Wt(t(e))},mapError:function(){return Wt(e)},each:function(t){t(e)},bind:function(t){return t(e)},exists:function(t){return t(e)},forall:function(t){return t(e)},toOption:function(){return tt.some(e)}}},Gt=function(n){return{is:z,isValue:z,isError:L,getOr:U,getOrThunk:function(t){return t()},getOrDie:function(){return P(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t){return t(n)},map:function(){return Gt(n)},mapError:function(t){return Gt(t(n))},each:Q,bind:function(){return Gt(n)},exists:z,forall:L,toOption:tt.none}},Xt={value:Wt,error:Gt},Yt=function(u){if(!$(u))throw new Error("cases must be an array");if(0===u.length)throw new Error("there must be at least one case");var a=[],e={};return ft(u,function(t,o){var n=_t(t);if(1!==n.length)throw new Error("one and only one name per case");var r=n[0],i=t[r];if(e[r]!==undefined)throw new Error("duplicate key detected:"+r);if("cata"===r)throw new Error("cannot have a case named cata (sorry)");if(!$(i))throw new Error("case arguments must be an array");a.push(r),e[r]=function(){var t=arguments.length;if(t!==i.length)throw new Error("Wrong number of arguments to case "+r+". Expected "+i.length+" ("+i+"), got "+t);for(var e=new Array(t),n=0;n<e.length;n++)e[n]=arguments[n];return{fold:function(){if(arguments.length!==u.length)throw new Error("Wrong number of arguments to fold. Expected "+u.length+", got "+arguments.length);return arguments[o].apply(null,e)},match:function(t){var n=_t(t);if(a.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+a.join(",")+"\nActual: "+n.join(","));if(!St(a,function(t){return ut(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+a.join(", "));return t[r].apply(null,e)},log:function(t){x.console.log(t,{constructors:a,constructor:r,params:e})}}}}),e},qt=(Yt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),Object.prototype.hasOwnProperty),Kt=function(u){return function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},o=0;o<t.length;o++){var r=t[o];for(var i in r)qt.call(r,i)&&(e[i]=u(e[i],r[i]))}return e}},Jt=Kt(function(t,n){return J(t)&&J(n)?Jt(t,n):n}),$t=Kt(function(t,n){return n}),Qt=function(t,n){return e=n,o={},Ft(t,function(t,n){ut(e,n)||(o[n]=t)}),o;var e,o},Zt=function(t){return Lt(t)},tn=function(t,n){return e=t,o=n,function(t){return zt(t,e)?t[e]:o};var e,o},nn=function(t,n){return jt(t,n)},en=function(t,n){return Ut(t,n)},on=function(t){return n={},ft(t,function(t){n[t.key]=t.value}),n;var n},rn=function(t,n){var e,o,r,i,u,a=(e=[],o=[],ft(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,H(Xt.error,xt)(u)):(i=n,0===(r=a.values).length?Xt.value(i):Xt.value(Jt(i,$t.apply(undefined,r))))},un=function(t,n){return zt(e=t,o=n)&&e[o]!==undefined&&null!==e[o];var e,o},an=function(t){var n=t,e=function(){return n};return{get:e,set:function(t){n=t},clone:function(){return an(e())}}},cn=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},sn=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return tt.none()},fn=function(t,n){for(var e=[],o=0;o<t.length;o++){var r=t[o];if(!r.isSome())return tt.none();e.push(r.getOrDie())}return tt.some(n.apply(null,e))};(function VD(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=t.pop();return fn(t,e)});var ln,dn,mn=Z("touchstart"),gn=Z("touchmove"),pn=Z("touchend"),hn=Z("mousedown"),vn=Z("mousemove"),bn=Z("mouseout"),yn=Z("mouseup"),xn=Z("mouseover"),wn=Z("focusin"),Sn=Z("focusout"),kn=Z("keydown"),Cn=Z("keyup"),On=Z("input"),Tn=Z("change"),En=Z("click"),Bn=Z("transitionend"),An=Z("selectstart"),Dn=function(e){var o,r=!1;return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r||(r=!0,o=e.apply(null,t)),o}},_n=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}return undefined}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return Fn(o(1),o(2))},Mn=function(){return Fn(0,0)},Fn=function(t,n){return{major:t,minor:n}},In={nu:Fn,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Mn():_n(t,e)},unknown:Mn},Vn="Firefox",Rn=function(t,n){return function(){return n===t}},Hn=function(t){var n=t.current;return{current:n,version:t.version,isEdge:Rn("Edge",n),isChrome:Rn("Chrome",n),isIE:Rn("IE",n),isOpera:Rn("Opera",n),isFirefox:Rn(Vn,n),isSafari:Rn("Safari",n)}},Nn={unknown:function(){return Hn({current:undefined,version:In.unknown()})},nu:Hn,edge:Z("Edge"),chrome:Z("Chrome"),ie:Z("IE"),opera:Z("Opera"),firefox:Z(Vn),safari:Z("Safari")},Pn="Windows",zn="Android",Ln="Solaris",jn="FreeBSD",Un=function(t,n){return function(){return n===t}},Wn=function(t){var n=t.current;return{current:n,version:t.version,isWindows:Un(Pn,n),isiOS:Un("iOS",n),isAndroid:Un(zn,n),isOSX:Un("OSX",n),isLinux:Un("Linux",n),isSolaris:Un(Ln,n),isFreeBSD:Un(jn,n)}},Gn={unknown:function(){return Wn({current:undefined,version:In.unknown()})},nu:Wn,windows:Z(Pn),ios:Z("iOS"),android:Z(zn),linux:Z("Linux"),osx:Z("OSX"),solaris:Z(Ln),freebsd:Z(jn)},Xn=function(t,n){var e=String(n).toLowerCase();return ht(t,function(t){return t.search(e)})},Yn=function(t,e){return Xn(t,e).map(function(t){var n=In.detect(t.versionRegexes,e);return{current:t.name,version:n}})},qn=function(t,e){return Xn(t,e).map(function(t){var n=In.detect(t.versionRegexes,e);return{current:t.name,version:n}})},Kn=function(t,n){return-1!==t.indexOf(n)},Jn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,$n=function(n){return function(t){return Kn(t,n)}},Qn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Kn(t,"edge/")&&Kn(t,"chrome")&&Kn(t,"safari")&&Kn(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Jn],search:function(t){return Kn(t,"chrome")&&!Kn(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Kn(t,"msie")||Kn(t,"trident")}},{name:"Opera",versionRegexes:[Jn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:$n("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:$n("firefox")},{name:"Safari",versionRegexes:[Jn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Kn(t,"safari")||Kn(t,"mobile/"))&&Kn(t,"applewebkit")}}],Zn=[{name:"Windows",search:$n("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Kn(t,"iphone")||Kn(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:$n("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:$n("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:$n("linux"),versionRegexes:[]},{name:"Solaris",search:$n("sunos"),versionRegexes:[]},{name:"FreeBSD",search:$n("freebsd"),versionRegexes:[]}],te={browsers:Z(Qn),oses:Z(Zn)},ne=function(t){var n,e,o,r,i,u,a,c,s,f,l,d=te.browsers(),m=te.oses(),g=Yn(d,t).fold(Nn.unknown,Nn.nu),p=qn(m,t).fold(Gn.unknown,Gn.nu);return{browser:g,os:p,deviceType:(e=g,o=t,r=(n=p).isiOS()&&!0===/ipad/i.test(o),i=n.isiOS()&&!r,u=n.isAndroid()&&3===n.version.major,a=n.isAndroid()&&4===n.version.major,c=r||u||a&&!0===/mobile/i.test(o),s=n.isiOS()||n.isAndroid(),f=s&&!c,l=e.isSafari()&&n.isiOS()&&!1===/safari/i.test(o),{isiPad:Z(r),isiPhone:Z(i),isTablet:Z(c),isPhone:Z(f),isTouch:Z(s),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:Z(l)})}},ee={detect:Dn(function(){var t=x.navigator.userAgent;return ne(t)})},oe={tap:Z("alloy.tap")},re=Z("alloy.focus"),ie=Z("alloy.blur.post"),ue=Z("alloy.paste.post"),ae=Z("alloy.receive"),ce=Z("alloy.execute"),se=Z("alloy.focus.item"),fe=oe.tap,le=ee.detect().deviceType.isTouch()?oe.tap:En,de=Z("alloy.longpress"),me=Z("alloy.sandbox.close"),ge=Z("alloy.typeahead.cancel"),pe=Z("alloy.system.init"),he=Z("alloy.system.scroll"),ve=Z("alloy.system.resize"),be=Z("alloy.system.attached"),ye=Z("alloy.system.detached"),xe=Z("alloy.system.dismissRequested"),we=Z("alloy.focusmanager.shifted"),Se=Z("alloy.slotcontainer.visibility"),ke=Z("alloy.change.tab"),Ce=Z("alloy.dismiss.tab"),Oe=Z("alloy.highlight"),Te=Z("alloy.dehighlight"),Ee=function(t){if(null===t||t===undefined)throw new Error("Node cannot be null or undefined");return{dom:Z(t)}},Be={fromHtml:function(t,n){var e=(n||x.document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw x.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Ee(e.childNodes[0])},fromTag:function(t,n){var e=(n||x.document).createElement(t);return Ee(e)},fromText:function(t,n){var e=(n||x.document).createTextNode(t);return Ee(e)},fromDom:Ee,fromPoint:function(t,n,e){var o=t.dom();return tt.from(o.elementFromPoint(n,e)).map(Ee)}},Ae=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(n.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+e.length+" arguments");var o={};return ft(n,function(t,n){o[t]=Z(e[n])}),o}},De=function(t){return t.slice(0).sort()},Me=function(n,t){if(!$(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");ft(t,function(t){if(!K(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")})},Fe=function(r,i){var e,u=r.concat(i);if(0===u.length)throw new Error("You must specify at least one required or optional field.");return Me("required",r),Me("optional",i),e=De(u),ht(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}),function(n){var e=_t(n);St(r,function(t){return ut(e,t)})||function(t,n){throw new Error("All required keys ("+De(r).join(", ")+") were not specified. Specified keys were: "+De(n).join(", ")+".")}(0,e);var t=mt(e,function(t){return!ut(u,t)});0<t.length&&function(){throw new Error("Unsupported keys for object: "+De(t).join(", "))}();var o={};return ft(r,function(t){o[t]=Z(n[t])}),ft(i,function(t){o[t]=Z(Object.prototype.hasOwnProperty.call(n,t)?tt.some(n[t]):tt.none())}),o}},Ie="undefined"!=typeof x.window?x.window:Function("return this;")(),Ve=function(t,o){return function(t){for(var n=o!==undefined&&null!==o?o:Ie,e=0;e<t.length&&n!==undefined&&null!==n;++e)n=n[t[e]];return n}(t.split("."))},He={getOrDie:function(t,n){var e=Ve(t,n);if(e===undefined||null===e)throw t+" not available on this browser";return e}},Ne=(x.Node.ATTRIBUTE_NODE,x.Node.CDATA_SECTION_NODE,x.Node.COMMENT_NODE,x.Node.DOCUMENT_NODE),Pe=(x.Node.DOCUMENT_TYPE_NODE,x.Node.DOCUMENT_FRAGMENT_NODE,x.Node.ELEMENT_NODE),ze=x.Node.TEXT_NODE,Le=(x.Node.PROCESSING_INSTRUCTION_NODE,x.Node.ENTITY_REFERENCE_NODE,x.Node.ENTITY_NODE,x.Node.NOTATION_NODE,Pe),je=Ne,Ue=function(t,n){var e=t.dom();if(e.nodeType!==Le)return!1;if(e.matches!==undefined)return e.matches(n);if(e.msMatchesSelector!==undefined)return e.msMatchesSelector(n);if(e.webkitMatchesSelector!==undefined)return e.webkitMatchesSelector(n);if(e.mozMatchesSelector!==undefined)return e.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},We=function(t){return t.nodeType!==Le&&t.nodeType!==je||0===t.childElementCount},Ge=function(t,n){var e=n===undefined?x.document:n.dom();return We(e)?[]:st(e.querySelectorAll(t),Be.fromDom)},Xe=function(t,n){var e=n===undefined?x.document:n.dom();return We(e)?tt.none():tt.from(e.querySelector(t)).map(Be.fromDom)},Ye=function(t,n){return t.dom()===n.dom()},qe=(ee.detect().browser.isIE(),function(t){return Be.fromDom(t.dom().ownerDocument)}),Ke=function(t){var n=t.dom().ownerDocument.defaultView;return Be.fromDom(n)},Je=function(t){var n=t.dom();return tt.from(n.parentNode).map(Be.fromDom)},$e=function(t){var n=t.dom();return tt.from(n.offsetParent).map(Be.fromDom)},Qe=function(t){var n=t.dom();return st(n.childNodes,Be.fromDom)},Ze=function(t,n){var e=t.dom().childNodes;return tt.from(e[n]).map(Be.fromDom)},to=(Ae("element","offset"),function(n,e){Je(n).each(function(t){t.dom().insertBefore(e.dom(),n.dom())})}),no=function(t,n){var e;(e=t.dom(),tt.from(e.nextSibling).map(Be.fromDom)).fold(function(){Je(t).each(function(t){oo(t,n)})},function(t){to(t,n)})},eo=function(n,e){Ze(n,0).fold(function(){oo(n,e)},function(t){n.dom().insertBefore(e.dom(),t.dom())})},oo=function(t,n){t.dom().appendChild(n.dom())},ro=function(n,t){ft(t,function(t){oo(n,t)})},io=function(t){t.dom().textContent="",ft(Qe(t),function(t){uo(t)})},uo=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},ao=function(t){return t.dom().innerHTML},co=function(t,n){var e,o,r=qe(t).dom(),i=Be.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||x.document).createElement("div")).innerHTML=e,Qe(Be.fromDom(o)));ro(i,u),io(t),oo(t,i)},so=function(t){return t.dom().nodeName.toLowerCase()},fo=function(t){return t.dom().nodeType},lo=function(n){return function(t){return fo(t)===n}},mo=lo(Pe),go=lo(ze),po=lo(Ne),ho=function(t,n,e){if(!(K(e)||nt(e)||ot(e)))throw x.console.error("Invalid call to Attr.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},vo=function(t,n,e){ho(t.dom(),n,e)},bo=function(t,n){var e=t.dom();Ft(n,function(t,n){ho(e,n,t)})},yo=function(t,n){var e=t.dom().getAttribute(n);return null===e?undefined:e},xo=function(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},wo=function(t,n){t.dom().removeAttribute(n)},So=function(t){return n=t,e=!1,Be.fromDom(n.dom().cloneNode(e));var n,e},ko=function(t){var n,e,o;return n=So(t),e=Be.fromTag("div"),o=Be.fromDom(n.dom().cloneNode(!0)),oo(e,o),ao(e)},Co=function(t){return ko(t)},Oo="unknown",To="__CHROME_INSPECTOR_CONNECTION_TO_ALLOY__";(dn=ln||(ln={}))[dn.STOP=0]="STOP",dn[dn.NORMAL=1]="NORMAL",dn[dn.LOGGING=2]="LOGGING";var Eo=an({}),Bo=function(n,t,e){var o,r,i,u;switch(nn(Eo.get(),n).orThunk(function(){var t=_t(Eo.get());return sn(t,function(t){return-1<n.indexOf(t)?tt.some(Eo.get()[t]):tt.none()})}).getOr(ln.NORMAL)){case ln.NORMAL:return e(Fo());case ln.LOGGING:var a=(o=n,r=t,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();ut(["mousemove","mouseover","mouseout",pe()],o)||x.console.log(o,{event:o,time:t-u,target:r.dom(),sequence:st(i,function(t){return ut(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Co(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case ln.STOP:return!0}},Ao=["alloy/data/Fields","alloy/debugging/Debugging"],Do=function(t,n,e){return Bo(t,n,e)},_o=function(){if(x.window[To]!==undefined)return x.window[To];var n=function(t,n){var e=Eo.get();e[t]=n,Eo.set(e)};return x.window[To]={systems:{},lookup:function(n){var e=x.window[To].systems,t=_t(e);return sn(t,function(t){return e[t].getByUid(n).toOption().map(function(t){return en(Co(t.element()),(n=function(e){var t=e.spec();return{"(original.spec)":t,"(dom.ref)":e.element().dom(),"(element)":Co(e.element()),"(initComponents)":st(t.components!==undefined?t.components:[],n),"(components)":st(e.components(),n),"(bound.events)":Rt(e.events(),function(t,n){return[n]}).join(", "),"(behaviours)":t.behaviours!==undefined?It(t.behaviours,function(t,n){return t===undefined?"--revoked--":{config:t.configAsRaw(),"original-config":t.initialConfig,state:e.readState(n)}}):"none"}})(t));var n})}).orThunk(function(){return tt.some({error:"Systems ("+t.join(", ")+") did not contain uid: "+n})})},events:{setToNormal:function(t){n(t,ln.NORMAL)},setToLogging:function(t){n(t,ln.LOGGING)},setToStop:function(t){n(t,ln.STOP)}}},x.window[To]},Mo=function(t,n){_o().systems[t]=n},Fo=Z({logEventCut:Q,logEventStopped:Q,logNoParent:Q,logEventNoHandlers:Q,logEventResponse:Q,write:Q}),Io=0,Vo=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Io+String(n)},Ro=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Ho=function(){return(Ho=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};(function RD(t,n){function e(){this.constructor=t}Re(t,n),t.prototype=null===n?Object.create(n):(n.prototype,new e)}),function HD(t,n,e,o){var r,i=arguments.length,u=i<3?n:null===o?Object.getOwnPropertyDescriptor(n,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Reflect.decorate(t,n,e,o);else for(var a=t.length-1;0<=a;a--)t[a]&&(i<3?r(u):3<i?r(n,e,u):r(n,e));return 3<i&&u&&Object.defineProperty(n,e,u),u},function ND(e,o){return function(t,n){o(t,n,e)}},function PD(t,n){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,n)},function zD(i,u,a,c){return new(a||Promise)(function(t,n){function e(t){try{r(c.next(t))}catch(i){n(i)}}function o(t){try{r(c["throw"](t))}catch(i){n(i)}}function r(n){n.done?t(n.value):new a(function(t){t(n.value)}).then(e,o)}r(c.apply(i,u||[]).next())})},function LD(o,r){function t(e){return function(t){return function M(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(u&&(2&n[0]?u["return"]:n[0]?u["throw"]||(u["return"]&&a.call(u),0):u.next)&&!a.call(u,n[1]).done)return a;switch(a&&(n[0],a.value),n[0]){case 0:case 1:break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,n[1];continue;case 7:c.ops.pop(),c.trys.pop();continue;default:if(!(0<c.trys.length&&a[a.length-1]||6!==n[0]&&2!==n[0]))continue;if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1];break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop()
;continue}r.call(o,c)}catch(e){}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([e,t])}}var i,u,a,n,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return t(0),t(1),t(2),"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n},function jD(t,n){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])},function UD(){for(var t=[],n=0;n<arguments.length;n++)t.concat(af(arguments[n]));return t},function WD(t,n,e){function o(o){s[o]&&(c[o]=function(e){return new Promise(function(t,n){1<f.push([o,e,t,n])||r(o,e)})})}function r(t,n){try{!function e(t){t.value instanceof cf?Promise.resolve(t.value.v).then(i,u):a(f[0][2],t)}(s[t](n))}catch(o){a(f[0][3],o)}}function i(t){r("next",t)}function u(t){r("throw",t)}function a(t,n){t(n),f.shift(),f.length&&r(f[0][0],f[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,s=e.apply(t,n||[]),f=[];return o("next"),o("throw"),o("return"),c[Symbol.asyncIterator]=function(){return this},c},function GD(o){function t(n,e){r[n]=o[n]?function(t){return i?e?e(t):t:{value:cf(o[n](t)),done:"return"===n}}:e}var r,i;return t("next"),t("throw",function(t){throw t}),t("return"),r[Symbol.iterator]=function(){return this},r},function XD(i){function t(o){n[o]=i[o]&&function(e){return new Promise(function(t,n){!function r(n,t,e,o){Promise.resolve(o).then(function(t){n({value:t,done:e})},t)}(t,n,i[o](e).done,e.value)})}}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,e=i[Symbol.asyncIterator];return e?e.call(i):(_e(),t("next"),t("throw"),t("return"),n[Symbol.asyncIterator]=function(){return this},n)},function YD(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},function qD(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n["default"]=t,n},function KD(t){return t&&t.__esModule?t:{"default":t}};var No,Po,zo=Yt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Lo=function(t){return zo.defaultedThunk(Z(t))},jo=zo.strict,Uo=zo.asOption,Wo=zo.defaultedThunk,Go=zo.mergeWithThunk;(Po=No||(No={}))[Po.Error=0]="Error",Po[Po.Value=1]="Value";var Xo,Yo,qo,Ko=function(t,n,e){return t.stype===No.Error?n(t.serror):e(t.svalue)},Jo=function(t){return{stype:No.Value,svalue:t}},$o=function(t){return{stype:No.Error,serror:t}},Qo=function(t){return t.fold($o,Jo)},Zo=function(t){return Ko(t,Xt.error,Xt.value)},tr=Jo,nr=function(t){var n=[],e=[];return ft(t,function(t){Ko(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},er=$o,or=function(t,n){return t.stype===No.Value?n(t.svalue):t},rr=function(t,n){return t.stype===No.Error?n(t.serror):t},ir=function(t,n){return t.stype===No.Value?{stype:No.Value,svalue:n(t.svalue)}:t},ur=function(t,n){return t.stype===No.Error?{stype:No.Error,serror:n(t.serror)}:t},ar=function(t){return H(er,xt)(t)},cr=function(t,n){var e,o,r=nr(t);return 0<r.errors.length?ar(r.errors):(o=n,0<(e=r.values).length?tr(Jt(o,$t.apply(undefined,e))):tr(o))},sr=function(t){var n=nr(t);return 0<n.errors.length?ar(n.errors):tr(n.values)},fr=Yt([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),lr=Yt([{field:["name","presence","type"]},{state:["name"]}]),dr=function(){return He.getOrDie("JSON")},mr=function(t,n,e){return dr().stringify(t,n,e)},gr=function(t){return J(t)&&100<_t(t).length?" removed due to size":mr(t,null,2)},pr=function(t,n){return er([{path:t,getErrorInfo:n}])},hr=Yt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),vr=function(e,o,r){return jt(o,r).fold(function(){return t=r,n=o,pr(e,function(){return'Could not find valid *strict* value for "'+t+'" in '+gr(n)});var t,n},tr)},br=function(t,n,e){var o=jt(t,n).fold(function(){return e(t)},U);return tr(o)},yr=function(a,c,t,s){return t.fold(function(r,e,t,o){var i=function(t){var n=o.extract(a.concat([r]),s,t);return ir(n,function(t){return Ut(e,s(t))})},u=function(t){return t.fold(function(){var t=Ut(e,s(tt.none()));return tr(t)},function(t){var n=o.extract(a.concat([r]),s,t);return ir(n,function(t){return Ut(e,s(tt.some(t)))})})};return t.fold(function(){return or(vr(a,c,r),i)},function(t){return or(br(c,r,t),i)},function(){return or(tr(jt(c,r)),u)},function(t){return or((e=t,o=jt(n=c,r).map(function(t){return!0===t?e(n):t}),tr(o)),u);var n,e,o},function(t){var n=t(c),e=ir(br(c,r,Z({})),function(t){return Jt(n,t)});return or(e,i)})},function(t,n){var e=n(c);return tr(Ut(t,s(e)))})},xr=function(o){return{extract:function(e,t,n){return rr(o(n,t),function(t){return n=t,pr(e,function(){return n});var n})},toString:function(){return"val"},toDsl:function(){return fr.itemOf(o)}}},wr=function(t){var c=Sr(t),s=gt(t,function(n,t){return t.fold(function(t){return Jt(n,en(t,!0))},Z(n))},{});return{extract:function(t,n,e){var o,r,i,u=nt(e)?[]:(r=_t(o=e),mt(r,function(t){return un(o,t)})),a=mt(u,function(t){return!un(s,t)});return 0===a.length?c.extract(t,n,e):(i=a,pr(t,function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"}))},toString:c.toString,toDsl:c.toDsl}},Sr=function(a){return{extract:function(t,n,e){return o=t,r=e,i=n,u=st(a,function(t){return yr(o,r,t,i)}),cr(u,{});var o,r,i,u},toString:function(){return"obj{\n"+st(a,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t){return"state("+t+")"})}).join("\n")+"}"},toDsl:function(){return fr.objOf(st(a,function(t){return t.fold(function(t,n,e,o){return lr.field(t,e,o)},function(t){return lr.state(t)})}))}}},kr=function(r){return{extract:function(e,o,t){var n=st(t,function(t,n){return r.extract(e.concat(["["+n+"]"]),o,t)});return sr(n)},toString:function(){return"array("+r.toString()+")"},toDsl:function(){return fr.arrOf(r)}}},Cr=function(a,c){return{extract:function(e,o,r){var t,n,i=_t(r),u=(t=e,n=i,kr(xr(a)).extract(t,U,n));return or(u,function(t){var n=st(t,function(t){return hr.field(t,t,jo(),c)});return Sr(n).extract(e,o,r)})},toString:function(){return"setOf("+c.toString()+")"},toDsl:function(){return fr.setOf(a,c)}}},Or=Z(xr(tr)),Tr=H(kr,Sr),Er=hr.state,Br=hr.field,Ar=function(e,n,o,r,i){return nn(r,i).fold(function(){return t=r,n=i,pr(e,function(){return'The chosen schema: "'+n+'" did not exist in branches: '+gr(t)});var t,n},function(t){return Sr(t).extract(e.concat(["branch: "+i]),n,o)})},Dr=function(r,i){return{extract:function(n,e,o){return nn(o,r).fold(function(){return t=r,pr(n,function(){return'Choice schema did not contain choice key: "'+t+'"'});var t},function(t){return Ar(n,e,o,i,t)})},toString:function(){return"chooseOn("+r+"). Possible values: "+_t(i)},toDsl:function(){return fr.choiceOf(r,i)}}},_r=xr(tr),Mr=function(t){return Tr(t)},Fr=function(){return kr(_r)},Ir=function(n){return xr(function(t){return n(t).fold(er,tr)})},Vr=function(n,t){return Cr(function(t){return Qo(n(t))},t)},Rr=function(t,n,e,o){var r=n.extract([t],e,o);return ur(r,function(t){return{input:o,errors:t}})},Hr=function(t,n,e){return Zo(Rr(t,n,U,e))},Nr=function(t){return t.fold(function(t){throw new Error(zr(t))},U)},Pr=function(t,n,e){return Nr(Hr(t,n,e))},zr=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,st(e,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))+"\n\nInput object: "+gr(t.input);var n,e},Lr=function(t,n){return Dr(t,n)},jr=Z(_r),Ur=function(e,o){return xr(function(t){var n=typeof t;return e(t)?tr(t):er("Expected type: "+o+" but got: "+n)})},Wr=Ur(ot,"number"),Gr=Ur(K,"string"),Xr=Ur(nt,"boolean"),Yr=Ur(et,"function"),qr=function(n){return Ir(function(t){return ut(n,t)?Xt.value(t):Xt.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')})},Kr=function(t){return Br(t,t,jo(),Or())},Jr=function(t,n){return Br(t,t,jo(),n)},$r=function(t){return Jr(t,Gr)},Qr=function(t,n){return Br(t,t,jo(),qr(n))},Zr=function(t){return Jr(t,Yr)},ti=function(t,n){return Br(t,t,jo(),Sr(n))},ni=function(t,n){return Br(t,t,jo(),Tr(n))},ei=function(t,n){return Br(t,t,jo(),kr(n))},oi=function(t){return Br(t,t,Uo(),Or())},ri=function(t,n){return Br(t,t,Uo(),n)},ii=function(t){return ri(t,Wr)},ui=function(t){return ri(t,Gr)},ai=function(t){return ri(t,Yr)},ci=function(t,n){return ri(t,Sr(n))},si=function(t,n){return Br(t,t,Lo(n),Or())},fi=function(t,n,e){return Br(t,t,Lo(n),e)},li=function(t,n){return fi(t,n,Wr)},di=function(t,n){return fi(t,n,Gr)},mi=function(t,n,e){return fi(t,n,qr(e))},gi=function(t,n){return fi(t,n,Xr)},pi=function(t,n){return fi(t,n,Yr)},hi=function(t,n,e){return fi(t,n,Sr(e))},vi=function(t,n){return Er(t,n)},bi=function(t,n){return Ye(t.element(),n.event().target())},yi=function(t){if(!un(t,"can")&&!un(t,"abort")&&!un(t,"run"))throw new Error("EventHandler defined by: "+mr(t,null,2)+" does not have can, abort, or run!");return Pr("Extracting event.handler",wr([si("can",Z(!0)),si("abort",Z(!1)),si("run",Q)]),t)},xi=function(e){var n,o,r,i,t=(n=e,o=function(t){return t.can},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pt(n,function(t,n){return t&&o(n).apply(undefined,e)},!0)}),u=(r=e,i=function(t){return t.abort},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pt(r,function(t,n){return t||i(n).apply(undefined,e)},!1)});return yi({can:t,abort:u,run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];ft(e,function(t){t.run.apply(undefined,n)})}})},wi=function(t,n){Oi(t,t.element(),n,{})},Si=function(t,n,e){Oi(t,t.element(),n,e)},ki=function(t){wi(t,ce())},Ci=function(t,n,e){Oi(t,n,e,{})},Oi=function(t,n,e,o){var r=Ho({target:n},o);t.getSystem().triggerEvent(e,n,It(r,Z))},Ti=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event())},Ei=function(t){var n=go(t)?t.dom().parentNode:t.dom();return n!==undefined&&null!==n&&n.ownerDocument.body.contains(n)},Bi=Dn(function(){return Ai(Be.fromDom(x.document))}),Ai=function(t){var n=t.dom().body;if(null===n||n===undefined)throw new Error("Body is not available yet");return Be.fromDom(n)},Di=function(t,n,e){for(var o=t.dom(),r=et(e)?e:Z(!1);o.parentNode;){o=o.parentNode;var i=Be.fromDom(o);if(n(i))return tt.some(i);if(r(i))break}return tt.none()},_i=function(t,n,e){return o(function(t){return n(t)},Di,t,n,e)},Mi=function(t,o){var r=function(t){for(var n=0;n<t.childNodes.length;n++){if(o(Be.fromDom(t.childNodes[n])))return tt.some(Be.fromDom(t.childNodes[n]));var e=r(t.childNodes[n]);if(e.isSome())return e}return tt.none()};return r(t.dom())},Fi=function(t,n,e){return _i(t,function(t){return n(t).isSome()},e).bind(n)},Ii=function(t){return on(t)},Vi=function(t,n){return{key:t,value:yi({abort:n})}},Ri=function(t,n){return{key:t,value:yi({can:n})}},Hi=function(t){return{key:t,value:yi({run:function(t,n){n.event().prevent()}})}},Ni=function(t,n){return{key:t,value:yi({run:n})}},Pi=function(t,n,e){return{key:t,value:yi({run:function(t){n.apply(undefined,[t].concat(e))}})}},zi=function(t){return function(e){return{key:t,value:yi({run:function(t,n){bi(t,n)&&e(t,n)}})}}},Li=function(e,o){return Ni(e,function(t,n){t.getSystem().getByUid(o).each(function(t){Ti(t,t.element(),e,n)})})},ji=function(t,n,e){var o=n.partUids[e];return Li(t,o)},Ui=function(t,r){return Ni(t,function(n,t){var e=t.event(),o=n.getSystem().getByDom(e.target()).fold(function(){return Fi(e.target(),function(t){return n.getSystem().getByDom(t).toOption()},Z(!1)).getOr(n)},function(t){return t});r(n,o,t)})},Wi=function(t){return Ni(t,function(t,n){n.cut()})},Gi=function(t){return Ni(t,function(t,n){n.stop()})},Xi=function(t,n){return zi(t)(n)},Yi=zi(be()),qi=zi(ye()),Ki=zi(pe()),Ji=(Xo=ce(),function(t){return Ni(Xo,t)}),$i=Ii([Ri(re(),function(t,n){var e,o,r=n.event().originator(),i=n.event().target();return o=i,!(Ye(e=r,t.element())&&!Ye(e,o)&&(x.console.warn(re()+" did not get interpreted by the desired target. \nOriginator: "+Co(r)+"\nTarget: "+Co(i)+"\nCheck the "+re()+" event handlers"),1))})]),Qi=Object.freeze({events:$i}),Zi=Z("alloy-id-"),tu=Z("data-alloy-id"),nu=Zi(),eu=tu(),ou=function(t,n){Object.defineProperty(t.dom(),eu,{value:n,writable:!0})},ru=function(t){var n=mo(t)?t.dom()[eu]:null;return tt.from(n)},iu=function(t){return Vo(t)},uu=U,au=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+"\n"+Co(n().element())+" is not in context.")}};return{debugInfo:Z("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:Z(!1)}},cu=au(),su=function(t){return st(t,function(t){return o=n="/*",r=(e=t).length-n.length,""!==o&&(e.length<o.length||e.substr(r,r+o.length)!==o)?t:t.substring(0,t.length-"/*".length);var n,e,o,r})},fu=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:su(i)}},t},lu=Vo("alloy-premade"),du=function(t){return en(lu,t)},mu=function(t){return nn(t,lu)},gu=function(o){return t=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return o.apply(undefined,[t.getApis()].concat([t].concat(n)))},e=(n=o.toString()).indexOf(")")+1,r=n.indexOf("("),i=n.substring(r+1,e-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:su(i.slice(1))}},t;var t,n,e,r,i},pu={init:function(){return hu({readState:function(){return"No State required"}})}},hu=function(t){return t},vu=function(t,r){var i={};return Ft(t,function(t,o){Ft(t,function(t,n){var e=tn(n,[])(i);i[n]=e.concat([r(o,t)])})}),i},bu=function(t){return{classes:t.classes!==undefined?t.classes:[],attributes:t.attributes!==undefined?t.attributes:{},styles:t.styles!==undefined?t.styles:{}}},yu=function(t,n){return e=v.apply(undefined,[t.handler].concat(n)),o=t.purpose(),{cHandler:e,purpose:Z(o)};var e,o},xu=function(t){return t.cHandler},wu=function(t,n){return{name:Z(t),handler:Z(n)}},Su=function(t,n,e){var o,r,i=Ho({},e,(o=t,r={},ft(n,function(t){r[t.name()]=t.handlers(o)}),r));return vu(i,wu)},ku=function(t){var n,i=et(n=t)?{can:Z(!0),abort:Z(!1),run:n}:n;return function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];var r=[t,n].concat(e);i.abort.apply(undefined,r)?n.stop():i.can.apply(undefined,r)&&i.run.apply(undefined,r)}},Cu=function(o,t,n){var r,e,i=t[n];return i?function(u,a,t,c){var n=o.slice(0);try{var e=n.sort(function(t,n){var e=t[a](),o=n[a](),r=c.indexOf(e),i=c.indexOf(o);if(-1===r)throw new Error("The ordering for "+u+" does not have an entry for "+e+".\nOrder specified: "+mr(c,null,2));if(-1===i)throw new Error("The ordering for "+u+" does not have an entry for "+o+".\nOrder specified: "+mr(c,null,2));return r<i?-1:i<r?1:0});return Xt.value(e)}catch(r){return Xt.error([r])}}("Event: "+n,"name",0,i).map(function(t){var n=st(t,function(t){return t.handler()});return xi(n)}):(r=n,e=o,Xt.error(["The event ("+r+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+mr(st(e,function(t){return t.name()}),null,2)]))},Ou=function(t,i){var n=Rt(t,function(o,r){return(1===o.length?Xt.value(o[0].handler()):Cu(o,i,r)).map(function(t){var n=ku(t),e=1<o.length?mt(i,function(n){return ut(o,function(t){return t.name()===n})}).join(" > "):o[0].name();return en(r,{handler:n,purpose:Z(e)})})});return rn(n,{})},Tu=function(t){return Hr("custom.definition",Sr([Br("dom","dom",jo(),Sr([Kr("tag"),si("styles",{}),si("classes",[]),si("attributes",{}),oi("value"),oi("innerHtml")])),Kr("components"),Kr("uid"),si("events",{}),si("apis",{}),Br("eventOrder","eventOrder",(n={"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]},zo.mergeWithThunk(Z(n))),jr()),oi("domModification")]),t);var n},Eu=function(t,n){var e=yo(t,n);return e===undefined||""===e?[]:e.split(" ")},Bu=function(t){return t.dom().classList!==undefined},Au=function(t){return Eu(t,"class")},Du=function(t,n){return r=n,i=Eu(e=t,o="class").concat([r]),vo(e,o,i.join(" ")),!0;var e,o,r,i},_u=function(t,n){return r=n,0<(i=mt(Eu(e=t,o="class"),function(t){return t!==r})).length?vo(e,o,i.join(" ")):wo(e,o),!1;var e,o,r,i},Mu=function(t,n){Bu(t)?t.dom().classList.add(n):Du(t,n)},Fu=function(t,n){var e;Bu(t)?t.dom().classList.remove(n):_u(t,n),0===(Bu(e=t)?e.dom().classList:Au(e)).length&&wo(e,"class")},Iu=function(t,n){return Bu(t)&&t.dom().classList.contains(n)},Vu=function(n,t){ft(t,function(t){Mu(n,t)})},Ru=function(n,t){ft(t,function(t){Fu(n,t)})},Hu=function(t){return t.style!==undefined},Nu=function(t,n,e){if(!K(e))throw x.console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Hu(t)&&t.style.setProperty(n,e)},Pu=function(t,n){Hu(t)&&t.style.removeProperty(n)},zu=function(t,n,e){var o=t.dom();Nu(o,n,e)},Lu=function(t,n){var e=t.dom();Ft(n,function(t,n){Nu(e,n,t)})},ju=function(t,n){var e=t.dom();Ft(n,function(t,n){t.fold(function(){Pu(e,n)},function(t){Nu(e,n,t)})})},Uu=function(t,n){var e=t.dom(),o=x.window.getComputedStyle(e).getPropertyValue(n),r=""!==o||Ei(t)?o:Wu(e,n);return null===r?undefined:r},Wu=function(t,n){return Hu(t)?t.style.getPropertyValue(n):""},Gu=function(t,n){var e=t.dom(),o=Wu(e,n);return tt.from(o).filter(function(t){return 0<t.length})},Xu=function(t,n,e){var o=Be.fromTag(t);return zu(o,n,e),Gu(o,n).isSome()},Yu=function(t,n){var e=t.dom();Pu(e,n),xo(t,"style")&&""===yo(t,"style").replace(/^\s+|\s+$/g,"")&&wo(t,"style")},qu=function(t){return t.dom().offsetWidth},Ku=function(t){return t.dom().value},Ju=function(t,n){if(n===undefined)throw new Error("Value.set was undefined");t.dom().value=n},$u=function(t,n){return e=t,r=st(o=n,function(t){return ci(t.name(),[Kr("config"),si("state",pu)])}),i=Hr("component.behaviours",Sr(r),e.behaviours).fold(function(t){throw new Error(zr(t)+"\nComplete spec:\n"+mr(e,null,2))},function(t){return t}),{list:o,data:It(i,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})};var e,o,r,i},Qu=function(t){var n,e,o,r=(n=t,e=tn("behaviours",{})(n),o=mt(_t(e),function(t){return e[t]!==undefined}),st(o,function(t){return e[t].me}));return $u(t,r)},Zu=function(t,n,e){var o,r,i,u=Ho({},(o=t).dom,{uid:o.uid,domChildren:st(o.components,function(t){return t.element()})}),a=t.domModification.fold(function(){return bu({})},bu),f={"alloy.base.modification":a};return i=0<n.length?function(n,t,e,o){var r=Ho({},f);ft(e,function(t){r[t.name()]=t.exhibit(n,o)});var i=vu(r,function(t,n){return{name:t,modification:n}}),u=function(t){return gt(t,function(t,n){return Ho({},n.modification,t)},{})},a=gt(i.classes,function(t,n){return n.modification.concat(t)},[]),c=u(i.attributes),s=u(i.styles);return bu({classes:a,attributes:c,styles:s})}(e,0,n,u):a,Ho({},r=u,{attributes:Ho({},r.attributes,i.attributes),styles:Ho({},r.styles,i.styles),classes:r.classes.concat(i.classes)})},ta=function(t,n,e){var o,r,i,u,a,c,s={"alloy.base.behaviour":(o=t,o.events)};return(r=e,i=t.eventOrder,u=n,a=s,c=Su(r,u,a),Ou(c,i)).getOrDie()},na=function(e){var t=function(){return f},o=an(cu),n=Nr(Tu(e)),r=Qu(e),i=r.list,u=r.data,a=function(t){var n=Be.fromTag(t.tag);bo(n,t.attributes),Vu(n,t.classes),Lu(n,t.styles),t.innerHtml.each(function(t){return co(n,t)});var e=t.domChildren;return ro(n,e),t.value.each(function(t){Ju(n,t)}),t.uid,ou(n,t.uid),n}(Zu(n,i,u)),c=ta(n,i,u),s=an(n.components),f={getSystem:o.get,config:function(t){var n=u;return(et(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+mr(e,null,2))})()},hasConfigured:function(t){return et(u[t.name()])},spec:Z(e),readState:function(t){return u[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return n.apis},connect:function(t){o.set(t)},disconnect:function(){o.set(au(t))},element:Z(a),syncComponents:function(){var t=Qe(a),n=wt(t,function(t){return o.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});s.set(n)},components:s.get,events:Z(c)};return f},ea=function(t){var n,e,o=uu(t),r=o.events,i=h(o,["events"]),u=(n=i,e=tn("components",[])(n),st(e,ua)),a=Ho({},i,{events:Ho({},Qi,r),components:u});return Xt.value(na(a))},oa=function(t){var n=Be.fromText(t);return ra({element:n})},ra=function(t){var n=Pr("external.component",wr([Kr("element"),oi("uid")]),t),e=an(au());n.uid.each(function(t){ou(n.element,t)});var o={getSystem:e.get,config:tt.none,hasConfigured:Z(!1),connect:function(t){e.set(t)},disconnect:function(){e.set(au(function(){return o}))},getApis:function(){return{}},element:Z(n.element),spec:Z(t),readState:Z("No state"),syncComponents:Q,components:Z([]),events:Z({})};return du(o)},ia=iu,ua=function(n){return mu(n).fold(function(){var t=n.hasOwnProperty("uid")?n:Ho({uid:ia("")},n);return ea(t).getOrDie()},function(t){return t})},aa=du,ca=function(t,n,e){return _i(t,n,e).isSome()},sa=function(t,n,e){return Di(t,function(t){return Ue(t,n)},e)},fa=function(t,n){return Xe(n,t)},la=function(t,n,e){return o(Ue,sa,t,n,e)},da=function(n,t){return(e=t,_i(e,function(t){if(!mo(t))return!1;var n=yo(t,"id");return n!==undefined&&-1<n.indexOf("aria-owns")}).bind(function(t){var n=yo(t,"id"),e=qe(t);return fa(e,'[aria-owns="'+n+'"]')})).exists(function(t){return ma(n,t)});var e},ma=function(n,t){return ca(t,function(t){return Ye(t,n.element())},Z(!1))||da(n,t)},ga=Z([Kr("menu"),Kr("selectedMenu")]),pa=Z([Kr("item"),Kr("selectedItem")]),ha=(Z(Sr(pa().concat(ga()))),Z(Sr(pa()))),va=ti("initSize",[Kr("numColumns"),Kr("numRows")]),ba=function(){return ti("markers",[Kr("backgroundMenu")].concat(ga()).concat(pa()))},ya=function(t){return ti("markers",st(t,Kr))},xa=function(t,n,e){return function(){var t=new Error;if(t.stack!==undefined){var n=t.stack.split("\n");ht(n,function(n){return 0<n.indexOf("alloy")&&!at(Ao,function(t){return-1<n.indexOf(t)})}).getOr(Oo)}}(),Br(n,n,e,Ir(function(e){return Xt.value(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.apply(undefined,t)})}))},wa=function(t){return xa(0,t,Lo(Q))},Sa=function(t){return xa(0,t,Lo(tt.none))},ka=function(t){return xa(0,t,jo())},Ca=function(t){return xa(0,t,jo())},Oa=function(t,n){return vi(t,Z(n))},Ta=function(t){return vi(t,U)},Ea=Z(va),Ba=function(n,e,o){return Ki(function(t){o(t,n,e)})},Aa=function(t,n,e,o,r,i){var u,a,c=wr(t),s=ci(n,[(u="config",a=t,ri(u,wr(a)))]);return Ma(c,s,n,e,o,r,i)},Da=function(r,i,u){var t,n,e,o,a,c;return t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=[e].concat(t);return e.config({name:Z(r)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+r+". Using API: "+u)},function(t){var n=Array.prototype.slice.call(o,1);return i.apply(undefined,[e,t.config,t.state].concat(n))})},n=u,o=(e=i.toString()).indexOf(")")+1,a=e.indexOf("("),c=e.substring(a+1,o-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:n,parameters:su(c.slice(0,1).concat(c.slice(3)))}},t},_a=function(t){return{key:t,value:undefined}},Ma=function(e,t,o,r,n,i,u){var a=function(t){return un(t,o)?t[o]():tt.none()},c=It(n,function(t,n){return Da(o,t,n)}),s=It(i,function(t,n){return fu(t,n)}),f=Ho({},s,c,{revoke:v(_a,o),config:function(t){var n=Pr(o+"-config",e,t);return{key:o,value:{config:n,me:f,configAsRaw:Dn(function(){return Pr(o+"-config",e,t)}),initialConfig:t,state:u}}},schema:function(){return t},exhibit:function(t,e){return a(t).bind(function(n){return nn(r,"exhibit").map(function(t){return t(e,n.config,n.state)})}).getOr(bu({}))},name:function(){return o},handlers:function(t){return a(t).map(function(t){return tn("events",function(){return{}})(r)(t.config,t.state)}).getOr({})}});return f},Fa=function(t){return on(t)},Ia=wr([Kr("fields"),Kr("name"),si("active",{}),si("apis",{}),si("state",pu),si("extra",{})]),Va=function(t){var n=Pr("Creating behaviour: "+t.name,Ia,t);return Aa(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Ra=wr([Kr("branchKey"),Kr("branches"),Kr("name"),si("active",{}),si("apis",{}),si("state",pu),si("extra",{})]),Ha=function(t){var n,e,o,r,i,u,a,c,s=Pr("Creating behaviour: "+t.name,Ra,t);return n=Lr(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=ci(e,[ri("config",a=n)]),Ma(a,c,e,o,r,i,u)},Na=Z(undefined),Pa=Object.freeze({events:function(o){return Ii([Ni(ae(),function(r,i){var t,n,u=o.channels,e=(t=_t(u),(n=i).universal()?t:mt(t,function(t){return ut(n.channels(),t)}));ft(e,function(t){var n=u[t],e=n.schema,o=Pr("channel["+t+"] data\nReceiver: "+Co(r.element()),e,i.data());n.onReceive(r,o)})})])}}),za=[Jr("channels",Vr(Xt.value,wr([ka("onReceive"),si("schema",jr())])))],La=Va({fields:za,name:"receiving",active:Pa}),ja=Object.freeze({exhibit:function(t,n){return bu({classes:[],styles:n.useFixed?{}:{position:"relative"}})}}),Ua=function(e,o){return{left:Z(e),top:Z(o),translate:function(t,n){return Ua(e+t,o+n)}}},Wa=Ua,Ga=function(t,n){return t!==undefined?t:n!==undefined?n:0},Xa=function(t){var n,e,o=t.dom().ownerDocument,r=o.body,i=(e=(n=Be.fromDom(o)).dom())===e.window&&n instanceof x.Window?n:po(n)?e.defaultView||e.parentWindow:null,u=o.documentElement,a=Ga(i.pageYOffset,u.scrollTop),c=Ga(i.pageXOffset,u.scrollLeft),s=Ga(u.clientTop,r.clientTop),f=Ga(u.clientLeft,r.clientLeft);return Ya(t).translate(c-f,a-s)},Ya=function(t){var n,e,o,r=t.dom(),i=r.ownerDocument,u=i.body,a=Be.fromDom(i.documentElement);return u===r?Wa(u.offsetLeft,u.offsetTop):(n=t,e=a||Be.fromDom(x.document.documentElement),Di(n,v(Ye,e)).isSome()?(o=r.getBoundingClientRect(),Wa(o.left,o.top)):Wa(0,0))},qa=(ee.detect().browser.isSafari(),function(t){var n=t!==undefined?t.dom():x.document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Wa(e,o)}),Ka=t("width",function(t){return t.dom().offsetWidth}),Ja=function(t){return Ka.get(t)},$a=function(t){return Ka.getOuter(t)},Qa=t("height",function(t){var n=t.dom();return Ei(t)?n.getBoundingClientRect().height:n.offsetHeight}),Za=function(t){return Qa.get(t)},tc=function(t){return Qa.getOuter(t)},nc=Fe(["x","y","width","height","maxHeight","direction","classes","label","candidateYforTest"],[]),ec=Ae("position","left","top","right","bottom"),oc=Yt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),rc=oc.southeast,ic=oc.southwest,uc=oc.northeast,ac=oc.northwest,cc=oc.south,sc=oc.north,fc=oc.east,lc=oc.west,dc=Ae("point","width","height"),mc=Ae("x","y","width","height"),gc=function(t,n,e,o){return{x:Z(t),y:Z(n),width:Z(e),height:Z(o),right:Z(t+e),bottom:Z(n+o)}},pc=function(t){var n=Xa(t),e=$a(t),o=tc(t);return gc(n.left(),n.top(),e,o)},hc=function(o,t){return o.view(t).fold(Z([]),function(t){var n=o.owner(t),e=hc(o,n);return[t].concat(e)})},vc=Object.freeze({view:function(t){return(t.dom()===x.document?tt.none():tt.from(t.dom().defaultView.frameElement)).map(Be.fromDom)},owner:function(t){return qe(t)}}),bc=function(o){var t,n,e,r,i=Be.fromDom(x.document),u=qa(i);return(t=o,e=(n=vc).owner(t),r=hc(n,e),tt.some(r)).fold(v(Xa,o),function(t){var n=Ya(o),e=gt(t,function(t,n){var e=Ya(n);return{left:t.left+e.left(),top:t.top+e.top()}},{left:0,top:0});return Wa(e.left+n.left()+u.left(),e.top+n.top()+u.top())})},yc=function(){var t=x.window.innerWidth,n=x.window.innerHeight,e=Be.fromDom(x.document),o=qa(e);return gc(o.left(),o.top(),t,n)},xc=Yt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),wc=function(t,n,e,o,r,i){var u,a,c,s,f,l,d,m,g=n.x()-e,p=n.y()-o,h=r-(g+n.width()),v=i-(p+n.height()),b=tt.some(g),y=tt.some(p),x=tt.some(h),w=tt.some(v),S=tt.none();return u=function(){return ec(t,b,y,S,S)},a=function(){return ec(t,S,y,x,S)},c=function(){return ec(t,b,S,S,w)},s=function(){return ec(t,S,S,x,w)},f=function(){return ec(t,b,y,S,S)},l=function(){return ec(t,b,S,S,w)},d=function(){return ec(t,b,y,S,S)},m=function(){return ec(t,S,y,x,S)},n.direction().fold(u,a,c,s,f,l,d,m)},Sc=function(t,n){var e=v(bc,n),o=t.fold(e,e,function(){var t=qa();return bc(n).translate(-t.left(),-t.top())}),r=$a(n),i=tc(n);return gc(o.left(),o.top(),r,i)},kc=xc.relative,Cc=xc.fixed,Oc=Ae("anchorBox","origin"),Tc=Yt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ec=function(t,H,N,P,z){var L=N.width(),j=N.height(),o=function(t,o,r,i){var n,e,u,a,c,s,f,l,d,m,g,p,h,v,b,y,x,w,S,k,C,O,T,E,B,A,D,_,M,F,I,V,R=t(H,N,P);return(e=L,u=j,a=z,d=(n=R).x(),m=n.y(),g=n.bubble().offset().left(),p=n.bubble().offset().top(),h=a.x(),v=a.y(),b=a.width(),y=a.height(),k=v<=(w=m+p),C=(S=h<=(x=d+g))&&k,O=x+e<=h+b&&w+u<=v+y,T=S?Math.min(e,h+b-x):Math.abs(h-(x+e)),E=k?Math.min(u,v+y-w):Math.abs(v-(w+u)),B=a.x()+a.width(),A=Math.max(a.x(),x),D=Math.min(A,B),M=Z((_=k?w:w+(u-E))+E-v),F=Z(v+y-_),c=n.direction(),f=s=F,l=M,I=c.fold(s,s,l,l,s,l,f,f),V=nc({x:D,y:_,width:T,height:E,maxHeight:I,direction:n.direction(),classes:{on:n.bubble().classesOn(),off:n.bubble().classesOff()},label:n.label(),candidateYforTest:w}),C&&O?Tc.fit(V):Tc.nofit(V,T,E)).fold(Tc.fit,function(t,n,e){return i<e||r<n?Tc.nofit(t,n,e):Tc.nofit(o,r,i)})};return pt(t,function(t,n){var e=v(o,n);return t.fold(Tc.fit,e)},Tc.nofit(nc({x:H.x(),y:H.y(),width:N.width(),height:N.height(),maxHeight:N.height(),direction:rc(),classes:[],label:"none",candidateYforTest:H.y()}),-1,-1)).fold(U,U)},Bc=function(t,n,e,o){Yu(n,"max-height");var r,i={width:Z($a(r=n)),height:Z(tc(r))};return Ec(o.preference(),t,i,e,o.bounds())},Ac=function(t,n,e){var o,r,i=function(t){return t+"px"},u=(o=e.origin(),r=n,o.fold(function(){return ec("absolute",tt.some(r.x()),tt.some(r.y()),tt.none(),tt.none())},function(t,n,e,o){return wc("absolute",r,t,n,e,o)},function(t,n,e,o){return wc("fixed",r,t,n,e,o)}));ju(t,{position:tt.some(u.position()),left:u.left().map(i),top:u.top().map(i),right:u.right().map(i),bottom:u.bottom().map(i)})},Dc=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=Qa.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),zu(e,"max-height",r+"px")},_c=Z(function(t,n){Dc(t,n),Lu(t,{"overflow-x":"hidden","overflow-y":"auto"})}),Mc=Z(function(t,n){Dc(t,n)}),Fc=Fe(["bounds","origin","preference","maxHeightFunction"],[]),Ic=function(t,n,e,o,r,i){var u,a,c,s,f,l=(u=i,a="maxHeightFunction",c=_c(),u[a]===undefined?c:u[a]),d=t.anchorBox(),m=t.origin(),g=Fc({bounds:(s=m,f=r,f.fold(function(){return s.fold(yc,yc,gc)},function(t){return s.fold(t,t,gc)})),origin:m,preference:o,maxHeightFunction:l});Vc(d,n,e,g)},Vc=function(t,n,e,o){var r,i,u,a,c=Bc(t,n,e,o);Ac(n,c,o),r=n,i=c.classes(),Ru(r,i.off),Vu(r,i.on),u=n,a=c,o.maxHeightFunction()(u,a.maxHeight())},Rc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Hc=function(t,n,e){var r=function(t){return nn(e,t).getOr([])},o=function(t,n,e){var o=Ot(Rc,e);return{offset:function(){return Wa(t,n)},classesOn:function(){return wt(e,r)},classesOff:function(){return wt(o,r)}}};return{southeast:function(){return o(-t,n,["top","alignLeft"])},southwest:function(){return o(t,n,["top","alignRight"])},south:function(){return o(-t/2,n,["top","alignCentre"])},northeast:function(){return o(-t,-n,["bottom","alignLeft"])},northwest:function(){return o(t,-n,["bottom","alignRight"])},north:function(){return o(-t/2,-n,["bottom","alignCentre"])},east:function(){return o(t,-n/2,["valignCentre","left"])},west:function(){return o(-t,-n/2,["valignCentre","right"])}}},Nc=function(){return Hc(0,0,{})},Pc=Ae("x","y","bubble","direction","label"),zc=function(t){return t.x()},Lc=function(t,n){return t.x()+t.width()/2-n.width()/2},jc=function(t,n){return t.x()+t.width()-n.width()},Uc=function(t,n){return t.y()-n.height()},
Wc=function(t){return t.y()+t.height()},Gc=function(t,n){return t.y()+t.height()/2-n.height()/2},Xc=function(t,n,e){return Pc(zc(t),Wc(t),e.southeast(),rc(),"layout-se")},Yc=function(t,n,e){return Pc(jc(t,n),Wc(t),e.southwest(),ic(),"layout-sw")},qc=function(t,n,e){return Pc(zc(t),Uc(t,n),e.northeast(),uc(),"layout-ne")},Kc=function(t,n,e){return Pc(jc(t,n),Uc(t,n),e.northwest(),ac(),"layout-nw")},Jc=function(t,n,e){return Pc(Lc(t,n),Uc(t,n),e.north(),sc(),"layout-n")},$c=function(t,n,e){return Pc(Lc(t,n),Wc(t),e.south(),cc(),"layout-s")},Qc=function(t,n,e){return Pc((o=t).x()+o.width(),Gc(t,n),e.east(),fc(),"layout-e");var o},Zc=function(t,n,e){return Pc((o=n,t.x()-o.width()),Gc(t,n),e.west(),lc(),"layout-w");var o},ts=function(){return[Xc,Yc,qc,Kc,$c,Jc,Qc,Zc]},ns=function(){return[Yc,Xc,Kc,qc,$c,Jc,Qc,Zc]},es=function(t){return t},os=function(n,e){return function(t){return"rtl"===rs(t)?e:n}},rs=function(t){return"rtl"===Uu(t,"direction")?"rtl":"ltr"},is=function(){return ci("layouts",[Kr("onLtr"),Kr("onRtl")])},us=function(n,t,e,o){var r=t.layouts.map(function(t){return t.onLtr(n)}).getOr(e),i=t.layouts.map(function(t){return t.onRtl(n)}).getOr(o);return os(r,i)(n)},as=[Kr("hotspot"),oi("bubble"),is(),Oa("placement",function(t,n,e){var o=n.hotspot,r=Sc(e,o.element()),i=us(t.element(),n,ts(),ns());return tt.some(es({anchorBox:r,bubble:n.bubble.getOr(Nc()),overrides:{},layouts:i,placer:tt.none()}))})],cs=[Kr("x"),Kr("y"),si("height",0),si("width",0),si("bubble",Nc()),is(),Oa("placement",function(t,n){var e=gc(n.x,n.y,n.width,n.height),o=us(t.element(),n,ts(),ns());return tt.some(es({anchorBox:e,bubble:n.bubble,overrides:{},layouts:o,placer:tt.none()}))})],ss=(Yt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Yt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}])),fs=Ae("start","soffset","finish","foffset"),ls=ss.exact,ds=function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=qe(r=t).dom().createRange()).setStart(r.dom(),i),c.setEnd(u.dom(),a),c),f=Ye(t,e)&&n===o;return s.collapsed&&!f},ms=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold(function(t){o.setStartBefore(t.dom())},function(t,n){o.setStart(t.dom(),n)},function(t){o.setStartAfter(t.dom())}),r=i,e.fold(function(t){r.setEndBefore(t.dom())},function(t,n){r.setEnd(t.dom(),n)},function(t){r.setEndAfter(t.dom())}),i},gs=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(o.dom(),r),i},ps=function(t){return{left:Z(t.left),top:Z(t.top),right:Z(t.right),bottom:Z(t.bottom),width:Z(t.width),height:Z(t.height)}},hs=Yt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),vs=function(t,n,e){return n(Be.fromDom(e.startContainer),e.startOffset,Be.fromDom(e.endContainer),e.endOffset)},bs=function(t,n){var r,e,o,i=(r=t,n.match({domRange:function(t){return{ltr:Z(t),rtl:tt.none}},relative:function(t,n){return{ltr:Dn(function(){return ms(r,t,n)}),rtl:Dn(function(){return tt.some(ms(r,n,t))})}},exact:function(t,n,e,o){return{ltr:Dn(function(){return gs(r,t,n,e,o)}),rtl:Dn(function(){return tt.some(gs(r,e,o,t,n))})}}}));return(o=(e=i).ltr()).collapsed?e.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return hs.rtl(Be.fromDom(t.endContainer),t.endOffset,Be.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return vs(0,hs.ltr,o)}):vs(0,hs.ltr,o)},ys=function JD(e,o){var n=function(t){return e(t)?tt.from(t.dom().nodeValue):tt.none()},t=ee.detect().browser,r=t.isIE()&&10===t.version.major?function(t){try{return n(t)}catch(r){return tt.none()}}:n;return{get:function(t){if(!e(t))throw new Error("Can only get "+o+" value of a "+o+" node");return r(t).getOr("")},getOption:r,set:function(t,n){if(!e(t))throw new Error("Can only set raw "+o+" value of a "+o+" node");t.dom().nodeValue=n}}}(go,"text"),xs=function(t){return ys.get(t)},ws=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(t,n){return Ge(n,t)}),Ss=function(t){var n=Be.fromDom(t.anchorNode),e=Be.fromDom(t.focusNode);return ds(n,t.anchorOffset,e,t.focusOffset)?tt.some(fs(n,t.anchorOffset,e,t.focusOffset)):function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return tt.some(fs(Be.fromDom(n.startContainer),n.startOffset,Be.fromDom(e.endContainer),e.endOffset))}return tt.none()}(t)},ks=function(t,n){var i,e,o,r;return 0<(r=0<(o=(e=bs(i=t,n).match({ltr:function(t,n,e,o){var r=i.document.createRange();return r.setStart(t.dom(),n),r.setEnd(e.dom(),o),r},rtl:function(t,n,e,o){var r=i.document.createRange();return r.setStart(e.dom(),o),r.setEnd(t.dom(),n),r}})).getClientRects()).length?o[0]:e.getBoundingClientRect()).width||0<r.height?tt.some(r).map(ps):tt.none()},Cs=Ae("element","offset"),Os=Yt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Ts=function(t){return t.fold(function(t){return t},function(t,n,e){return t.translate(-n,-e)})},Es=function(t){return t.fold(function(t){return t},function(t){return t})},Bs=function(t){return pt(t,function(t,n){return t.translate(n.left(),n.top())},Wa(0,0))},As=function(t){var n=st(t,Es);return Bs(n)},Ds=Os.screen,_s=Os.absolute,Ms=function(t,n,e){var o,r,i,u=qe(t.element()),a=qa(u),c=(o=t,r=e,i=Ke(r.root).dom(),tt.from(i.frameElement).map(Be.fromDom).filter(function(t){var n=qe(t),e=qe(o.element());return Ye(n,e)}).map(Xa)).getOr(a);return _s(c,a.left(),a.top())},Fs=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=Ds(Wa(r,i));return tt.some(dc(c,u,a))},Is=function(t,c,s,f,l){return t.map(function(t){var n,e,o,r=[c,t.point()],i=(n=function(){return As(r)},e=function(){return As(r)},o=function(){return t=st(r,Ts),Bs(t);var t},f.fold(n,e,o)),u=mc(i.left(),i.top(),t.width(),t.height()),a=us(l,s,s.showAbove?[qc,Kc,Xc,Yc,Jc,$c]:[Xc,Yc,qc,Kc,$c,$c],s.showAbove?[Kc,qc,Yc,Xc,Jc,$c]:[Yc,Xc,Kc,qc,$c,Jc]);return es({anchorBox:u,bubble:s.bubble.getOr(Nc()),overrides:s.overrides,layouts:a,placer:tt.none()})})},Vs=Ae("element","offset"),Rs=function(t,n){return go(t)?Vs(t,n):function(t,n){var e=Qe(t);if(0===e.length)return Cs(t,n);if(n<e.length)return Cs(e[n],0);var o=e[e.length-1],r=go(o)?xs(o).length:Qe(o).length;return Cs(o,r)}(t,n)},Hs=function(n,t){return t.getSelection.getOrThunk(function(){return function(){return t=n,tt.from(t.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(Ss);var t}})().map(function(t){var n=Rs(t.start(),t.soffset()),e=Rs(t.finish(),t.foffset());return fs(n.element(),n.offset(),e.element(),e.offset())})},Ns=[oi("getSelection"),Kr("root"),oi("bubble"),is(),si("overrides",{}),si("showAbove",!1),Oa("placement",function(t,n,e){var o=Ke(n.root).dom(),r=Ms(t,0,n),i=Hs(o,n).bind(function(t){var n;return ks(o,(n=t,ss.exact(n.start(),n.soffset(),n.finish(),n.foffset()))).orThunk(function(){var n=Be.fromText("\ufeff");return to(t.start(),n),ks(o,ls(n,0,n,1)).map(function(t){return uo(n),t})}).bind(function(t){return Fs(t.left(),t.top(),t.width(),t.height())})}),u=Hs(o,n).bind(function(t){return mo(t.start())?tt.some(t.start()):Je(t.start())}).getOr(t.element());return Is(i,r,n,e,u)})],Ps=[Kr("node"),Kr("root"),oi("bubble"),is(),si("overrides",{}),si("showAbove",!1),Oa("placement",function(r,i,u){var a=Ms(r,0,i);return i.node.bind(function(t){var n=t.dom().getBoundingClientRect(),e=Fs(n.left,n.top,n.width,n.height),o=i.node.getOr(r.element());return Is(e,a,i,u,o)})})],zs=function(t){return t.x()+t.width()},Ls=function(t,n){return t.x()-n.width()},js=function(t,n){return t.y()-n.height()+t.height()},Us=function(t){return t.y()},Ws=function(t,n,e){return Pc(zs(t),Us(t),e.southeast(),rc(),"link-layout-se")},Gs=function(t,n,e){return Pc(Ls(t,n),Us(t),e.southwest(),ic(),"link-layout-sw")},Xs=function(t,n,e){return Pc(zs(t),js(t,n),e.northeast(),uc(),"link-layout-ne")},Ys=function(t,n,e){return Pc(Ls(t,n),js(t,n),e.northwest(),ac(),"link-layout-nw")},qs=[Kr("item"),is(),Oa("placement",function(t,n,e){var o=Sc(e,n.item.element()),r=us(t.element(),n,[Ws,Gs,Xs,Ys],[Gs,Ws,Ys,Xs]);return tt.some(es({anchorBox:o,bubble:Nc(),overrides:{},layouts:r,placer:tt.none()}))})],Ks=Lr("anchor",{selection:Ns,node:Ps,hotspot:as,submenu:qs,makeshift:cs}),Js=function(t,n,e,o,r){var i,u=(i=e.anchorBox,Oc(i,n));Ic(u,r.element(),e.bubble,e.layouts,o,e.overrides)},$s=function(n,t,e,o,r,i){var u=Pr("positioning anchor.info",Ks,o);zu(r.element(),"position","fixed");var a=Gu(r.element(),"visibility");zu(r.element(),"visibility","hidden");var c,s,f,l=t.useFixed?Cc(0,0,x.window.innerWidth,x.window.innerHeight):(s=Xa((c=n).element()),f=c.element().dom().getBoundingClientRect(),kc(s.left(),s.top(),f.width,f.height)),d=u.placement,m=i.map(function(t){return function(){return pc(t)}}).or(t.getBounds);d(n,u,l).each(function(t){t.placer.getOr(Js)(n,l,t,m,r)}),a.fold(function(){Yu(r.element(),"visibility")},function(t){zu(r.element(),"visibility",t)}),Gu(r.element(),"left").isNone()&&Gu(r.element(),"top").isNone()&&Gu(r.element(),"right").isNone()&&Gu(r.element(),"bottom").isNone()&&Gu(r.element(),"position").is("fixed")&&Yu(r.element(),"position")},Qs=Object.freeze({position:function(t,n,e,o,r){var i=tt.none();$s(t,n,e,o,r,i)},positionWithin:$s,getMode:function(t,n){return n.useFixed?"fixed":"absolute"}}),Zs=[si("useFixed",!1),oi("getBounds")],tf=Va({fields:Zs,name:"positioning",active:ja,apis:Qs}),nf=function(t){wi(t,ye());var n=t.components();ft(n,nf)},ef=function(t){var n=t.components();ft(n,ef),wi(t,be())},of=function(t,n){rf(t,n,oo)},rf=function(t,n,e){t.getSystem().addToWorld(n),e(t.element(),n.element()),Ei(t.element())&&ef(n),t.syncComponents()},uf=function(t){nf(t),uo(t.element()),t.getSystem().removeFromWorld(t)},sf=function(n){var t=Je(n.element()).bind(function(t){return n.getSystem().getByDom(t).fold(tt.none,tt.some)});uf(n),t.each(function(t){t.syncComponents()})},ff=function(t){var n=t.components();ft(n,uf),io(t.element()),t.syncComponents()},lf=function(t,n){df(t,n,oo)},df=function(t,n,e){e(t,n.element());var o=Qe(n.element());ft(o,function(t){n.getByDom(t).each(ef)})},mf=function(n){var t=Qe(n.element());ft(t,function(t){n.getByDom(t).each(nf)}),uo(n.element())},gf=function(t,n,e,o){var r=function(t,n,e,o){e.get().each(function(){ff(t)});var r=n.getAttachPoint(t);of(r,t);var i=t.getSystem().build(o);return of(t,i),e.set(i),i}(t,n,e,o);return n.onOpen(t,r),r},pf=function(n,e,o){o.get().each(function(t){ff(n),sf(n),e.onClose(n,t),o.clear()})},hf=function(t,n,e){return e.isOpen()},vf=function(t,n){var e,o,r,i,u=n.getAttachPoint(t);zu(t.element(),"position",tf.getMode(u)),e=t,o="visibility",r=n.cloakVisibilityAttr,i="hidden",Gu(e.element(),o).fold(function(){wo(e.element(),r)},function(t){vo(e.element(),r,t)}),zu(e.element(),o,i)},bf=function(t,n){var e;e=t.element(),at(["top","left","right","bottom"],function(t){return Gu(e,t).isSome()})||Yu(t.element(),"position"),function(t,n,e){if(xo(t.element(),e)){var o=yo(t.element(),e);zu(t.element(),n,o)}else Yu(t.element(),n)}(t,"visibility",n.cloakVisibilityAttr)},yf=Object.freeze({cloak:vf,decloak:bf,open:gf,openWhileCloaked:function(t,n,e,o,r){vf(t,n,e),gf(t,n,e,o),r(),bf(t,n,e)},close:pf,isOpen:hf,isPartOf:function(n,e,t,o){return hf(0,0,t)&&t.get().exists(function(t){return e.isPartOf(n,t,o)})},getState:function(t,n,e){return e.get()}}),xf=Object.freeze({events:function(n,e){return Ii([Ni(me(),function(t){pf(t,n,e)})])}}),wf=[wa("onOpen"),wa("onClose"),Kr("isPartOf"),Kr("getAttachPoint"),si("cloakVisibilityAttr","data-precloak-visibility")],Sf=Va({fields:wf,name:"sandboxing",active:xf,apis:yf,state:Object.freeze({init:function(){var n=an(tt.none()),t=Z("not-implemented");return hu({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(tt.none())},set:function(t){n.set(tt.some(t))},get:function(){return n.get()}})}})}),kf=Z("dismiss.popups"),Cf=Z("mouse.released"),Of=wr([si("isExtraPart",Z(!1)),ci("fireEventInstead",[si("event",xe())])]),Tf=function(t){var n=Ef(t);return La.config(n)},Ef=function(t){var e=Pr("Dismissal",Of,t);return{channels:en(kf(),{schema:wr([Kr("target")]),onReceive:function(n,t){Sf.isOpen(n)&&(Sf.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold(function(){return Sf.close(n)},function(t){return wi(n,t.event)}))}})}},Bf=function(o,t){return hi(o,{},st(t,function(t){return n=t.name(),e="Cannot configure "+t.name()+" for "+o,Br(n,n,Uo(),xr(function(){return er("The field: "+n+" is forbidden. "+e)}));var n,e}).concat([vi("dump",U)]))},Af=function(t){return t.dump},Df=function(t,n){return Ho({},t.dump,Fa(n))},_f={field:Bf,augment:Df,get:Af},Mf="placeholder",Ff=Yt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),If=function(t,n,e,o){return e.uiType===Mf?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?Ff.single(!0,Z(i)):nn(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+_t(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+mr(i,null,2))},function(t){return t.replace()})):Ff.single(!1,Z(e));var r,i,u},Vf=function(i,u,a,c){return If(i,0,a,c).fold(function(t,n){var e=n(u,a.config,a.validated),o=nn(e,"components").getOr([]),r=wt(o,function(t){return Vf(i,u,t,c)});return[Ho({},e,{components:r})]},function(t,n){var e=n(u,a.config,a.validated);return a.validated.preprocess.getOr(U)(e)})},Rf=function(n,e,t,o){return wt(t,function(t){return Vf(n,e,t,o)})},Hf=function(n,e,t,o){var r=It(o,function(t,n){return o=t,r=!1,{name:Z(e=n),required:function(){return o.fold(function(t){return t},function(t){return t})},used:function(){return r},replace:function(){if(!0===r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),i=Rf(n,e,t,r);return Ft(r,function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+mr(e.components,null,2))}),i},Nf=Ff.single,Pf=Ff.multiple,zf=Z(Mf),Lf=Yt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),jf=si("factory",{sketch:U}),Uf=si("schema",[]),Wf=Kr("name"),Gf=Br("pname","pname",Wo(function(t){return"<alloy."+Vo(t.name)+">"}),jr()),Xf=vi("schema",function(){return[oi("preprocess")]}),Yf=si("defaults",Z({})),qf=si("overrides",Z({})),Kf=Sr([jf,Uf,Wf,Gf,Yf,qf]),Jf=Sr([jf,Uf,Wf,Yf,qf]),$f=Sr([jf,Uf,Wf,Gf,Yf,qf]),Qf=Sr([jf,Xf,Wf,Kr("unit"),Gf,Yf,qf]),Zf=function(t){return t.fold(tt.some,tt.none,tt.some,tt.some)},tl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},nl=function(e,o){return function(t){var n=Pr("Converting part type",o,t);return e(n)}},el=nl(Lf.required,Kf),ol=nl(Lf.external,Jf),rl=nl(Lf.optional,$f),il=nl(Lf.group,Qf),ul=Z("entirety"),al=Object.freeze({required:el,external:ol,optional:rl,group:il,asNamedPart:Zf,name:tl,asCommon:function(t){return t.fold(U,U,U,U)},original:ul}),cl=function(t,n,e,o){return Jt(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},sl=function(r,t){var n={};return ft(t,function(t){Zf(t).each(function(e){var o=fl(r,e.pname);n[e.name]=function(t){var n=Pr("Part: "+e.name+" in "+r,Sr(e.schema),t);return Ho({},o,{config:t,validated:n})}})}),n},fl=function(t,n){return{uiType:zf(),owner:t,name:n}},ll=function(t,n,e){return{uiType:zf(),owner:t,name:n,config:e,validated:{}}},dl=function(t){return wt(t,function(t){return t.fold(tt.none,tt.some,tt.none,tt.none).map(function(t){return ti(t.name,t.schema.concat([Ta(ul())]))}).toArray()})},ml=function(t){return st(t,tl)},gl=function(t,n,e){return o=n,i={},r={},ft(e,function(t){t.fold(function(o){i[o.pname]=Nf(!0,function(t,n,e){return o.factory.sketch(cl(t,o,n,e))})},function(t){var n=o.parts[t.name];r[t.name]=Z(t.factory.sketch(cl(o,t,n[ul()]),n))},function(o){i[o.pname]=Nf(!1,function(t,n,e){return o.factory.sketch(cl(t,o,n,e))})},function(r){i[r.pname]=Pf(!0,function(n,t,e){var o=n[r.name];return st(o,function(t){return r.factory.sketch(Jt(r.defaults(n,t,e),t,r.overrides(n,t)))})})})}),{internals:Z(i),externals:Z(r)};var o,i,r},pl=function(t,n,e){return Hf(tt.some(t),n,n.components,e)},hl=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOption()},vl=function(t,n,e){return hl(t,n,e).getOrDie("Could not find part: "+e)},bl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=i.getByUid(r[t])}),It(o,Z)},yl=function(t,n){var e=t.getSystem();return It(n.partUids,function(t){return Z(e.getByUid(t))})},xl=function(t){return _t(t.partUids)},wl=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return ft(e,function(t){o[t]=i.getByUid(r[t]).getOrDie()}),It(o,Z)},Sl=function(n,t){var e=ml(t);return on(st(e,function(t){return{key:t,value:n+"-"+t}}))},kl=function(n){return Br("partUids","partUids",Go(function(t){return Sl(t.uid,n)}),jr())},Cl=Object.freeze({generate:sl,generateOne:ll,schemas:dl,names:ml,substitutes:gl,components:pl,defaultUids:Sl,defaultUidsSchema:kl,getAllParts:yl,getAllPartNames:xl,getPart:hl,getPartOrDie:vl,getParts:bl,getPartsOrDie:wl}),Ol=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[ti("parts",i)]:[]).concat([Kr("uid"),si("dom",{}),si("components",[]),Ta("originalSpec"),si("debug.sketcher",{})]).concat(u));return Pr(t+" [SpecSchema]",wr(a.concat(n)),e)},Tl=function(t,n,e,o,r){var i=El(r),u=dl(e),a=kl(e),c=Ol(t,n,i,u,[a]),s=gl(0,c,e);return o(c,pl(t,c,s.internals()),i,s.externals())},El=function(t){return t.hasOwnProperty("uid")?t:Ho({},t,{uid:iu("uid")})},Bl=wr([Kr("name"),Kr("factory"),Kr("configFields"),si("apis",{}),si("extraApis",{})]),Al=wr([Kr("name"),Kr("factory"),Kr("configFields"),Kr("partFields"),si("apis",{}),si("extraApis",{})]),Dl=function(t){var i=Pr("Sketcher for "+t.name,Bl,t),n=It(i.apis,gu),e=It(i.extraApis,function(t,n){return fu(t,n)});return Ho({name:Z(i.name),partFields:Z([]),configFields:Z(i.configFields),sketch:function(t){return n=i.name,e=i.configFields,o=i.factory,r=El(t),o(Ol(n,e,r,[],[]),r);var n,e,o,r}},n,e)},_l=function(t){var n=Pr("Sketcher for "+t.name,Al,t),e=sl(n.name,n.partFields),o=It(n.apis,gu),r=It(n.extraApis,function(t,n){return fu(t,n)});return Ho({name:Z(n.name),partFields:Z(n.partFields),configFields:Z(n.configFields),sketch:function(t){return Tl(n.name,n.configFields,n.partFields,n.factory,t)},parts:Z(e)},o,r)},Ml=function(t){return"input"===so(t)&&"radio"!==yo(t,"type")||"textarea"===so(t)},Fl=Object.freeze({getCurrent:function(t,n){return n.find(t)}}),Il=[Kr("find")],Vl=Va({fields:Il,name:"composing",apis:Fl}),Rl=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},Hl=function(t,n,e){return t<=n?n:e<=t?e:t},Nl=function(e,o,t,r){var n=ws(e.element(),"."+o.highlightClass);ft(n,function(n){at(r,function(t){return t.element()===n})||(Fu(n,o.highlightClass),e.getSystem().getByDom(n).each(function(t){o.onDehighlight(e,t),wi(t,Te())}))})},Pl=function(t,n,e,o){Nl(t,n,0,[o]),zl(t,n,e,o)||(Mu(o.element(),n.highlightClass),n.onHighlight(t,o),wi(o,Oe()))},zl=function(t,n,e,o){return Iu(o.element(),n.highlightClass)},Ll=function(t,n,e,o){var r=ws(t.element(),"."+n.itemClass);return tt.from(r[o]).fold(function(){return Xt.error("No element found with index "+o)},t.getSystem().getByDom)},jl=function(n,t){return fa(n.element(),"."+t.itemClass).bind(function(t){return n.getSystem().getByDom(t).toOption()})},Ul=function(n,t){var e=ws(n.element(),"."+t.itemClass);return(0<e.length?tt.some(e[e.length-1]):tt.none()).bind(function(t){return n.getSystem().getByDom(t).toOption()})},Wl=function(e,n,t,o){var r=ws(e.element(),"."+n.itemClass);return vt(r,function(t){return Iu(t,n.highlightClass)}).bind(function(t){var n=Rl(t,o,0,r.length-1);return e.getSystem().getByDom(r[n]).toOption()})},Gl=function(n,t){var e=ws(n.element(),"."+t.itemClass);return cn(st(e,function(t){return n.getSystem().getByDom(t).toOption()}))},Xl=Object.freeze({dehighlightAll:function(t,n){return Nl(t,n,0,[])},dehighlight:function(t,n,e,o){zl(t,n,e,o)&&(Fu(o.element(),n.highlightClass),n.onDehighlight(t,o),wi(o,Te()))},highlight:Pl,highlightFirst:function(n,e,o){jl(n,e,o).each(function(t){Pl(n,e,o,t)})},highlightLast:function(n,e,o){Ul(n,e,o).each(function(t){Pl(n,e,o,t)})},highlightAt:function(n,e,o,t){Ll(n,e,o,t).fold(function(t){throw new Error(t)},function(t){Pl(n,e,o,t)})},highlightBy:function(n,e,o,t){var r=Gl(n,e,o);ht(r,t).each(function(t){Pl(n,e,o,t)})},isHighlighted:zl,getHighlighted:function(n,t){return fa(n.element(),"."+t.highlightClass).bind(function(t){return n.getSystem().getByDom(t).toOption()})},getFirst:jl,getLast:Ul,getPrevious:function(t,n){return Wl(t,n,0,-1)},getNext:function(t,n){return Wl(t,n,0,1)},getCandidates:Gl}),Yl=[Kr("highlightClass"),Kr("itemClass"),wa("onHighlight"),wa("onDehighlight")],ql=Va({fields:Yl,name:"highlighting",apis:Xl}),Kl=function(t,n,e){var o=Ct(t.slice(0,n)),r=Ct(t.slice(n+1));return ht(o.concat(r),e)},Jl=function(t,n,e){var o=Ct(t.slice(0,n));return ht(o,e)},$l=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return ht(r.concat(o),e)},Ql=function(t,n,e){var o=t.slice(n+1);return ht(o,e)},Zl=function(e){return function(t){var n=t.raw();return ut(e,n.which)}},td=function(t){return function(n){return St(t,function(t){return t(n)})}},nd=function(t){return!0===t.raw().shiftKey},ed=function(t){return!0===t.raw().ctrlKey},od=N(nd),rd=function(t,n){return{matches:t,classification:n}},id=function(t,n){return ht(t,function(t){return t.matches(n)}).map(function(t){return t.classification})},ud=function(t){t.dom().focus()},ad=function(t){var n=t!==undefined?t.dom():x.document;return tt.from(n.activeElement).map(Be.fromDom)},cd=function(n){return ad(qe(n)).filter(function(t){return n.dom().contains(t.dom())})},sd=function(t,n,e){n.exists(function(n){return e.exists(function(t){return Ye(t,n)})})||Si(t,we(),{prevFocus:n,newFocus:e})},fd=function(){var r=function(t){return cd(t.element())};return{get:r,set:function(t,n){var e=r(t);t.getSystem().triggerFocus(n,t.element());var o=r(t);sd(t,e,o)}}},ld=function(){var r=function(t){return ql.getHighlighted(t).map(function(t){return t.element()})};return{get:r,set:function(n,t){var e=r(n);n.getSystem().getByDom(t).fold(Q,function(t){ql.highlight(n,t)});var o=r(n);sd(n,e,o)}}};(qo=Yo||(Yo={})).OnFocusMode="onFocus",qo.OnEnterOrSpaceMode="onEnterOrSpace",qo.OnApiMode="onApi";var dd,md,gd,pd=function(t,n,e,o,a){var c=function(n,e,t,o,r){var i=t(n,e,o,r);return id(i,e.event()).bind(function(t){return t(n,e,o,r)})},r={schema:function(){return t.concat([si("focusManager",fd()),fi("focusInside","onFocus",Ir(function(t){return ut(["onFocus","onEnterOrSpace","onApi"],t)?Xt.value(t):Xt.error("Invalid value for focusInside")})),Oa("handler",r),Oa("state",n),Oa("sendFocusIn",a)])},processKey:c,toEvents:function(i,u){var t=i.focusInside!==Yo.OnFocusMode?tt.none():a(i).map(function(e){return Ni(re(),function(t,n){e(t,i,u),n.stop()})});return Ii(t.toArray().concat([Ni(kn(),function(o,r){c(o,r,e,i,u).fold(function(){var n,e,t;n=o,e=r,t=Zl([32].concat([13]))(e.event()),i.focusInside===Yo.OnEnterOrSpaceMode&&t&&bi(n,e)&&a(i).each(function(t){t(n,i,u),e.stop()})},function(){r.stop()})}),Ni(Cn(),function(t,n){c(t,n,o,i,u).each(function(){n.stop()})})]))}};return r},hd=function(t){var n=[oi("onEscape"),oi("onEnter"),si("selector",'[data-alloy-tabstop="true"]'),si("firstTabstop",0),si("useTabstopAt",Z(!0)),oi("visibilitySelector")].concat([t]),u=function(t,n){var e=t.visibilitySelector.bind(function(t){return la(n,t)}).getOr(n);return 0<Za(e)},e=function(n,e){var t,o,r,i;(t=n,o=e,r=ws(t.element(),o.selector),i=mt(r,function(t){return u(o,t)}),tt.from(i[o.firstTabstop])).each(function(t){e.focusManager.set(n,t)})},a=function(n,t,e,o,r){return r(t,e,function(t){return u(n=o,e=t)&&n.useTabstopAt(e);var n,e}).fold(function(){return o.cyclic?tt.some(!0):tt.none()},function(t){return o.focusManager.set(n,t),tt.some(!0)})},r=function(n,t,e,o){var r,i,u=ws(n.element(),e.selector);return(r=n,i=e,i.focusManager.get(r).bind(function(t){return la(t,i.selector)})).bind(function(t){return vt(u,v(Ye,t)).bind(function(t){return a(n,u,t,e,o)})})},o=Z([rd(td([nd,Zl([9])]),function(t,n,e){var o=e.cyclic?Kl:Jl;return r(t,0,e,o)}),rd(Zl([9]),function(t,n,e){var o=e.cyclic?$l:Ql;return r(t,0,e,o)}),rd(Zl([27]),function(n,e,t){return t.onEscape.bind(function(t){return t(n,e)})}),rd(td([od,Zl([13])]),function(n,e,t){return t.onEnter.bind(function(t){return t(n,e)})})]),i=Z([]);return pd(n,pu.init,o,i,function(){return tt.some(e)})},vd=hd(vi("cyclic",Z(!1))),bd=hd(vi("cyclic",Z(!0))),yd=function(t,n,e){return Ml(e)&&Zl([32])(n.event())?tt.none():(Ci(t,e,ce()),tt.some(!0))},xd=function(){return tt.some(!0)},wd=[si("execute",yd),si("useSpace",!1),si("useEnter",!0),si("useControlEnter",!1),si("useDown",!1)],Sd=function(t,n,e){return e.execute(t,n,t.element())},kd=pd(wd,pu.init,function(t,n,e){var o=e.useSpace&&!Ml(t.element())?[32]:[],r=e.useEnter?[13]:[],i=e.useDown?[40]:[],u=o.concat(r).concat(i);return[rd(Zl(u),Sd)].concat(e.useControlEnter?[rd(td([ed,Zl([13])]),Sd)]:[])},function(t,n,e){return e.useSpace&&!Ml(t.element())?[rd(Zl([32]),xd)]:[]},function(){return tt.none()}),Cd=function(){var e=an(tt.none());return hu({readState:function(){return e.get().map(function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,n){e.set(tt.some({numRows:Z(t),numColumns:Z(n)}))},getNumRows:function(){return e.get().map(function(t){return t.numRows()})},getNumColumns:function(){return e.get().map(function(t){return t.numColumns()})}})},Od=Object.freeze({flatgrid:Cd,init:function(t){return t.state(t)}}),Td=function(i){return function(t,n,e,o){var r=i(t.element());return Dd(r,t,n,e,o)}},Ed=function(t,n){var e=os(t,n);return Td(e)},Bd=function(t,n){var e=os(n,t);return Td(e)},Ad=function(r){return function(t,n,e,o){return Dd(r,t,n,e,o)}},Dd=function(n,e,t,o,r){return o.focusManager.get(e).bind(function(t){return n(e.element(),t,o,r)}).map(function(t){return o.focusManager.set(e,t),!0})},_d=Ad,Md=Ad,Fd=Ad,Id=function(t){var n;return!((n=t.dom()).offsetWidth<=0&&n.offsetHeight<=0)},Vd=Fe(["index","candidates"],[]),Rd=function(t,n,e){return Hd(t,n,e,Id)},Hd=function(t,n,e){var o,r=v(Ye,n),i=ws(t,e),u=mt(i,Id);return vt(o=u,r).map(function(t){return Vd({index:t,candidates:o})})},Nd=function(t,n){return vt(t,function(t){return Ye(n,t)})},Pd=function(e,t,o,n){return n(Math.floor(t/o),t%o).bind(function(t){var n=t.row()*o+t.column();return 0<=n&&n<e.length?tt.some(e[n]):tt.none()})},zd=function(r,t,i,u,a){return Pd(r,t,u,function(t,n){var e=t===i-1?r.length-t*u:u,o=Rl(n,a,0,e-1);return tt.some({row:Z(t),column:Z(o)})})},Ld=function(i,t,u,a,c){return Pd(i,t,a,function(t,n){var e=Rl(t,c,0,u-1),o=e===u-1?i.length-e*a:a,r=Hl(n,0,o-1);return tt.some({row:Z(e),column:Z(r)})})},jd=[Kr("selector"),si("execute",yd),Sa("onEscape"),si("captureTab",!1),Ea()],Ud=function(n,e){fa(n.element(),e.selector).each(function(t){e.focusManager.set(n,t)})},Wd=function(r){return function(t,n,e,o){return Rd(t,n,e.selector).bind(function(t){return r(t.candidates(),t.index(),o.getNumRows().getOr(e.initSize.numRows),o.getNumColumns().getOr(e.initSize.numColumns))})}},Gd=function(t,n,e){return e.captureTab?tt.some(!0):tt.none()},Xd=Wd(function(t,n,e,o){return zd(t,n,e,o,-1)}),Yd=Wd(function(t,n,e,o){return zd(t,n,e,o,1)}),qd=Wd(function(t,n,e,o){return Ld(t,n,e,o,-1)}),Kd=Wd(function(t,n,e,o){return Ld(t,n,e,o,1)}),Jd=Z([rd(Zl([37]),Ed(Xd,Yd)),rd(Zl([39]),Bd(Xd,Yd)),rd(Zl([38]),_d(qd)),rd(Zl([40]),Md(Kd)),rd(td([nd,Zl([9])]),Gd),rd(td([od,Zl([9])]),Gd),rd(Zl([27]),function(t,n,e){return e.onEscape(t,n)}),rd(Zl([32].concat([13])),function(n,e,o){return(t=n,r=o,r.focusManager.get(t).bind(function(t){return la(t,r.selector)})).bind(function(t){return o.execute(n,e,t)});var t,r})]),$d=Z([rd(Zl([32]),xd)]),Qd=pd(jd,Cd,Jd,$d,function(){return tt.some(Ud)}),Zd=function(t,n,e,i){var u=function(t,n,e){var o,r=Rl(n,i,0,e.length-1);return r===t?tt.none():(o=e[r],"button"===so(o)&&"disabled"===yo(o,"disabled")?u(t,r,e):tt.from(e[r]))};return Rd(t,e,n).bind(function(t){var n=t.index(),e=t.candidates();return u(n,n,e)})},tm=[Kr("selector"),si("getInitial",tt.none),si("execute",yd),Sa("onEscape"),si("executeOnMove",!1),si("allowVertical",!0)],nm=function(n,e,o){return(t=n,r=o,r.focusManager.get(t).bind(function(t){return la(t,r.selector)})).bind(function(t){return o.execute(n,e,t)});var t,r},em=function(n,e){e.getInitial(n).orThunk(function(){return fa(n.element(),e.selector)}).each(function(t){e.focusManager.set(n,t)})},om=function(t,n,e){return Zd(t,e.selector,n,-1)},rm=function(t,n,e){return Zd(t,e.selector,n,1)},im=function(o){return function(t,n,e){return o(t,n,e).bind(function(){return e.executeOnMove?nm(t,n,e):tt.some(!0)})}},um=function(t,n,e){return e.onEscape(t,n)},am=Z([rd(Zl([32]),xd)]),cm=pd(tm,pu.init,function(t,n,e){var o=[37].concat(e.allowVertical?[38]:[]),r=[39].concat(e.allowVertical?[40]:[]);return[rd(Zl(o),im(Ed(om,rm))),rd(Zl(r),im(Bd(om,rm))),rd(Zl([13]),nm),rd(Zl([32]),nm),rd(Zl([27]),um)]},am,function(){return tt.some(em)}),sm=Fe(["rowIndex","columnIndex","cell"],[]),fm=function(t,n,e){return tt.from(t[n]).bind(function(t){return tt.from(t[e]).map(function(t){return sm({rowIndex:n,columnIndex:e,cell:t})})})},lm=function(t,n,e,o){var r=t[n].length,i=Rl(e,o,0,r-1);return fm(t,n,i)},dm=function(t,n,e,o){var r=Rl(e,o,0,t.length-1),i=t[r].length,u=Hl(n,0,i-1);return fm(t,r,u)},mm=function(t,n,e,o){var r=t[n].length,i=Hl(e+o,0,r-1);return fm(t,n,i)},gm=function(t,n,e,o){var r=Hl(e+o,0,t.length-1),i=t[r].length,u=Hl(n,0,i-1);return fm(t,r,u)},pm=[ti("selectors",[Kr("row"),Kr("cell")]),si("cycles",!0),si("previousSelector",tt.none),si("execute",yd)],hm=function(n,e){e.previousSelector(n).orThunk(function(){var t=e.selectors;return fa(n.element(),t.cell)}).each(function(t){e.focusManager.set(n,t)})},vm=function(t,n){return function(e,o,i){var u=i.cycles?t:n;return la(o,i.selectors.row).bind(function(t){var n=ws(t,i.selectors.cell);return Nd(n,o).bind(function(o){var r=ws(e,i.selectors.row);return Nd(r,t).bind(function(t){var n,e=(n=i,st(r,function(t){return ws(t,n.selectors.cell)}));return u(e,t,o).map(function(t){return t.cell()})})})})}},bm=vm(function(t,n,e){return lm(t,n,e,-1)},function(t,n,e){return mm(t,n,e,-1)}),ym=vm(function(t,n,e){return lm(t,n,e,1)},function(t,n,e){return mm(t,n,e,1)}),xm=vm(function(t,n,e){return dm(t,e,n,-1)},function(t,n,e){return gm(t,e,n,-1)}),wm=vm(function(t,n,e){return dm(t,e,n,1)},function(t,n,e){return gm(t,e,n,1)}),Sm=Z([rd(Zl([37]),Ed(bm,ym)),rd(Zl([39]),Bd(bm,ym)),rd(Zl([38]),_d(xm)),rd(Zl([40]),Md(wm)),rd(Zl([32].concat([13])),function(n,e,o){return cd(n.element()).bind(function(t){return o.execute(n,e,t)})})]),km=Z([rd(Zl([32]),xd)]),Cm=pd(pm,pu.init,Sm,km,function(){return tt.some(hm)}),Om=[Kr("selector"),si("execute",yd),si("moveOnTab",!1)],Tm=function(n,e,o){return o.focusManager.get(n).bind(function(t){return o.execute(n,e,t)})},Em=function(n,e){fa(n.element(),e.selector).each(function(t){e.focusManager.set(n,t)})},Bm=function(t,n,e){return Zd(t,e.selector,n,-1)},Am=function(t,n,e){return Zd(t,e.selector,n,1)},Dm=Z([rd(Zl([38]),Fd(Bm)),rd(Zl([40]),Fd(Am)),rd(td([nd,Zl([9])]),function(t,n,e){return e.moveOnTab?Fd(Bm)(t,n,e):tt.none()}),rd(td([od,Zl([9])]),function(t,n,e){return e.moveOnTab?Fd(Am)(t,n,e):tt.none()}),rd(Zl([13]),Tm),rd(Zl([32]),Tm)]),_m=Z([rd(Zl([32]),xd)]),Mm=pd(Om,pu.init,Dm,_m,function(){return tt.some(Em)}),Fm=[Sa("onSpace"),Sa("onEnter"),Sa("onShiftEnter"),Sa("onLeft"),Sa("onRight"),Sa("onTab"),Sa("onShiftTab"),Sa("onUp"),Sa("onDown"),Sa("onEscape"),si("stopSpaceKeyup",!1),oi("focusIn")],Im=pd(Fm,pu.init,function(t,n,e){return[rd(Zl([32]),e.onSpace),rd(td([od,Zl([13])]),e.onEnter),rd(td([nd,Zl([13])]),e.onShiftEnter),rd(td([nd,Zl([9])]),e.onShiftTab),rd(td([od,Zl([9])]),e.onTab),rd(Zl([38]),e.onUp),rd(Zl([40]),e.onDown),rd(Zl([37]),e.onLeft),rd(Zl([39]),e.onRight),rd(Zl([32]),e.onSpace),rd(Zl([27]),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[rd(Zl([32]),xd)]:[]},function(t){return t.focusIn}),Vm=vd.schema(),Rm=bd.schema(),Hm=cm.schema(),Nm=Qd.schema(),Pm=Cm.schema(),zm=kd.schema(),Lm=Mm.schema(),jm=Im.schema(),Um=Ha({branchKey:"mode",branches:Object.freeze({acyclic:Vm,cyclic:Rm,flow:Hm,flatgrid:Nm,matrix:Pm,execution:zm,menu:Lm,special:jm}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(n,e,o){e.sendFocusIn(e).fold(function(){n.getSystem().triggerFocus(n.element(),n.element())},function(t){t(n,e,o)})},setGridSize:function(t,n,e,o,r){un(e,"setGridSize")?e.setGridSize(o,r):x.console.error("Layout does not support setGridSize")}},state:Od}),Wm=function(t,n,e,o){var r=t.getSystem().build(o);rf(t,r,e)},Gm=function(t,n,e,o){var r=Xm(t,n);ht(r,function(t){return Ye(o.element(),t.element())}).each(sf)},Xm=function(t
){return t.components()},Ym=function(n,e,t,r,o){var i=Xm(n,e);return tt.from(i[r]).map(function(t){return Gm(n,e,0,t),o.each(function(t){Wm(n,0,function(t,n){var e,o;o=n,Ze(e=t,r).fold(function(){oo(e,o)},function(t){to(t,o)})},t)}),t})},qm=Va({fields:[],name:"replacing",apis:Object.freeze({append:function(t,n,e,o){Wm(t,0,oo,o)},prepend:function(t,n,e,o){Wm(t,0,eo,o)},remove:Gm,replaceAt:Ym,replaceBy:function(n,e,t,o,r){var i=Xm(n,e);return vt(i,o).bind(function(t){return Ym(n,e,0,t,r)})},set:function(n,t,e,o){var r,i,u,a;ff(n),r=function(){var t=st(o,n.getSystem().build);ft(t,function(t){of(n,t)})},i=n.element(),u=qe(i),a=ad(u).bind(function(n){var t=function(t){return Ye(n,t)};return t(i)?tt.some(i):Mi(i,t)}),r(i),a.each(function(n){ad(u).filter(function(t){return Ye(t,n)}).fold(function(){ud(n)},Q)})},contents:Xm})}),Km=function(t,n,e){n.store.manager.onLoad(t,n,e)},Jm=function(t,n,e){n.store.manager.onUnload(t,n,e)},$m=Object.freeze({onLoad:Km,onUnload:Jm,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Qm=Object.freeze({events:function(n,e){var t=n.resetOnDom?[Yi(function(t){Km(t,n,e)}),qi(function(t){Jm(t,n,e)})]:[Ba(n,e,Km)];return Ii(t)}}),Zm=function(){var t=an(null);return hu({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},tg=function(){var i=an({}),u=an({});return hu({readState:function(){return{mode:"dataset",dataByValue:i.get(),dataByText:u.get()}},lookup:function(t){return nn(i.get(),t).orThunk(function(){return nn(u.get(),t)})},update:function(t){var n=i.get(),e=u.get(),o={},r={};ft(t,function(n){o[n.value]=n,nn(n,"meta").each(function(t){nn(t,"text").each(function(t){r[t]=n})})}),i.set(Ho({},n,o)),u.set(Ho({},e,r))},clear:function(){i.set({}),u.set({})}})},ng=Object.freeze({memory:Zm,dataset:tg,manual:function(){return hu({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),eg=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},og=[oi("initialValue"),Kr("getFallbackEntry"),Kr("getDataKey"),Kr("setValue"),Oa("manager",{setValue:eg,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(n,e,o){e.store.initialValue.each(function(t){eg(n,e,o,t)})},onUnload:function(t,n,e){e.clear()},state:tg})],rg=[Kr("getValue"),si("setValue",Q),oi("initialValue"),Oa("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n){return n.store.getValue(t)},onLoad:function(n,e){e.store.initialValue.each(function(t){e.store.setValue(n,t)})},onUnload:Q,state:pu.init})],ig=[oi("initialValue"),Oa("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:Zm})],ug=[fi("store",{mode:"memory"},Lr("mode",{memory:ig,manual:rg,dataset:og})),wa("onSetValue"),si("resetOnDom",!1)],ag=Va({fields:ug,name:"representing",active:Qm,apis:$m,extra:{setValueFrom:function(t,n){var e=ag.getValue(n);ag.setValue(t,e)}},state:ng}),cg=function(t,n){n.ignore||(ud(t.element()),n.onFocus(t))},sg=Object.freeze({focus:cg,blur:function(t,n){n.ignore||t.element().dom().blur()},isFocused:function(t){return n=t.element(),e=qe(n).dom(),n.dom()===e.activeElement;var n,e}}),fg=Object.freeze({exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return bu(e)},events:function(e){return Ii([Ni(re(),function(t,n){cg(t,e),n.stop()})].concat(e.stopMousedown?[Ni(hn(),function(t,n){n.event().prevent()})]:[]))}}),lg=[wa("onFocus"),si("stopMousedown",!1),si("ignore",!1)],dg=Va({fields:lg,name:"focusing",active:fg,apis:sg}),mg=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},gg=function(n,t,e){t.toggleClass.each(function(t){e.get()?Mu(n.element(),t):Fu(n.element(),t)})},pg=function(t,n,e){bg(t,n,e,!e.get())},hg=function(t,n,e){e.set(!0),gg(t,n,e),mg(t,n,e)},vg=function(t,n,e){e.set(!1),gg(t,n,e),mg(t,n,e)},bg=function(t,n,e,o){(o?hg:vg)(t,n,e)},yg=function(t,n,e){bg(t,n,e,n.selected)},xg=Object.freeze({onLoad:yg,toggle:pg,isOn:function(t,n,e){return e.get()},on:hg,off:vg,set:bg}),wg=Object.freeze({exhibit:function(){return bu({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=pg,Ji(function(t){r(t,e,o)})),u=Ba(t,n,yg);return Ii(xt([t.toggleOnExecute?[i]:[],[u]]))}}),Sg=function(t,n,e){vo(t.element(),"aria-expanded",e)},kg=[si("selected",!1),oi("toggleClass"),si("toggleOnExecute",!0),fi("aria",{mode:"none"},Lr("mode",{pressed:[si("syncWithExpanded",!1),Oa("update",function(t,n,e){vo(t.element(),"aria-pressed",e),n.syncWithExpanded&&Sg(t,n,e)})],checked:[Oa("update",function(t,n,e){vo(t.element(),"aria-checked",e)})],expanded:[Oa("update",Sg)],selected:[Oa("update",function(t,n,e){vo(t.element(),"aria-selected",e)})],none:[Oa("update",Q)]}))],Cg=Va({fields:kg,name:"toggling",active:wg,apis:xg,state:(dd=!1,{init:function(){var n=an(dd);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(dd)},readState:function(){return n.get()}}}})}),Og="alloy.item-hover",Tg="alloy.item-focus",Eg=function(t){(cd(t.element()).isNone()||dg.isFocused(t))&&(dg.isFocused(t)||dg.focus(t),Si(t,Og,{item:t}))},Bg=function(t){Si(t,Tg,{item:t})},Ag=Z(Og),Dg=Z(Tg),_g=function(t,n){var e,o;return{key:t,value:{config:{},me:(e=t,o=Ii(n),Va({fields:[Kr("enabled")],name:e,active:{events:Z(o)}})),configAsRaw:Z({}),initialConfig:{},state:pu}}},Mg=[Kr("data"),Kr("components"),Kr("dom"),si("hasSubmenu",!1),oi("toggling"),_f.field("itemBehaviours",[Cg,dg,Um,ag]),si("ignoreFocus",!1),si("domModification",{}),Oa("builder",function(t){return{dom:t.dom,domModification:Ho({},t.domModification,{attributes:Ho({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes,{"aria-haspopup":t.hasSubmenu},t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:_f.augment(t.itemBehaviours,[t.toggling.fold(Cg.revoke,function(t){return Cg.config(Ho({aria:{mode:"checked"}},t))}),dg.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Bg(t)}}),Um.config({mode:"execution"}),ag.config({store:{mode:"memory",initialValue:t.data}}),_g("item-type-events",[Ni(le(),ki),Wi(hn()),Ni(xn(),Eg),Ni(se(),dg.focus)])]),components:t.components,eventOrder:t.eventOrder}}),si("eventOrder",{})],Fg=[Kr("dom"),Kr("components"),Oa("builder",function(t){return{dom:t.dom,components:t.components,events:Ii([Gi(se())])}})],Ig=Z([el({name:"widget",overrides:function(t){return{behaviours:Fa([ag.config({store:{mode:"manual",getValue:function(){return t.data},setValue:function(){}}})])}}})]),Vg=[Kr("uid"),Kr("data"),Kr("components"),Kr("dom"),si("autofocus",!1),si("ignoreFocus",!1),_f.field("widgetBehaviours",[ag,dg,Um]),si("domModification",{}),kl(Ig()),Oa("builder",function(e){var t=gl(0,e,Ig()),n=pl("item-widget",e,t.internals()),o=function(t){return hl(t,e,"widget").map(function(t){return Um.focusIn(t),t})},r=function(t,n){return Ml(n.event().target())||e.autofocus&&n.setSource(t.element()),tt.none()};return{dom:e.dom,components:n,domModification:e.domModification,events:Ii([Ji(function(t,n){o(t).each(function(){n.stop()})}),Ni(xn(),Eg),Ni(se(),function(t){e.autofocus?o(t):dg.focus(t)})]),behaviours:_f.augment(e.widgetBehaviours,[ag.config({store:{mode:"memory",initialValue:e.data}}),dg.config({ignore:e.ignoreFocus,onFocus:function(t){Bg(t)}}),Um.config({mode:"special",focusIn:e.autofocus?function(t){o(t)}:Na(),onLeft:r,onRight:r,onEscape:function(t,n){return dg.isFocused(t)||e.autofocus?(e.autofocus&&n.setSource(t.element()),tt.none()):(dg.focus(t),tt.some(!0))}})])}})],Rg=Lr("type",{widget:Vg,item:Mg,separator:Fg}),Hg=Z([il({factory:{sketch:function(t){var n=Pr("menu.spec item",Rg,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:Ho({},n,{uid:iu("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Ng=Z([Kr("value"),Kr("items"),Kr("dom"),Kr("components"),si("eventOrder",{}),Bf("menuBehaviours",[ql,ag,Vl,Um]),fi("movement",{mode:"menu",moveOnTab:!0},Lr("mode",{grid:[Ea(),Oa("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[Oa("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),Kr("rowSelector")],menu:[si("moveOnTab",!0),Oa("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),Jr("markers",ha()),si("fakeFocus",!1),si("focusManager",fd()),wa("onHighlight")]),Pg=Z("alloy.menu-focus"),zg=_l({name:"Menu",configFields:Ng(),partFields:Hg(),factory:function(t,n){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Df(t.menuBehaviours,[ql.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),ag.config({store:{mode:"memory",initialValue:t.value}}),Vl.config({find:tt.some}),Um.config(t.movement.config(t,t.movement))]),events:Ii([Ni(Dg(),function(n,e){var t=e.event();n.getSystem().getByDom(t.target()).each(function(t){ql.highlight(n,t),e.stop(),Si(n,Pg(),{menu:n,item:t})})}),Ni(Ag(),function(t,n){var e=n.event().item();ql.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Lg=function(e,o,r,t){return nn(r,t).bind(function(t){return nn(e,t).bind(function(t){var n=Lg(e,o,r,t);return tt.some([t].concat(n))})}).getOr([])},jg=function(t,n){var e={};Ft(t,function(t,n){ft(t,function(t){e[t]=n})});var o=n,r=Vt(n,function(t,n){return{k:t,v:n}}),i=It(r,function(t,n){return[n].concat(Lg(e,o,r,n))});return It(e,function(t){return nn(i,t).getOr([t])})},Ug=function(){var i=an({}),u=an({}),a=an({}),c=an(tt.none()),s=an({}),n=function(t){return nn(u.get(),t)};return{setMenuBuilt:function(t,n){var e;u.set(Ho({},u.get(),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,e,o){c.set(tt.some(t)),i.set(e),u.set(n),s.set(o);var r=jg(o,e);a.set(r)},expand:function(e){return nn(i.get(),e).map(function(t){var n=nn(a.get(),e).getOr([]);return[t].concat(n)})},refresh:function(t){return nn(a.get(),t)},collapse:function(t){return nn(a.get(),t).bind(function(t){return 1<t.length?tt.some(t.slice(1)):tt.none()})},lookupMenu:n,otherMenus:function(t){var n=s.get();return Ot(_t(n),t)},getPrimary:function(){return c.get().bind(function(t){return n(t).bind(function(t){return"prepared"===t.type?tt.some(t.menu):tt.none()})})},getMenus:function(){return u.get()},clear:function(){i.set({}),u.set({}),a.set({}),c.set(tt.none())},isClear:function(){return c.get().isNone()}}},Wg=Z("collapse-item"),Gg=Dl({name:"TieredMenu",configFields:[Ca("onExecute"),Ca("onEscape"),ka("onOpenMenu"),ka("onOpenSubmenu"),wa("onCollapseMenu"),si("highlightImmediately",!0),ti("data",[Kr("primary"),Kr("menus"),Kr("expansions")]),si("fakeFocus",!1),wa("onHighlight"),wa("onHover"),ba(),Kr("dom"),si("navigateOnHover",!0),si("stayInDom",!1),Bf("tmenuBehaviours",[Um,ql,Vl,qm]),si("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)}},factory:function(a){var c,t,i=an(tt.none()),s=Ug(),e=function(t){var o,r,n,e=(o=t,r=a.data.primary,n=a.data.menus,It(n,function(t,n){var e=function(){return zg.sketch(Ho({dom:t.dom},t,{value:n,items:t.items,markers:a.markers,fakeFocus:a.fakeFocus,onHighlight:a.onHighlight,focusManager:a.fakeFocus?ld():fd()}))};return n===r?{type:"prepared",menu:o.getSystem().build(e())}:{type:"notbuilt",nbMenu:e}})),i=u(t);return s.setContents(a.data.primary,e,a.data.expansions,i),s.getPrimary()},f=function(t){return ag.getValue(t).value},u=function(){return It(a.data.menus,function(t){return wt(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},l=function(n,t){ql.highlight(n,t),ql.getHighlighted(t).orThunk(function(){return ql.getFirst(t)}).each(function(t){Ci(n,t.element(),se())})},d=function(n,t){return cn(st(t,function(t){return n.lookupMenu(t).bind(function(t){return"prepared"===t.type?tt.some(t.menu):tt.none()})}))},m=function(n,t,e){var o=d(t,t.otherMenus(e));ft(o,function(t){Ru(t.element(),[a.markers.backgroundMenu]),a.stayInDom||qm.remove(n,t)})},g=function(t,o){var r,n=(r=t,i.get().getOrThunk(function(){var e={},t=ws(r.element(),"."+a.markers.item),n=mt(t,function(t){return"true"===yo(t,"aria-haspopup")});return ft(n,function(t){r.getSystem().getByDom(t).each(function(t){var n=f(t);e[n]=t})}),i.set(tt.some(e)),e}));Ft(n,function(t,n){var e=ut(o,n);vo(t.element(),"aria-expanded",e)})},p=function(o,r,i){return tt.from(i[0]).bind(function(t){return r.lookupMenu(t).bind(function(t){if("notbuilt"===t.type)return tt.none();var n=t.menu,e=d(r,i.slice(1));return ft(e,function(t){Mu(t.element(),a.markers.backgroundMenu)}),Ei(n.element())||qm.append(o,aa(n)),Ru(n.element(),[a.markers.backgroundMenu]),l(o,n),m(o,r,i),tt.some(n)})})};(t=c||(c={}))[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent";var h=function(r,i,u){void 0===u&&(u=c.HighlightSubmenu);var t=f(i);return s.expand(t).bind(function(o){return g(r,o),tt.from(o[0]).bind(function(e){return s.lookupMenu(e).bind(function(t){var n=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return s.setMenuBuilt(n,o),o}(r,e,t);return Ei(n.element())||qm.append(r,aa(n)),a.onOpenSubmenu(r,i,n),u===c.HighlightSubmenu?(ql.highlightFirst(n),p(r,s,o)):(ql.dehighlightAll(n),tt.some(i))})})})},o=function(n,e){var t=f(e);return s.collapse(t).bind(function(t){return g(n,t),p(n,s,t).map(function(t){return a.onCollapseMenu(n,e,t),t})})},n=function(e){return function(n,t){return la(t.getSource(),"."+a.markers.item).bind(function(t){return n.getSystem().getByDom(t).toOption().bind(function(t){return e(n,t).map(function(){return!0})})})}},r=Ii([Ni(Pg(),function(n,t){var e=t.event().menu();ql.highlight(n,e);var o=f(t.event().item());s.refresh(o).each(function(t){return m(n,s,t)})}),Ji(function(n,t){var e=t.event().target();n.getSystem().getByDom(e).each(function(t){0===f(t).indexOf("collapse-item")&&o(n,t),h(n,t,c.HighlightSubmenu).fold(function(){a.onExecute(n,t)},function(){})})}),Yi(function(n){e(n).each(function(t){qm.append(n,aa(t)),a.onOpenMenu(n,t),a.highlightImmediately&&l(n,t)})})].concat(a.navigateOnHover?[Ni(Ag(),function(t,n){var e,o,r=n.event().item();e=t,o=f(r),s.refresh(o).bind(function(t){return g(e,t),p(e,s,t)}),h(t,r,c.HighlightParent),a.onHover(t,r)})]:[])),v={collapseMenu:function(n){ql.getHighlighted(n).each(function(t){ql.getHighlighted(t).each(function(t){o(n,t)})})},highlightPrimary:function(n){s.getPrimary().each(function(t){l(n,t)})}};return{uid:a.uid,dom:a.dom,markers:a.markers,behaviours:Df(a.tmenuBehaviours,[Um.config({mode:"special",onRight:n(function(t,n){return Ml(n.element())?tt.none():h(t,n,c.HighlightSubmenu)}),onLeft:n(function(t,n){return Ml(n.element())?tt.none():o(t,n)}),onEscape:n(function(t,n){return o(t,n).orThunk(function(){return a.onEscape(t,n).map(function(){return t})})}),focusIn:function(n){s.getPrimary().each(function(t){Ci(n,t.element(),se())})}}),ql.config({highlightClass:a.markers.selectedMenu,itemClass:a.markers.menu}),Vl.config({find:function(t){return ql.getHighlighted(t)}}),qm.config({})]),eventOrder:a.eventOrder,apis:v,events:r}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:en(t,n),expansions:{}}},collapseItem:function(t){return{value:Vo(Wg()),meta:{text:t}}}}}),Xg=Dl({name:"InlineView",configFields:[Kr("lazySink"),wa("onShow"),wa("onHide"),ai("onEscape"),Bf("inlineBehaviours",[Sf,La]),ci("fireDismissalEventInstead",[si("event",xe())]),si("getRelated",tt.none),si("eventOrder",tt.none)],factory:function(s){var r=function(t,n,e,o){var r=s.lazySink(t).getOrDie();Sf.openWhileCloaked(t,e,function(){return tf.positionWithin(r,n,t,o)}),s.onShow(t)},t={setContent:function(t,n){Sf.open(t,n)},showAt:function(t,n,e){var o=tt.none();r(t,n,e,o)},showWithin:r,showMenuAt:function(t,n,e){var o,r,i,u,a,c=(o=s,r=t,i=n,u=e,a=function(){return o.lazySink(r)},Gg.sketch({dom:{tag:"div"},data:u.data,markers:u.menu.markers,onEscape:function(){return Sf.close(r),o.onEscape.map(function(t){return t(r)}),tt.some(!0)},onExecute:function(){return tt.some(!0)},onOpenMenu:function(t,n){tf.position(a().getOrDie(),i,n)},onOpenSubmenu:function(t,n,e){var o=a().getOrDie();tf.position(o,{anchor:"submenu",item:n},e)}}));Sf.open(t,c),s.onShow(t)},hide:function(t){Sf.close(t),s.onHide(t)},getContent:function(t){return Sf.getState(t)},isOpen:Sf.isOpen};return{uid:s.uid,dom:s.dom,behaviours:Df(s.inlineBehaviours,[Sf.config({isPartOf:function(t,n,e){return ma(n,e)||(o=t,r=e,s.getRelated(o).exists(function(t){return ma(t,r)}));var o,r},getAttachPoint:function(t){return s.lazySink(t).getOrDie()}}),Tf(Ho({isExtraPart:Z(!1)},s.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))]),eventOrder:s.eventOrder,apis:t}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)}}}),Yg=function(t){var n=function(t,n){n.stop(),ki(t)},e=ee.detect().deviceType.isTouch()?[Ni(fe(),n)]:[Ni(En(),n),Ni(hn(),function(t,n){n.cut()})];return Ii(xt([t.map(function(e){return Ni(ce(),function(t,n){e(t),n.stop()})}).toArray(),e]))},qg=Dl({name:"Button",factory:function(t){var n=Yg(t.action),e=t.dom.tag,o=function(n){return nn(t.dom,"attributes").bind(function(t){return nn(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:_f.augment(t.buttonBehaviours,[dg.config({}),Um.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return Ho({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[si("uid",undefined),Kr("dom"),si("components",[]),_f.field("buttonBehaviours",[dg,Um]),oi("action"),oi("role"),si("eventOrder",{})]}),Kg=function(t){var n=e(t)&&un(t,"uid")?t.uid:iu("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).fold(tt.none,tt.some)},asSpec:function(){return Ho({},t,{uid:n})}}},Jg=function(t){return tt.from(t()["temporary-placeholder"]).getOr("!not found!")},$g=function(t,n){return tt.from(n()[t]).getOrThunk(function(){return Jg(n)})},Qg={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Zg=Dl({name:"Notification",factory:function(n){var t,e,o=Kg({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:Fa([qm.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=Kg({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:Fa([qm.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){qm.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])})},updateText:function(t,n){if(t.getSystem().isConnected()){var e=o.get(t);qm.set(e,[oa(n)])}}},c=xt([n.icon.toArray(),n.level.toArray(),n.level.bind(function(t){return tt.from(Qg[t])}).toArray()]);return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(t=c,e=n.iconProvider,sn(t,function(t){return tt.from(e()[t])}).getOrThunk(function(){return Jg(e)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:Fa([qm.config({})])}].concat(n.progress?[u.asSpec()]:[]).concat(qg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:$g("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),apis:a}},configFields:[oi("level"),Kr("progress"),Kr("icon"),Kr("onAction"),Kr("text"),Kr("iconProvider"),Kr("translationProvider")],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),tp=tinymce.util.Tools.resolve("tinymce.util.Delay"),np=function(e,o){var r=null;return{cancel:function(){null!==r&&(x.clearTimeout(r),r=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null!==r&&x.clearTimeout(r),r=x.setTimeout(function(){e.apply(null,t),r=null},o)}}},ep=/[\u00a0 \t\r\n]/,op=function(e,t,n,o,r){return void 0===r&&(r=0),(i=e).collapsed&&3===i.startContainer.nodeType?function(t,n,e,o){var r;for(r=n-1;0<=r;r--){if(ep.test(t.charAt(r)))return tt.none();if(t.charAt(r)===e)break}return-1===r||n-r<o?tt.none():tt.some(t.substring(r+1,n))}(n,o,t,r).map(function(t){var n=e.cloneRange();return n.setStart(e.startContainer,e.startOffset-t.length-1),n.setEnd(e.startContainer,e.startOffset),{text:t,rng:n}}):tt.none();var i},rp=function(e,t){t.on("keypress",e.onKeypress.throttle),t.on("remove",e.onKeypress.cancel);var o=function(t,n){Si(t,kn(),{raw:n})};t.on("keydown",function(n){var t=function(){return e.getView().bind(ql.getHighlighted)};8===n.which&&e.onKeypress.throttle(n),e.isActive()&&(27===n.which?e.closeIfNecessary():32===n.which?e.closeIfNecessary():13===n.which?(t().each(ki),n.preventDefault()):40===n.which?(t().fold(function(){e.getView().each(ql.highlightFirst)},function(t){o(t,n)}),n.preventDefault()):37!==n.which&&38!==n.which&&39!==n.which||t().each(function(t){o(t,n),n.preventDefault()}))})},ip=tinymce.util.Tools.resolve("tinymce.util.Promise"),up=function(t,n){return 0===t.startOffset||/\s/.test(n.charAt(t.startOffset-1))},ap=function(t,n){var e,o,r,i=n(),u=t.selection.getRng(),a=u.startContainer.nodeValue;return(e=u,o=a,r=i,sn(r.triggerChars,function(n){return op(e,n,o,e.startOffset).map(function(t){return{range:t.rng,text:t.text,triggerChar:n}})})).map(function(e){var t=mt(i.lookupByChar(e.triggerChar),function(t){return e.text.length>=t.minChars&&t.matches.getOr(up)(e.range,a,e.text)});return{lookupData:ip.all(st(t,function(n){return n.fetch(e.text,n.maxResults).then(function(t){return{items:t,columns:n.columns,onAction:n.onAction}})})),triggerChar:e.triggerChar,range:e.range}})},cp=Sr([vi("type",function(){return"autocompleteitem"}),vi("active",function(){return!1}),vi("disabled",function(){return!1}),si("meta",{}),$r("value"),ui("text"),ui("icon")]),sp=Sr([$r("type"),$r("ch"),li("minChars",1),si("columns",1),li("maxResults",10),ai("matches"),Zr("fetch"),Zr("onAction")]),fp=function(t){var n,e,o=t.ui.registry.getAll().popups,r=It(o,function(t){return(n=t,Hr("Autocompleter",sp,n)).fold(function(t){throw new Error(zr(t))},function(t){return t});var n}),i=(n=Rt(r,function(t){return t.ch}),e={},ft(n,function(t){e[t]={}}),_t(e)),u=Nt(r);return{dataset:r,triggerChars:i,lookupByChar:function(n){return mt(u,function(t){return t.ch===n})}}},lp=[gi("disabled",!1),ui("text"),ui("shortcut"),Br("value","value",Wo(function(){return Vo("menuitem-value")}),jr()),si("meta",{})],dp=Sr([$r("type"),pi("onSetup",function(){return Q}),pi("onAction",Q),ui("icon")].concat(lp)),mp=Sr([$r("type"),Zr("getSubmenuItems"),pi("onSetup",function(){return Q}),ui("icon")].concat(lp)),gp=Sr([$r("type"),gi("active",!1),pi("onSetup",function(){return Q}),Zr("onAction")].concat(lp)),pp=Sr([$r("type"),gi("active",!1),ui("icon")].concat(lp)),hp=Sr([$r("type"),ui("text")]),vp=Sr([$r("type"),Qr("fancytype",["inserttable"]),pi("onAction",Q)]),bp=function(t,o,n){var r=ws(t.element(),"."+n);if(0<r.length){var e=vt(r,function(t){var n=t.dom().getBoundingClientRect().top,e=r[0].dom().getBoundingClientRect().top;return Math.abs(n-e)>o}).getOr(r.length);return tt.some({numColumns:e,numRows:Math.ceil(r.length/e)})}return tt.none()},yp=function(t,n){return Fa([_g(t,n)])},xp=function(t){return yp(Vo("unnamed-events"),t)},wp=[Kr("lazySink"),Kr("tooltipDom"),si("exclusive",!0),si("tooltipComponents",[]),si("delay",300),mi("mode","normal",["normal","follow-highlight"]),si("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:Z([$c,Jc,Xc,qc,Yc,Kc]),onRtl:Z([$c,Jc,Xc,qc,Yc,Kc])}}}),wa("onHide"),wa("onShow")],Sp=Object.freeze({init:function(){var e=an(tt.none()),n=an(tt.none()),o=function(){e.get().each(function(t){x.clearTimeout(t)})},t=Z("not-implemented");return hu({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(tt.some(t))},clearTooltip:function(){n.set(tt.none())},clearTimer:o,resetTimer:function(t,n){o(),e.set(tt.some(x.setTimeout(function(){t()},n)))},readState:t})}}),kp=Vo("tooltip.exclusive"),Cp=Vo("tooltip.show"),Op=Vo("tooltip.hide"),Tp=function(t){t.getSystem().broadcastOn([kp],{})},Ep=Object.freeze({hideAllExclusive:Tp,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&qm.set(t,o)})}}),Bp=Va({fields:wp,name:"tooltipping",active:Object.freeze({events:function(o,r){var e=function(n){r.getTooltip().each(function(t){sf(t),o.onHide(n,t),r.clearTooltip()}),r.clearTimer()};return Ii(xt([[Ni(Cp,function(t){r.resetTimer(function(){!function(t){if(!r.isShowing()){Tp(t);var n=o.lazySink(t).getOrDie(),e=t.getSystem().build({dom:o.tooltipDom,components:o.tooltipComponents,events:Ii("normal"===o.mode?[Ni(xn(),function(){wi(t,Cp)}),Ni(bn(),function(){wi(t,Op)})]:[]),behaviours:Fa([qm.config({})])});r.setTooltip(e),of(n,e),o.onShow(t,e),tf.position(n,o.anchor(t),e)}}(t)},o.delay)}),Ni(Op,function(t){r.resetTimer(function(){e(t)},o.delay)}),Ni(ae(),function(t,n){ut(n.channels(),kp)&&e(t)}),qi(function(t){e(t)})],"normal"===o.mode?[Ni(wn(),function(t){wi(t,Cp)}),Ni(ie(),function(t){wi(t,Op)}),Ni(xn(),function(t){wi(t,Cp)}),Ni(bn(),function(t){wi(t,Op)})]:[Ni(Oe(),function(t){wi(t,Cp)}),Ni(Te(),function(t){wi(t,Op)})]]))}}),state:Sp,apis:Ep}),Ap=function(t){var n,e,o,r=Be.fromHtml(t),i=Qe(r),u=(e=(n=r).dom().attributes!==undefined?n.dom().attributes:[],pt(e,function(t,n){var e;return"class"===n.name?t:Ho({},t,((e={})[n.name]=n.value,e))},{})),a=(o=r,Array.prototype.slice.call(o.dom().classList,0)),c=0===i.length?{}:{innerHtml:ao(r)};return Ho({tag:so(r),classes:a,attributes:u},c)},Dp=tinymce.util.Tools.resolve("tinymce.util.I18n"),_p="tox-menu-nav__js",Mp="tox-collection__item",Fp="tox-swatch",Ip={normal:_p,color:Fp},Vp="tox-collection__item--enabled",Rp="tox-collection__item-icon",Hp="tox-collection__item-label",Np="tox-collection__item--active",Pp=function(t){return nn(Ip,t).getOr(_p)},zp=tinymce.util.Tools.resolve("tinymce.Env"),Lp=function(t){var e=zp.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},n=t.split("+"),o=st(n,function(t){var n=t.toLowerCase().trim();return zt(e,n)?e[n]:t});return zp.mac?o.join(""):o.join("+")},jp=function(t){return{dom:{tag:"div",classes:[Rp],innerHtml:t}}},Up=function(t){return{dom:{tag:"div",classes:[Hp]},components:[oa(Dp.translate(t))]}},Wp=function(t,n){return{dom:{tag:"div",classes:[Hp]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[oa(Dp.translate(n))]}]}},Gp=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:Lp(t)}}},Xp=function(t){return{dom:{tag:"div",classes:[Rp,"tox-collection__item-checkmark"],innerHtml:$g("checkmark",t)}}},Yp=function(t,r,n,i){void 0===i&&(i=tt.none());var e,o,u,a,c,s,f,l,d,m,g,p=t.iconContent.map(function(t){return n=t,e=r.icons,o=i,tt.from(e()[n]).or(o).getOrThunk(function(){return Jg(e)});var n,e,o}),h=tt.from(t.meta).fold(function(){return Up},function(t){return zt(t,"style")?v(Wp,t.style):Up});return"color"===t.presets?(s=t.ariaLabel,f=t.value,l=r,{dom:(d=Fp,m=p.getOr(""),g=s.map(function(t){return' title="'+l.translate(t)+'"'}).getOr(""),Ap("custom"===f?'<button class="'+d+' tox-swatches__picker-btn"'+g+">"+m+"</button>":"remove"===f?'<div class="'+d+' tox-swatch--remove"'+g+">"+m+"</div>":'<div class="'+d+'" style="background-color: '+f+'" data-mce-color="'+f+'"'+g+"></div>")),optComponents:[]}):(e=t,o=p,u=h,a=n?e.checkMark.orThunk(function(){return o.or(tt.some("")).map(jp)}):tt.none(),c=e.ariaLabel.map(function(t){return{attributes:{title:Dp.translate(t)}}}).getOr({}),{dom:$t({tag:"div",classes:[_p,Mp]},c),optComponents:[a,e.textContent.map(u),e.shortcutContent.map(Gp),e.caret]})},qp=["input","button","textarea"],Kp=function(t,n,e){n.disabled&&nh(t,n,e)},Jp=function(t){return ut(qp,so(t.element()))},$p=function(t){vo(t.element(),"disabled","disabled")},Qp=function(t){wo(t.element(),"disabled")},Zp=function(t){vo(t.element(),"aria-disabled","true")},th=function(t){vo(t.element(),"aria-disabled","false")},nh=function(n,t){t.disableClass.each(function(t){Mu(n.element(),t)}),(Jp(n)?$p:Zp)(n)},eh=function(n,t){t.disableClass.each(function(t){Fu(n.element(),t)}),(Jp(n)?Qp:th)(n)},oh=function(t){return Jp(t)?xo(t.element(),"disabled"):"true"===yo(t.element(),"aria-disabled")},rh=Object.freeze({enable:eh,disable:nh,isDisabled:oh,onLoad:Kp,set:function(t,n,e,o){(o?nh:eh)(t,n,e)}}),ih=Object.freeze({exhibit:function(t,n){return bu({classes:n.disabled?n.disableClass.map(Tt).getOr([]):[]})},events:function(t,n){return Ii([Vi(ce(),function(t){return oh(t)}),Ba(t,n,Kp)])}}),uh=[si("disabled",!1),oi("disableClass")],ah=Va({fields:uh,name:"disabling",active:ih,apis:rh}),ch=function(t){return ah.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},sh=function(t){return ah.config({disabled:t})},fh=function(t){return ah.config({disabled:t,disableClass:"tox-tbtn--disabled"})},lh=function(t,n){var e=t.getApi(n);return function(t){t(e)}},dh=function(e,o){return Yi(function(t){lh(e,t)(function(t){var n=e.onSetup(t);null!==n&&n!==undefined&&o.set(n)})})},mh=function(n,e){return qi(function(t){return lh(n,t)(e.get())})};(gd=md||(md={}))[gd.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",gd[gd.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var gh,ph,hh=md,vh={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},bh=function(t){return wt(t,function(t){return t.toArray()})},yh=function(t,n,e){var o,r,i=an(Q);return{type:"item",dom:n.dom,components:bh(n.optComponents),data:t.data,eventOrder:vh,hasSubmenu:t.triggersSubmenu,itemBehaviours:Fa([_g("item-events",[(o=t,r=e,Ji(function(t,n){lh(o,t)(o.onAction),o.triggersSubmenu||r!==hh.CLOSE_ON_EXECUTE||(wi(t,me()),n.stop())})),dh(t,i),mh(t,i)]),ch(t.disabled),qm.config({})].concat(t.itemBehaviours))}},xh=function(t){return{value:t.value,meta:$t({text:t.text.getOr("")},t.meta)}},wh=Z(sl("item-widget",Ig())),Sh=Vo("cell-over"),kh=Vo("cell-execute"),Ch=function(n,e,t){var o,r=function(t){return Si(t,kh,{row:n,col:e})};return ua({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=t,o)},behaviours:Fa([_g("insert-table-picker-cell",[Ni(xn(),dg.focus),Ni(ce(),r),Ni(le(),r)]),Cg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),dg.config({onFocus:function(t){return Si(t,Sh,{row:n,col:e})}})])})},Oh={inserttable:function $D(o){var t,n=Vo("size-label"),a=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(Ch(r,u,t));o.push(i)}return o}(n,10,10),c=Kg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[oa("0x0")],behaviours:Fa([qm.config({})])});return{type:"widget",data:{value:Vo("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[wh().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:(t=a,wt(t,function(t){return st(t,aa)})).concat(c.asSpec()),behaviours:Fa([_g("insert-table-picker",[Ui(Sh,function(t,n,e){var o,r,i=e.event().row(),u=e.event().col();!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Cg.set(t[i][u],i<=n&&u<=e)}(a,i,u,10,10),qm.set(c.get(t),[(o=i,r=u,oa(
r+1+"x"+(o+1)))])}),Ui(kh,function(t,n,e){o.onAction({numRows:e.event().row()+1,numColumns:e.event().col()+1}),wi(t,me())})]),Um.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}}},Th=function(t,n,e,o,r,i,u){var a=Yp({presets:e,textContent:n?t.text:tt.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:tt.none(),checkMark:n?tt.some(Xp(u.icons)):tt.none(),caret:tt.none(),value:t.value},u,!0);return Jt(yh({data:xh(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Cg.set(n,t)},isActive:function(){return Cg.isOn(n)},isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},onAction:function(){return o(t.value)},onSetup:function(t){return t.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},a,i),{toggling:{toggleClass:Vp,toggleOnExecute:!1,selected:t.active}})},Eh=function(t,n,e,o,r,i,u){void 0===u&&(u=!0);var a,c,s=Yp({presets:e,textContent:n?t.text:tt.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:tt.none(),checkMark:tt.none(),caret:tt.none(),value:t.value},i.providers,u,t.icon);return yh({data:xh(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(){return o(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(a=t.meta,c=i,Pt(a,"tooltipWorker").map(function(t){return[Bp.config({lazySink:c.getSink,tooltipDom:{tag:"div"},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t}},mode:"follow-highlight",onShow:function(n){t(function(t){Bp.setComponents(n,[ra({element:Be.fromDom(t)})])})}})]}).getOr([]))},s,r)},Bh=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:Ho({tag:"div",classes:[Mp,"tox-collection__group-heading"]},n),components:[]}},Ah=function(t,n,e,o){void 0===o&&(o=!0);var r=Yp({presets:"normal",iconContent:t.icon,textContent:t.text,ariaLabel:t.text,caret:tt.none(),checkMark:tt.none(),shortcutContent:t.shortcut},e,o);return yh({data:xh(t),getApi:function(n){return{isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n)},Dh=function(t,n,e,o){void 0===o&&(o=!0);var r,i=(r=e.icons,{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:$g("chevron-right",r)}}),u=Yp({presets:"normal",iconContent:t.icon,textContent:t.text,ariaLabel:t.text,caret:tt.some(i),checkMark:tt.none(),shortcutContent:t.shortcut},e,o);return yh({data:xh(t),getApi:function(n){return{isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},disabled:t.disabled,onAction:Q,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},u,n)},_h=function(t,n,e){var o=Yp({iconContent:tt.none(),textContent:t.text,ariaLabel:t.text,checkMark:tt.some(Xp(e.icons)),caret:tt.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,!0);return Jt(yh({data:xh(t),disabled:t.disabled,getApi:function(n){return{setActive:function(t){Cg.set(n,t)},isActive:function(){return Cg.isOn(n)},isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,n),{toggling:{toggleClass:Vp,toggleOnExecute:!1,selected:t.active}})},Mh=function(n){return(t=Oh,e=n.fancytype,Object.prototype.hasOwnProperty.call(t,e)?tt.some(t[e]):tt.none()).map(function(t){return t(n)});var t,e},Fh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:(n=t,"color"===n?"tox-swatches":"tox-menu"),tieredMenu:"tox-tiered-menu"};var n},Ih=function(t){var n=Fh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Pp(t)}},Vh=[zg.parts().items({})],Rh=function(t,n,e){var o=Fh(e);return{dom:{tag:"div",classes:xt([[o.tieredMenu]])},markers:Ih(e)}},Hh=function(t,n){var e=Ih(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},Nh=function(e,o){return function(t){var n=ct(t,o);return st(n,function(t){return{dom:e,components:t}})}},Ph=function(n,i,t){return void 0===t&&(t=!0),{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[zg.parts().items({preprocess:function(t){return"auto"!==n&&1<n?Nh({tag:"div",classes:["tox-collection__group"]},n)(t):(e=function(t,n){return"separator"===i[n].type},o=[],r=[],ft(t,function(t,n){e(t,n)?(0<r.length&&o.push(r),r=[],zt(t.dom,"innerHtml")&&r.push(t)):r.push(t)}),0<r.length&&o.push(r),st(o,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}));var e,o,r}})]}};(ph=gh||(gh={}))[ph.ContentFocus=0]="ContentFocus",ph[ph.UiFocus=1]="UiFocus";var zh,Lh,jh=function(t){return x.console.error(zr(t)),x.console.log(t),tt.none()},Uh=function(t){return t.icon!==undefined||"togglemenuitem"===t.type||"choicemenuitem"===t.type},Wh=function(t){return at(t,Uh)},Gh=function(t,n,e,o){switch(void 0===o&&(o=!0),t.type){case"menuitem":return(c=t,Hr("menuitem",dp,c)).fold(jh,function(t){return tt.some(Ah(t,n,e,o))});case"nestedmenuitem":return(a=t,Hr("nestedmenuitem",mp,a)).fold(jh,function(t){return tt.some(Dh(t,n,e,o))});case"togglemenuitem":return(u=t,Hr("togglemenuitem",gp,u)).fold(jh,function(t){return tt.some(_h(t,n,e))});case"separator":return(i=t,Hr("separatormenuitem",hp,i)).fold(jh,function(t){return tt.some(Bh(t))});case"fancymenuitem":return(r=t,Hr("fancymenuitem",vp,r)).fold(jh,function(t){return Mh(t)});default:return x.console.error("Unknown item in general menu",t),tt.none()}var r,i,u,a,c},Xh=function(t,n,e,o,r){var i,u,a,c,s,f,l;return"color"===r?{value:t,dom:(i=o,l={dom:{tag:"div",classes:["tox-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[zg.parts().items({preprocess:"auto"!==i?Nh({tag:"div",classes:["tox-swatches__row"]},i):U})]}]}).dom,components:l.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(l=Ph(o,e)).dom,components:l.components,items:e}:"normal"===r&&1===o?{value:t,dom:(l=Ph(1,e)).dom,components:l.components,items:e}:"normal"===r?{value:t,dom:(l=Ph(o,e)).dom,components:l.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:(a=n,c=o,s=r,f=Fh(s),{tag:"div",classes:xt([[f.menu,"tox-menu-"+c+"-column"],a?[f.hasIcons]:[]])}),components:Vh,items:e}:{value:t,dom:(u=o,l={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[zg.parts().items({preprocess:Nh({tag:"div",classes:["tox-collection__group"]},u)})]}).dom,components:l.components,items:e}},Yh=function(t,e,o,r,i,u,a){return cn(st(t,function(n){return"choiceitem"===n.type?(t=n,Hr("choicemenuitem",pp,t)).fold(jh,function(t){return tt.some(Th(t,1===o,r,e,u(n.value),i,a))}):tt.none();var t}))},qh=function(t,e,n,o,r){var i=1===n,u=!i||Wh(t);return cn(st(t,function(t){return(n=t,Hr("Autocompleter.Item",cp,n)).fold(jh,function(t){return tt.some(Eh(t,i,"normal",e,o,r,u))});var n}))},Kh=function(t,n,e,o,r,i,u,a){var c=Wh(n),s=Yh(n,e,o,"color"!==r?"normal":"color",i,u,a);return Xh(t,c,s,o,r)},Jh=function(t,n,e,o){var r=Wh(n),i=cn(st(n,function(t){var n=function(t){return Gh(t,e,o,r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n($t(t,{disabled:!0})):n(t)}));return Xh(t,r,i,1,"normal")},$h=function(t){return Gg.singleData(t.value,t)},Qh=function(g,p){var h=ua(Xg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],lazySink:p.getSink})),t=function(){return Xg.isOpen(h)},v=function(){t()&&Xg.hide(h)},n=Dn(function(){return fp(g)}),e=np(function(t){(" "===t.key?tt.none():ap(g,n)).fold(v,function(m){m.lookupData.then(function(t){var e,n,o,r,i,u,a,c,s,f,l=(e=m.triggerChar,o=sn(n=t,function(t){return tt.from(t.columns)}).getOr(1),wt(n,function(i){var t=i.items;return qh(t,function(o,r){var t=g.selection.getRng(),n=t.startContainer;op(t,e,n.data,t.startOffset).fold(function(){return x.console.error("Lost context. Cursor probably moved")},function(t){var n=t.rng,e={hide:v};i.onAction(e,n,o,r)})},o,hh.BUBBLE_TO_SANDBOX,p)}));if(0<l.length){var d=sn(t,function(t){return tt.from(t.columns)}).getOr(1);Xg.showAt(h,{anchor:"selection",root:Be.fromDom(g.getBody()),getSelection:function(){return tt.some({start:function(){return Be.fromDom(m.range.startContainer)},soffset:function(){return m.range.startOffset},finish:function(){return Be.fromDom(m.range.endContainer)},foffset:function(){return m.range.endOffset}})}},zg.sketch((r=Xh("autocompleter-value",!0,l,d,"normal"),i=d,a="normal",c=(u=gh.ContentFocus)===gh.ContentFocus?ld():fd(),s=Hh(i,a),f=Ih(a),{dom:r.dom,components:r.components,items:r.items,value:r.value,markers:{selectedItem:f.selectedItem,item:f.item},movement:s,fakeFocus:u===gh.ContentFocus,focusManager:c,menuBehaviours:xp("auto"!==i?[]:[Yi(function(o){bp(o,4,f.item).each(function(t){var n=t.numColumns,e=t.numRows;Um.setGridSize(o,e,n)})})])}))),Xg.getContent(h).each(ql.highlightFirst)}else v()})})},50);rp({onKeypress:e,closeIfNecessary:v,isActive:t,getView:function(){return Xg.getContent(h)}},g)},Zh=function(m,g){return function(t){if(m(t)){var n,e,o,r,i,u,a,c=Be.fromDom(t.target),s=function(){t.stopPropagation()},f=function(){t.preventDefault()},l=H(f,s),d=(n=c,e=t.clientX,o=t.clientY,r=s,i=f,u=l,a=t,{target:Z(n),x:Z(e),y:Z(o),stop:r,prevent:i,kill:u,raw:Z(a)});g(d)}}},tv=function(t,n,e,o,r){var i=Zh(e,o);return t.dom().addEventListener(n,i,r),{unbind:v(nv,t,n,i,r)}},nv=function(t,n,e,o){t.dom().removeEventListener(n,e,o)},ev=Z(!0),ov=function(t,n,e){return tv(t,n,ev,e,!1)},rv=function(t,n,e){return tv(t,n,ev,e,!0)},iv=function(t,n,e){return la(t,n,e).isSome()},uv=function(t){var n=t.raw();return n.touches===undefined||1!==n.touches.length?tt.none():tt.some(n.touches[0])},av=function(e){var u=an(tt.none()),o=s(function(t){u.set(tt.none()),e.triggerEvent(de(),t)},400),r=on([{key:mn(),value:function(e){return uv(e).each(function(t){o.cancel();var n={x:Z(t.clientX),y:Z(t.clientY),target:e.target};o.schedule(e),u.set(tt.some(n))}),tt.none()}},{key:gn(),value:function(t){return o.cancel(),uv(t).each(function(i){u.get().each(function(t){var n,e,o,r;n=i,e=t,o=Math.abs(n.clientX-e.x()),r=Math.abs(n.clientY-e.y()),(5<o||5<r)&&u.set(tt.none())})}),tt.none()}},{key:pn(),value:function(n){return o.cancel(),u.get().filter(function(t){return Ye(t.target(),n.target())}).map(function(){return e.triggerEvent(fe(),n)})}}]);return{fireIfReady:function(n,t){return nn(r,t).bind(function(t){return t(n)})}}},cv=ee.detect().browser.isFirefox(),sv=wr([Zr("triggerEvent"),si("stopBackspace",!0)]),fv=function(n,t){var e,o,r,i,u=Pr("Getting GUI events settings",sv,t),a=ee.detect().deviceType.isTouch()?["touchstart","touchmove","touchend","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],c=av(u),s=st(a.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(t){return ov(n,t,function(n){c.fireIfReady(n,t).each(function(t){t&&n.kill()}),u.triggerEvent(t,n)&&n.kill()})}),f=an(tt.none()),l=ov(n,"paste",function(n){c.fireIfReady(n,"paste").each(function(t){t&&n.kill()}),u.triggerEvent("paste",n)&&n.kill(),f.set(tt.some(x.setTimeout(function(){u.triggerEvent(ue(),n)},0)))}),d=ov(n,"keydown",function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||8!==(n=t).raw().which||ut(["input","textarea"],so(n.target()))||iv(n.target(),'[contenteditable="true"]')||t.prevent()}),m=(e=n,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},cv?rv(e,"focus",o):ov(e,"focusin",o)),g=an(tt.none()),p=(r=n,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),g.set(tt.some(x.setTimeout(function(){u.triggerEvent(ie(),t)},0)))},cv?rv(r,"blur",i):ov(r,"focusout",i));return{unbind:function(){ft(s,function(t){t.unbind()}),d.unbind(),m.unbind(),p.unbind(),l.unbind(),f.get().each(x.clearTimeout),g.get().each(x.clearTimeout)}}},lv=function(t,n){var e=nn(t,"target").map(function(t){return t()}).getOr(n);return an(e)},dv=Yt([{stopped:[]},{resume:["element"]},{complete:[]}]),mv=function(t,o,n,e,r,i){var u,a,c,s,f=t(o,e),l=(u=n,a=r,c=an(!1),s=an(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:Z(u),setSource:a.set,getSource:a.get});return f.fold(function(){return i.logEventNoHandlers(o,e),dv.complete()},function(n){var e=n.descHandler();return xu(e)(l),l.isStopped()?(i.logEventStopped(o,n.element(),e.purpose()),dv.stopped()):l.isCut()?(i.logEventCut(o,n.element(),e.purpose()),dv.complete()):Je(n.element()).fold(function(){return i.logNoParent(o,n.element(),e.purpose()),dv.complete()},function(t){return i.logEventResponse(o,n.element(),e.purpose()),dv.resume(t)})})},gv=function(n,e,o,t,r,i){return mv(n,e,o,t,r,i).fold(function(){return!0},function(t){return gv(n,e,o,t,r,i)},function(){return!1})},pv=function(t,n){var e,o,r=(e=n,o=an(!1),{stop:function(){o.set(!0)},cut:Q,isStopped:o.get,isCut:Z(!1),event:Z(e),setSource:P("Cannot set source of a broadcasted event"),getSource:P("Cannot get source of a broadcasted event")});return ft(t,function(t){var n=t.descHandler();xu(n)(r)}),r.isStopped()},hv=function(t,n,e,o,r){var i=lv(e,o);return gv(t,n,e,o,i,r)},vv=Ae("element","descHandler"),bv=function(t,n){return{id:Z(t),descHandler:Z(n)}},yv=Dl({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=h(n,["attributes"]);return{uid:t.uid,dom:Ho({tag:"div",attributes:Ho({role:"presentation"},e)},o),components:t.components,behaviours:Af(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[si("components",[]),Bf("containerBehaviours",[]),si("events",{}),si("domModification",{}),si("eventOrder",{})]}),xv=function(e){var o=function(n){return Je(e.element()).fold(function(){return!0},function(t){return Ye(n,t)})},r=b(),s=function(t,n){return r.find(o,t,n)},t=fv(e.element(),{triggerEvent:function(u,a){return Do(u,a.target(),function(t){return n=s,e=u,r=t,i=(o=a).target(),hv(n,e,o,i,r);var n,e,o,r,i})}}),i={debugInfo:Z("real"),triggerEvent:function(n,e,o){Do(n,e,function(t){hv(s,n,o,e,t)})},triggerFocus:function(a,c){ru(a).fold(function(){ud(a)},function(){Do(re(),a,function(t){var n,e,o,r,i,u;n=s,e=re(),o={originator:Z(c),kill:Q,prevent:Q,target:Z(a)},i=t,u=lv(o,r=a),mv(n,e,o,r,u,i)})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element(),n.event())},getByUid:function(t){return g(t)},getByDom:function(t){return p(t)},build:ua,addToGui:function(t){a(t)},removeFromGui:function(t){c(t)},addToWorld:function(t){n(t)},removeFromWorld:function(t){u(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:Z(!0)},n=function(t){t.connect(i),go(t.element())||(r.register(t),ft(t.components(),n),i.triggerEvent(pe(),t.element(),{target:Z(t.element())}))},u=function(t){go(t.element())||(ft(t.components(),u),r.unregister(t)),t.disconnect()},a=function(t){of(e,t)},c=function(t){sf(t)},f=function(e){var t=r.filter(ae());ft(t,function(t){var n=t.descHandler();xu(n)(e)})},l=function(t){f({universal:Z(!0),data:Z(t)})},d=function(t,n){f({universal:Z(!1),channels:Z(t),data:Z(n)})},m=function(t,n){var e=r.filter(t);return pv(e,n)},g=function(t){return r.getById(t).fold(function(){return Xt.error(new Error('Could not find component with uid: "'+t+'" in system.'))},Xt.value)},p=function(t){var n=ru(t).getOr("not found");return g(n)};return n(e),{root:Z(e),element:e.element,destroy:function(){t.unbind(),uo(e.element())},add:a,remove:c,getByUid:g,getByDom:p,addToWorld:n,removeFromWorld:u,broadcast:l,broadcastOn:d,broadcastEvent:m}},wv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Sv=tinymce.util.Tools.resolve("tinymce.EditorManager"),kv=function(t){return tt.from(t.settings.min_width).filter(ot)},Cv=function(t){return tt.from(t.settings.min_height).filter(ot)},Ov=function(n){var t=_t(n.settings),e=mt(t,function(t){return/^toolbar([1-9])$/.test(t)}),o=st(e,function(t){return n.getParam(t,!1,"string")}),r=mt(o,function(t){return"string"==typeof t});return 0<r.length?tt.some(r):tt.none()};(Lh=zh||(zh={}))["default"]="",Lh.floating="floating",Lh.sliding="sliding";var Tv,Ev,Bv=function(t){return t.getParam("toolbar_drawer","","string")},Av=function(t){var n=t.getParam("fixed_toolbar_container","","string"),e=t.getParam("inline",!1,"boolean");return 0<n.length&&e?fa(Bi(),n):tt.none()},Dv=function(t){return t.getParam("inline",!1,"boolean")&&Av(t).isSome()},_v=Vo("form-component-change"),Mv=Vo("form-close"),Fv=Vo("form-cancel"),Iv=Vo("form-action"),Vv=Vo("form-submit"),Rv=Vo("form-block"),Hv=Vo("form-unblock"),Nv=Vo("form-tabchange"),Pv=Vo("form-resize"),zv=Z([si("prefix","form-field"),Bf("fieldBehaviours",[Vl,ag])]),Lv=Z([rl({schema:[Kr("dom")],name:"label"}),rl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Kr("text")],name:"aria-descriptor"}),el({factory:{sketch:function(t){var n=Qt(t,["factory"]);return t.factory.sketch(n)}},schema:[Kr("factory")],name:"field"})]),jv=_l({name:"FormField",configFields:zv(),partFields:Lv(),factory:function(r,t){var n=Df(r.fieldBehaviours,[Vl.config({find:function(t){return hl(t,r,"field")}}),ag.config({store:{mode:"manual",getValue:function(t){return Vl.getCurrent(t).bind(ag.getValue)},setValue:function(t,n){Vl.getCurrent(t).each(function(t){ag.setValue(t,n)})}}})]),e=Ii([Yi(function(t){var o=bl(t,r,["label","field","aria-descriptor"]);o.field().each(function(e){var n=Vo(r.prefix);o.label().each(function(t){vo(t.element(),"for",n),vo(e.element(),"id",n)}),o["aria-descriptor"]().each(function(t){var n=Vo(r.prefix);vo(t.element(),"id",n),vo(e.element(),"aria-describedby",n)})})})]),o={getField:function(t){return hl(t,r,"field")},getLabel:function(t){return hl(t,r,"label")}};return{uid:r.uid,dom:r.dom,components:t,behaviours:n,events:e,apis:o}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Uv=Object.freeze({getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Wv=[Jr("others",Vr(Xt.value,jr()))],Gv=Va({fields:Wv,name:"coupling",apis:Uv,state:Object.freeze({init:function(){var i={},t=Z({});return hu({readState:t,getOrCreate:function(e,o,r){var t=_t(o.others);if(t)return nn(i,r).getOrThunk(function(){var t=nn(o.others,r).getOrDie("No information found for coupled component: "+r)(e),n=e.getSystem().build(t);return i[r]=n});throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+mr(t,null,2))}})}})}),Xv=Object.freeze({events:function(t,n){var e=t.stream.streams.setup(t,n);return Ii([Ni(t.event,e),qi(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[Ni(t,function(){return n.cancel()})]}).getOr([])))}}),Yv=function(){var n=an(null);return hu({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},qv=Object.freeze({throttle:Yv,init:function(t){return t.stream.streams.state(t)}}),Kv=[Jr("stream",Lr("mode",{throttle:[Kr("delay"),si("stopEvent",!0),Oa("streams",{setup:function(t,n){var e=t.stream,o=np(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:Yv})]})),si("event","input"),oi("cancelEvent"),ka("onStream")],Jv=Va({fields:Kv,name:"streaming",active:Xv,state:qv}),$v=function(t){var e=tt.none(),n=[],o=function(t){r()?u(t):n.push(t)},r=function(){return e.isSome()},i=function(t){ft(t,u)},u=function(n){e.each(function(t){x.setTimeout(function(){n(t)},0)})};return t(function(t){e=tt.some(t),i(n),n=[]}),{get:o,map:function(e){return $v(function(n){o(function(t){n(e(t))})})},isReady:r}},Qv={nu:$v,pure:function(n){return $v(function(t){t(n)})}},Zv=function(n){var r=function(t){var o;n((o=t,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=this;x.setTimeout(function(){o.apply(e,t)},0)}))},e=function(){return Qv.nu(r)};return{map:function(o){return Zv(function(e){r(function(t){var n=o(t);e(n)})})},bind:function(e){return Zv(function(n){r(function(t){e(t).get(n)})})},anonBind:function(n){return Zv(function(t){r(function(){n.get(t)})})},toLazy:e,toCached:function(){var n=null;return Zv(function(t){null===n&&(n=e()),n.get(t)})},get:r}},tb={nu:Zv,pure:function(n){return Zv(function(t){t(n)})}},nb=Z("sink"),eb=Z(rl({name:nb(),overrides:Z({dom:{tag:"div"},behaviours:Fa([tf.config({useFixed:!0})]),events:Ii([Wi(kn()),Wi(hn()),Wi(En())])})}));(Ev=Tv||(Tv={}))[Ev.HighlightFirst=0]="HighlightFirst",Ev[Ev.HighlightNone=1]="HighlightNone";var ob,rb,ib,ub=function(t,n){var e=t.getHotspot(n).getOr(n);return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e}},function(t){return{anchor:"hotspot",hotspot:e,layouts:t}})},ab=function(t,n,e,o,r,i,u){var a,c,s,f,l,d,m,g,p,h,v=ub(t,e);return(c=v,f=o,l=r,d=u,m=n,g=s=e,p=(0,(a=t).fetch)(g).map(m),h=lb(s,a),p.map(function(t){return t.bind(function(t){return tt.from(Gg.sketch(Ho({},l.menu(),{uid:iu(""),data:t,highlightImmediately:d===Tv.HighlightFirst,onOpenMenu:function(t,n){var e=h().getOrDie();tf.position(e,c,n),Sf.decloak(f)},onOpenSubmenu:function(t,n,e){var o=h().getOrDie();tf.position(o,{anchor:"submenu",item:n},e),Sf.decloak(f)},onEscape:function(){return dg.focus(s),Sf.close(f),tt.some(!0)}})))})})).map(function(t){return t.fold(function(){Sf.isOpen(o)&&Sf.close(o)},function(t){Sf.cloak(o),Sf.open(o,t),i(o)}),o})},cb=function(t,n,e,o){return Sf.close(o),tb.pure(o)},sb=function(t,n,e,o,r,i){var u=Gv.getCoupled(e,"sandbox");return(Sf.isOpen(u)?cb:ab)(t,n,e,u,o,r,i)},fb=function(t,n,e){var o,r,i=Vl.getCurrent(n).getOr(n),u=Ja(t.element());e?zu(i.element(),"min-width",u+"px"):(o=i.element(),r=u,Ka.set(o,r))},lb=function(n,t){return n.getSystem().getByUid(t.uid+"-"+nb()).map(function(t){return function(){return Xt.value(t)}}).getOrThunk(function(){return t.lazySink.fold(function(){return function(){return Xt.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(t){return function(){return t(n)}})})},db=function(o,r,i){var n,u=(n=Vo("aria-owns"),{id:Z(n),link:function(t){vo(t,"aria-owns",n)},unlink:function(t){wo(t,"aria-owns")}}),t=lb(r,o);return{dom:{tag:"div",classes:o.sandboxClasses,attributes:{id:u.id()}},behaviours:_f.augment(o.sandboxBehaviours,[ag.config({store:{mode:"memory",initialValue:r}}),Sf.config({onOpen:function(t,n){var e=ub(o,r);u.link(r.element()),o.matchWidth&&fb(e.hotspot,n,o.useMinWidth),o.onOpen(e,t,n),i!==undefined&&i.onOpen!==undefined&&i.onOpen(t,n)},onClose:function(t,n){u.unlink(r.element()),i!==undefined&&i.onClose!==undefined&&i.onClose(t,n)},isPartOf:function(t,n,e){return ma(n,e)||ma(r,e)},getAttachPoint:function(){return t().getOrDie()}}),Vl.config({find:function(t){return Sf.getState(t).bind(function(t){return Vl.getCurrent(t)})}}),Tf({isExtraPart:Z(!1)})])}},mb=function(t,n,e){var o=ag.getValue(e);ag.setValue(n,o),pb(n)},gb=function(t,n){var e=t.element(),o=Ku(e),r=e.dom();"number"!==yo(e,"type")&&n(r,o)},pb=function(t){gb(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},hb=function(t,n,o){if(t.selectsOver){var e=ag.getValue(n),r=t.getDisplayText(e),i=ag.getValue(o);return 0===t.getDisplayText(i).indexOf(r)?tt.some(function(){var t,e;mb(0,n,o),t=n,e=r.length,gb(t,function(t,n){return t.setSelectionRange(e,n.length)})}):tt.none()}return tt.none()},vb=Z([oi("data"),si("inputAttributes",{}),si("inputStyles",{}),si("tag","input"),si("inputClasses",[]),wa("onSetValue"),si("styles",{}),si("eventOrder",{}),Bf("inputBehaviours",[ag,dg]),si("selectOnFocus",!0)]),bb=function(t){return Fa([dg.config({onFocus:!1===t.selectOnFocus?Q:function(t){var n=t.element(),e=Ku(n);n.dom().setSelectionRange(0,e.length)}})])},yb=function(t){return{tag:t.tag,attributes:Ho({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},xb=Z("alloy.typeahead.itemexecute"),wb=function(){return[si("sandboxClasses",[]),_f.field("sandboxBehaviours",[Vl,La,Sf,ag])]},Sb=Z([oi("lazySink"),Kr("fetch"),si("minChars",5),si("responseTime",1e3),wa("onOpen"),si("getHotspot",tt.some),si("layouts",tt.none()),si("eventOrder",{}),hi("model",{},[si("getDisplayText",function(t){return t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.value}),si("selectsOver",!0),si("populateFromBrowse",!0)]),wa("onSetValue"),Sa("onExecute"),wa("onItemExecute"),si("inputClasses",[]),si("inputAttributes",{}),si("inputStyles",{}),si("matchWidth",!0),si("useMinWidth",!1),si("dismissOnBlur",!0),ya(["openClass"]),oi("initialData"),Bf("typeaheadBehaviours",[dg,ag,Jv,Um,Cg,Gv]),vi("previewing",function(){return an(!0)})].concat(vb()).concat(wb())),kb=Z([ol({schema:[ba()],name:"menu",overrides:function(o){return{fakeFocus:!0,onHighlight:function(n,e){o.previewing.get()?n.getSystem().getByUid(o.uid).each(function(t){hb(o.model,t,e).fold(function(){return ql.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&mb(o.model,t,e)}),o.previewing.set(!1)},onExecute:function(t,n){return t.getSystem().getByUid(o.uid).toOption().map(function(t){return Si(t,xb(),{item:n}),!0})},onHover:function(t,n){o.previewing.set(!1),t.getSystem().getByUid(o.uid).each(function(t){o.model.populateFromBrowse&&mb(o.model,t,n)})}}}})]),Cb=_l({name:"Typeahead",configFields:Sb(),partFields:kb(),factory:function(r,t,n,i){var e=function(t,n,e){r.previewing.set(!1);var o=Gv.getCoupled(t,"sandbox");Sf.isOpen(o)?Vl.getCurrent(o).each(function(t){ql.getHighlighted(t).fold(function(){e(t)},function(){Ti(o,t.element(),"keydown",n)})}):ab(r,u(t),t,o,i,function(t){Vl.getCurrent(t).each(e)},Tv.HighlightFirst).get(Q)},o=bb(r),u=function(o){return function(t){return t.map(function(t){var n=Nt(t.menus),e=wt(n,function(t){return mt(t.items,function(t){return"item"===t.type})});return ag.getState(o).update(st(e,function(t){return t.data})),t})}},a=[dg.config({}),ag.config({onSetValue:r.onSetValue,store:Ho({mode:"dataset",getDataKey:function(t){return Ku(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,n){Ju(t.element(),r.model.getDisplayText(n))}},r.initialData.map(function(t){return en("initialValue",t)}).getOr({}))}),Jv.config({stream:{mode:"throttle",delay:r.responseTime,stopEvent:!1},onStream:function(t){var n=Gv.getCoupled(t,"sandbox");if(dg.isFocused(t)&&Ku(t.element()).length>=r.minChars){var e=Vl.getCurrent(n).bind(function(t){return ql.getHighlighted(t).map(ag.getValue)});r.previewing.set(!0),ab(r,u(t),t,n,i,function(){Vl.getCurrent(n).each(function(t){e.fold(function(){r.model.selectsOver&&ql.highlightFirst(t)},function(n){ql.highlightBy(t,function(t){return ag.getValue(t).value===n.value}),ql.getHighlighted(t).orThunk(function(){return ql.highlightFirst(t),tt.none()})})})},Tv.HighlightFirst).get(Q)}},cancelEvent:ge()}),Um.config({mode:"special",onDown:function(t,n){return e(t,n,ql.highlightFirst),tt.some(!0)},onEscape:function(t){var n=Gv.getCoupled(t,"sandbox");return Sf.isOpen(n)?(Sf.close(n),tt.some(!0)):tt.none()},onUp:function(t,n){return e(t,n,ql.highlightLast),tt.some(!0)},onEnter:function(n){var t=Gv.getCoupled(n,"sandbox"),e=Sf.isOpen(t);if(e&&!r.previewing.get())return Vl.getCurrent(t).bind(function(t){return ql.getHighlighted(t)}).map(function(t){return Si(n,xb(),{item:t}),!0});var o=ag.getValue(n);return wi(n,ge()),r.onExecute(t,n,o),e&&Sf.close(t),tt.some(!0)}}),Cg.config({toggleClass:r.markers.openClass,aria:{mode:"pressed",syncWithExpanded:!0}}),Gv.config({others:{sandbox:function(t){return db(r,t,{onOpen:U,onClose:U})}}}),_g("typeaheadevents",[Ji(function(t){var n=Q;sb(r,u(t),t,i,n,Tv.HighlightFirst).get(Q)}),Ni(xb(),function(t,n){var e=Gv.getCoupled(t,"sandbox");mb(r.model,t,n.event().item()),wi(t,ge()),r.onItemExecute(t,e,n.event().item(),ag.getValue(t)),Sf.close(e),pb(t)})].concat(r.dismissOnBlur?[Ni(ie(),function(t){var n=Gv.getCoupled(t,"sandbox");cd(n.element()).isNone()&&Sf.close(n)})]:[]))];return{uid:r.uid,dom:yb(r),behaviours:Ho({},o,Df(r.typeaheadBehaviours,a)),eventOrder:r.eventOrder}}}),Ob=function(t,n,e){var o=Eb(t,n,e);return jv.sketch(o)},Tb=function(t,n){return Ob(t,n,[])},Eb=function(t,n,e){return{dom:Bb(e),components:t.toArray().concat([n])}},Bb=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},Ab=function(t,n){return jv.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Db=function(t){return"separator"===t.type},_b={type:"separator"},Mb=function(t,e){var n=pt(t,function(t,n){return K(n)?""===n?t:"|"===n?0<t.length&&!Db(t[t.length-1])?t.concat([_b]):t:zt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])},[]);return 0<n.length&&Db(n[n.length-1])&&n.pop(),n},Fb=function(t,n){return zt(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=Ib(r,o),{item:e,menus:Jt(i.menus,en(e.value,i.items)),expansions:Jt(i.expansions,en(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i},Ib=function(t,r){var n=Mb(K(t)?t.split(" "):t,r);return gt(n,function(t,n){var e=function(t){if(Db(t))return t;var n=nn(t,"value").getOrThunk(function(){return Vo("generated-menu-item")});return Jt({value:n},t)}(n),o=Fb(e,r);return{menus:Jt(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Jt(t.expansions,o.expansions)}},{menus:{},expansions:{},items:[]})},Vb=function(t,e,o){var n=Vo("primary-menu"),r=Ib(t,o.menuItems());if(0===r.items.length)return tt.none();var i=Jh(n,r.items,e,o),u=It(r.menus,function(t,n){return Jh(n,t,e,o)}),a=Jt(u,en(n,i));return tt.from(Gg.tieredData(n,a,r.expansions))},Rb=Dl({name:"Input",configFields:vb(),factory:function(t){return{uid:t.uid,dom:yb(t),components:[],behaviours:(n=t,Ho({},bb(n),Df(n.inputBehaviours,[ag.config({store:{mode:"manual",initialValue:n.data.getOr(undefined),getValue:function(t){return Ku(t.element())},setValue:function(t,n){Ku(t.element())!==n&&Ju(t.element(),n)}},onSetValue:n.onSetValue})]))),eventOrder:t.eventOrder};var n}}),Hb=ee.detect().browser.isFirefox(),Nb={position:"absolute",left:"-9999px"},Pb=function(t,n,e){var o,r,i,u=function(t,n){var e=Be.fromTag("span",t.dom());vo(e,"role","presentation");var o=Be.fromText(n,t.dom());return oo(e,o),e}(qe(n),e);Hb&&(o=n,r=u,i=Vo("ephox-alloy-aria-voice"),vo(r,"id",i),vo(o,"aria-describedby",i)),bo(u,t(e)),Lu(u,Nb),oo(n,u),x.setTimeout(function(){wo(u,"aria-live"),uo(u)},1e3)},zb=function(){return{"aria-live":"assertive","aria-atomic":"true",role:"alert"}},Lb=["input","textarea"],jb=function(t){var n=so(t);return ut(Lb,n)},Ub=function(t,n){var e=n.getRoot(t).getOr(t.element());Fu(e,n.invalidClass),n.notify.each(function(n){jb(t.element())&&wo(e,"title"),n.getContainer(t).each(function(t){co(t,n.validHtml)}),n.onValid(t)})},Wb=function(e,t,n,o){var r=t.getRoot(e).getOr(e.element());Mu(r,t.invalidClass),t.notify.each(function(t){var n;jb(e.element())&&vo(e.element(),"title",o),n=Bi(),Pb(zb,n,o),t.getContainer(e).each(function(t){co(t,o)}),t.onInvalid(e,o)})},Gb=function(n,t){return t.validator.fold(function(){return tb.pure(Xt.value(!0))},function(t){return t.validate(n)})},Xb=function(n,e){return e.notify.each(function(t){t.onValidate(n)}),Gb(n,e).map(function(t){return n.getSystem().isConnected()?t.fold(function(t){return Wb(n,e,0,t),Xt.error(t)},function(t){return Ub(n,e),Xt.value(t)}):Xt.error("No longer in system")})},Yb=Object.freeze({markValid:Ub,markInvalid:Wb,query:Gb,run:Xb,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element());return Iu(e,n.invalidClass)}}),qb=Object.freeze({events:function(n){return n.validator.map(function(t){return Ii([Ni(t.onEvent,function(t){Xb(t,n).get(U)})].concat(t.validateOnLoad?[Yi(function(t){Xb(t,n).get(Q)})]:[]))}).getOr({})}}),Kb=[Kr("invalidClass"),si("getRoot",tt.none),ci("notify",[si("aria","alert"),si("getContainer",tt.none),si("validHtml",""),wa("onValid"),wa("onInvalid"),wa("onValidate")]),ci("validator",[Kr("validate"),si("onEvent","input"),si("validateOnLoad",!0)])],Jb=Va({fields:Kb,name:"invalidating",active:qb,apis:Yb,extra:{validation:function(e){return function(t){var n=ag.getValue(t);return tb.pure(e(n))}}}}),$b=Object.freeze({exhibit:function(t,n){return bu({attributes:on([{key:n.tabAttr,value:"true"}])})}}),Qb=[si("tabAttr","data-alloy-tabstop")],Zb=Va({fields:Qb,name:"tabstopping",active:$b}),ty=function(t){return{value:Z(t)}},ny=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,
ey=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,oy=function(t){return ny.test(t)||ey.test(t)},ry=function(t){var n,e=(n=t.value().replace(ny,function(t,n,e,o){return n+n+e+e+o+o}),{value:Z(n)}),o=ey.exec(e.value());return null===o?["FFFFFF","FF","FF","FF"]:o},iy=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},uy=function(t){var n=iy(t.red())+iy(t.green())+iy(t.blue());return ty(n)},ay=Math.min,cy=Math.max,sy=Math.round,fy=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,ly=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,dy=function(t,n,e,o){return{red:Z(t),green:Z(n),blue:Z(e),alpha:Z(o)}},my=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},gy=function(t){var n,e,o,r=(t.hue()||0)%360,i=t.saturation()/100,u=t.value()/100;if(i=cy(0,ay(i,1)),u=cy(0,ay(u,1)),0===i)return n=e=o=sy(255*u),dy(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=sy(255*(n+f)),e=sy(255*(e+f)),o=sy(255*(o+f)),dy(n,e,o,1)},py=function(t){var n=ry(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return dy(e,o,r,1)},hy=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return dy(r,i,u,a)},vy=function(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"},by=Z(dy(255,0,0,1)),yy=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),xy="tinymce-custom-colors",wy="choiceitem",Sy=[{type:wy,text:"Turquoise",value:"#18BC9B"},{type:wy,text:"Green",value:"#2FCC71"},{type:wy,text:"Blue",value:"#3598DB"},{type:wy,text:"Purple",value:"#9B59B6"},{type:wy,text:"Navy Blue",value:"#34495E"},{type:wy,text:"Dark Turquoise",value:"#18A085"},{type:wy,text:"Dark Green",value:"#27AE60"},{type:wy,text:"Medium Blue",value:"#2880B9"},{type:wy,text:"Medium Purple",value:"#8E44AD"},{type:wy,text:"Midnight Blue",value:"#2B3E50"},{type:wy,text:"Yellow",value:"#F1C40F"},{type:wy,text:"Orange",value:"#E67E23"},{type:wy,text:"Red",value:"#E74C3C"},{type:wy,text:"Light Gray",value:"#ECF0F1"},{type:wy,text:"Gray",value:"#95A5A6"},{type:wy,text:"Dark Yellow",value:"#F29D12"},{type:wy,text:"Dark Orange",value:"#D35400"},{type:wy,text:"Dark Red",value:"#E74C3C"},{type:wy,text:"Medium Gray",value:"#BDC3C7"},{type:wy,text:"Dark Gray",value:"#7E8C8D"},{type:wy,text:"Black",value:"#000000"},{type:wy,text:"White",value:"#ffffff"}],ky=function QD(n){void 0===n&&(n=10);var t,e=yy.getItem(xy),o=K(e)?JSON.parse(e):[],r=n-(t=o).length<0?t.slice(0,n):t,i=function(t){r.splice(t,1)};return{add:function(t){it(r,t).each(i),r.unshift(t),r.length>n&&r.pop(),yy.setItem(xy,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Cy=function(t){var n,e=[];for(n=0;n<t.length;n+=2)e.push({text:t[n+1],value:"#"+t[n],type:"choiceitem"});return e},Oy=function(t){return t.getParam("color_map")},Ty=function(t,n){return t.getParam("color_cols",n,"number")},Ey=function(t){return!1!==t.getParam("custom_colors")},By=function(t){var n=Oy(t);return n!==undefined?Cy(n):Sy},Ay=function(){return st(ky.state(),function(t){return{type:wy,text:t,value:t}})},Dy=function(t){ky.add(t)},_y=function(t,e){var o;return t.dom.getParents(t.selection.getStart(),function(t){var n;(n=t.style["forecolor"===e?"color":"background-color"])&&(o=o||n)}),o},My=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},Fy=function(t){var n=By(t),e=My(n.length);return Ty(t,e)},Iy=function(n,e,t,o){"custom"===t?Ny(n)(function(t){t.each(function(t){Dy(t),n.execCommand("mceApplyTextcolor",e,t),o(t)})},"#000000"):"remove"===t?(o(""),n.execCommand("mceRemoveTextcolor",e)):(o(t),n.execCommand("mceApplyTextcolor",e,t))},Vy=function(o,r){return function(t){var n,e;t(o.concat(Ay().concat((e={type:n="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},r?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]))))}},Ry=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},Hy=function(o,e,r,t,i){o.ui.registry.addSplitButton(e,{tooltip:t,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(e){return tt.from(_y(o,r)).bind(function(t){return function(t){if("transparent"===t)return tt.some(dy(0,0,0,0));var n=fy.exec(t);if(null!==n)return tt.some(hy(n[1],n[2],n[3],"1"));var e=ly.exec(t);return null!==e?tt.some(hy(e[1],e[2],e[3],e[4])):tt.none()}(t).map(function(t){var n=uy(t).value();return Kn(e.toLowerCase(),n)})}).getOr(!1)},columns:Fy(o),fetch:Vy(By(o),Ey(o)),onAction:function(){null!==i.get()&&Iy(o,r,i.get(),function(){})},onItemAction:function(n,t){Iy(o,r,t,function(t){i.set(t),Ry(n,e,t)})},onSetup:function(t){return null!==i.get()&&Ry(t,e,i.get()),function(){}}})},Ny=function(i){return function(t,n){var e,o={colorpicker:n},r=(e=t,function(t){var n=t.getData();e(tt.from(n.colorpicker)),t.close()});i.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:r,onClose:function(){},onCancel:function(){t(tt.none())}})}},Py={register:function(t){var i;(i=t).addCommand("mceApplyTextcolor",function(t,n){var e,o,r;o=t,r=n,(e=i).undoManager.transact(function(){e.focus(),e.formatter.apply(o,{value:r}),e.nodeChanged()})}),i.addCommand("mceRemoveTextcolor",function(t){var n,e;e=t,(n=i).undoManager.transact(function(){n.focus(),n.formatter.remove(e,{value:null},null,!0),n.nodeChanged()})});var n=an(null),e=an(null);Hy(t,"forecolor","forecolor","Text color",n),Hy(t,"backcolor","hilitecolor","Background color",e)},getFetch:Vy,colorPickerDialog:Ny,getCurrentColor:_y,getColorCols:Fy,calcCols:My},zy=Z([Kr("dom"),Kr("fetch"),wa("onOpen"),Sa("onExecute"),si("getHotspot",tt.some),si("layouts",tt.none()),Bf("dropdownBehaviours",[Cg,Gv,Um,dg]),Kr("toggleClass"),si("eventOrder",{}),oi("lazySink"),si("matchWidth",!1),si("useMinWidth",!1),oi("role")].concat(wb())),Ly=Z([ol({schema:[ba()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),eb()]),jy=_l({name:"Dropdown",configFields:zy(),partFields:Ly(),factory:function(n,t,e,o){var r,i,u=function(t){Sf.getState(t).each(function(t){Gg.highlightPrimary(t)})},a={expand:function(t){Cg.isOn(t)||sb(n,function(t){return t},t,o,Q,Tv.HighlightNone).get(Q)},open:function(t){Cg.isOn(t)||sb(n,function(t){return t},t,o,Q,Tv.HighlightFirst).get(Q)},isOpen:Cg.isOn,close:function(t){Cg.isOn(t)&&sb(n,function(t){return t},t,o,Q,Tv.HighlightFirst).get(Q)}},c=function(t){return ki(t),tt.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Df(n.dropdownBehaviours,[Cg.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),Gv.config({others:{sandbox:function(t){return db(n,t,{onOpen:function(){Cg.on(t)},onClose:function(){Cg.off(t)}})}}}),Um.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){if(jy.isOpen(t)){var n=Gv.getCoupled(t,"sandbox");u(n)}else jy.open(t);return tt.some(!0)},onEscape:function(t){return jy.isOpen(t)?(jy.close(t),tt.some(!0)):tt.none()}}),dg.config({})]),events:Yg(tt.some(function(t){sb(n,function(t){return t},t,o,u,Tv.HighlightFirst).get(Q)})),eventOrder:Ho({},n.eventOrder,(r={},r[ce()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:a,domModification:{attributes:Ho({"aria-haspopup":"true"},n.role.fold(function(){return{}},function(t){return{role:t}}),"button"===n.dom.tag?{type:(i="type",nn(n.dom,"attributes").bind(function(t){return nn(t,i)})).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)}}}),Uy=Va({fields:[],name:"unselecting",active:Object.freeze({events:function(){return Ii([Vi(An(),Z(!0))])},exhibit:function(){return bu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),Wy=Vo("color-input-change"),Gy=Vo("color-swatch-change"),Xy=Vo("color-picker-cancel"),Yy=function(t,n,o){var e,r,i=jv.parts().field({factory:Rb,inputClasses:["tox-textfield"],onSetValue:function(t){return Jb.run(t).get(function(){})},inputBehaviours:Fa([Zb.config({}),Jb.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Je(t.element())},notify:{onValid:function(t){var n=ag.getValue(t);Si(t,Wy,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=ag.getValue(t);if(0===n.length)return tb.pure(Xt.value(!0));var e=Be.fromTag("span");zu(e,"background-color",n);var o=Gu(e,"background-color").fold(function(){return Xt.error("blah")},function(){return Xt.value(n)});return tb.pure(o)}}})]),selectOnFocus:!1}),u=t.label.map(function(t){return Ab(t,n.providers)}),a=function(t,n){Si(t,Gy,{value:n})},c=Kg((e={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:tt.some({onRtl:function(){return[Xc]},onLtr:function(){return[Yc]}}),components:[],fetch:Py.getFetch(o.getColors(),o.hasCustomColors()),onItemAction:function(e){n.getSink().each(function(t){c.getOpt(t).each(function(n){"custom"===e?o.colorPicker(function(t){t.fold(function(){return wi(n,Xy)},function(t){a(n,t),Dy(t)})},"#ffffff"):a(n,"remove"===e?"":e)})})}},r=n,jy.sketch({dom:e.dom,components:e.components,toggleClass:"mce-active",dropdownBehaviours:Fa([Uy.config({}),Zb.config({})]),layouts:e.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:r.getSink,fetch:function(){return tb.nu(function(t){return e.fetch(t)}).map(function(t){return tt.from($h(Jt(Kh(Vo("menu-value"),t,function(t){e.onItemAction(t)},5,"color",hh.CLOSE_ON_EXECUTE,function(){return!1},r.providers),{movement:Hh(5,"color")})))})},parts:{menu:Rh(0,0,"color")}})));return jv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,c.asSpec()]}]),fieldBehaviours:Fa([_g("form-field-events",[Ni(Wy,function(t,n){c.getOpt(t).each(function(t){zu(t.element(),"background-color",n.event().color())})}),Ni(Gy,function(n,e){jv.getField(n).each(function(t){ag.setValue(t,e.event().value()),Vl.getCurrent(n).each(dg.focus)})}),Ni(Xy,function(t){jv.getField(t).each(function(){Vl.getCurrent(t).each(dg.focus)})})])])})},qy=function(t,n,e){return{hue:Z(t),saturation:Z(n),value:Z(e)}},Ky=Z(Vo("rgb-hex-update")),Jy=Z(Vo("slider-update")),$y=Z(Vo("palette-update")),Qy=ee.detect().deviceType.isTouch(),Zy=rl({schema:[Kr("dom")],name:"label"}),tx=function(t){return rl({name:t+"-edge",overrides:function(o){return o.model.manager.edgeActions[t].fold(function(){return{}},function(e){var t=Ii([Pi(mn(),e,[o])]),n=Ii([Pi(hn(),e,[o]),Pi(vn(),function(t,n){n.mouseIsDown.get()&&e(t,n)},[o])]);return{events:Qy?t:n}})}})},nx=tx("top-left"),ex=tx("top"),ox=tx("top-right"),rx=tx("right"),ix=tx("bottom-right"),ux=tx("bottom"),ax=tx("bottom-left"),cx=[Zy,tx("left"),rx,ex,ux,nx,ox,ax,ix,el({name:"thumb",defaults:Z({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ii([ji(mn(),t,"spectrum"),ji(gn(),t,"spectrum"),ji(pn(),t,"spectrum"),ji(hn(),t,"spectrum"),ji(vn(),t,"spectrum"),ji(yn(),t,"spectrum")])}}}),el({schema:[vi("mouseIsDown",function(){return an(!1)})],name:"spectrum",overrides:function(e){var o=e.model.manager,r=function(n,t){return o.getValueFromEvent(t).map(function(t){return o.setValueFrom(n,e,t)})},t=Ii([Ni(mn(),r),Ni(gn(),r)]),n=Ii([Ni(hn(),r),Ni(vn(),function(t,n){e.mouseIsDown.get()&&r(t,n)})]);return{behaviours:Fa(Qy?[]:[Um.config({mode:"special",onLeft:function(t){return o.onLeft(t,e)},onRight:function(t){return o.onRight(t,e)},onUp:function(t){return o.onUp(t,e)},onDown:function(t){return o.onDown(t,e)}}),dg.config({})]),events:Qy?t:n}}})],sx=ee.detect().deviceType.isTouch(),fx=Z("slider.change.value"),lx=function(t){var n=t.event().raw();if(sx){var e=n;return e.touches!==undefined&&1===e.touches.length?tt.some(e.touches[0]).map(function(t){return Wa(t.clientX,t.clientY)}):tt.none()}var o=n;return o.clientX!==undefined?tt.some(o).map(function(t){return Wa(t.clientX,t.clientY)}):tt.none()},dx=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},mx=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},gx=function(t,n,e){return Math.max(n,Math.min(e,t))},px=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=l,S=d,Math.min(S,Math.max(x,w))-w),C=gx(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold(function(){var t=h-v,n=Math.round(t/y)*y;return gx(v+n,v-1,b+1)},function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)})):c?Math.round(C):C},hx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:f:(r-n)/o*c},vx=function(t){return t.model.minX},bx=function(t){return t.model.minY},yx=function(t){return t.model.minX-1},xx=function(t){return t.model.minY-1},wx=function(t){return t.model.maxX},Sx=function(t){return t.model.maxY},kx=function(t){return t.model.maxX+1},Cx=function(t){return t.model.maxY+1},Ox=function(t,n,e){return n(t)-e(t)},Tx=function(t){return Ox(t,wx,vx)},Ex=function(t){return Ox(t,Sx,bx)},Bx=function(t){return Tx(t)/2},Ax=function(t){return Ex(t)/2},Dx=function(t){return t.stepSize},_x=function(t){return t.snapToGrid},Mx=function(t){return t.snapStart},Fx=function(t){return t.rounded},Ix=function(t,n){return t[n+"-edge"]!==undefined},Vx=function(t){return Ix(t,"left")},Rx=function(t){return Ix(t,"right")},Hx=function(t){return Ix(t,"top")},Nx=function(t){return Ix(t,"bottom")},Px=function(t){return t.model.value.get()},zx=function(t){return{x:Z(t)}},Lx=function(t){return{y:Z(t)}},jx=function(t,n){return{x:Z(t),y:Z(n)}},Ux=function(t,n){Si(t,fx(),{value:n})},Wx="left",Gx=function(t){return t.element().dom().getBoundingClientRect()},Xx=function(t,n){return t[n]},Yx=function(t){var n=Gx(t);return Xx(n,Wx)},qx=function(t){var n=Gx(t);return Xx(n,"right")},Kx=function(t){var n=Gx(t);return Xx(n,"top")},Jx=function(t){var n=Gx(t);return Xx(n,"bottom")},$x=function(t){var n=Gx(t);return Xx(n,"width")},Qx=function(t){var n=Gx(t);return Xx(n,"height")},Zx=function(t,n,e){return(t+n)/2-e},tw=function(t,n){var e=Gx(t),o=Gx(n),r=Xx(e,Wx),i=Xx(e,"right"),u=Xx(o,Wx);return Zx(r,i,u)},nw=function(t,n){var e=Gx(t),o=Gx(n),r=Xx(e,"top"),i=Xx(e,"bottom"),u=Xx(o,"top");return Zx(r,i,u)},ew=function(t,n){Si(t,fx(),{value:n})},ow=function(t){return{x:Z(t)}},rw=function(t,n,e){var o={min:vx(n),max:wx(n),range:Tx(n),value:e,step:Dx(n),snap:_x(n),snapStart:Mx(n),rounded:Fx(n),hasMinEdge:Vx(n),hasMaxEdge:Rx(n),minBound:Yx(t),maxBound:qx(t),screenRange:$x(t)};return px(o)},iw=function(u){return function(t,n){return(e=u,o=t,r=n,i=(0<e?mx:dx)(Px(r).x(),vx(r),wx(r),Dx(r)),ew(o,ow(i)),tt.some(i)).map(function(){return!0});var e,o,r,i}},uw=function(t,n,e,o,r,i){var u,a,c,s,f,l,d,m,g,p=(a=i,c=e,s=o,f=r,l=$x(u=n),d=s.bind(function(t){return tt.some(tw(t,u))}).getOr(0),m=f.bind(function(t){return tt.some(tw(t,u))}).getOr(l),g={min:vx(a),max:wx(a),range:Tx(a),value:c,hasMinEdge:Vx(a),hasMaxEdge:Rx(a),minBound:Yx(u),minOffset:0,maxBound:qx(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},hx(g));return Yx(n)-Yx(t)+p},aw=iw(-1),cw=iw(1),sw=tt.none,fw=tt.none,lw={"top-left":tt.none(),top:tt.none(),"top-right":tt.none(),right:tt.some(function(t,n){Ux(t,zx(kx(n)))}),"bottom-right":tt.none(),bottom:tt.none(),"bottom-left":tt.none(),left:tt.some(function(t,n){Ux(t,zx(yx(n)))})},dw=Object.freeze({setValueFrom:function(t,n,e){var o=rw(t,n,e),r=ow(o);return ew(t,r),o},setToMin:function(t,n){var e=vx(n);ew(t,ow(e))},setToMax:function(t,n){var e=wx(n);ew(t,ow(e))},findValueOfOffset:rw,getValueFromEvent:function(t){return lx(t).map(function(t){return t.left()})},findPositionOfValue:uw,setPositionFromValue:function(t,n,e,o){var r=Px(e),i=uw(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),u=Ja(n.element())/2;zu(n.element(),"left",i-u+"px")},onLeft:aw,onRight:cw,onUp:sw,onDown:fw,edgeActions:lw}),mw=function(t,n){Si(t,fx(),{value:n})},gw=function(t){return{y:Z(t)}},pw=function(t,n,e){var o={min:bx(n),max:Sx(n),range:Ex(n),value:e,step:Dx(n),snap:_x(n),snapStart:Mx(n),rounded:Fx(n),hasMinEdge:Hx(n),hasMaxEdge:Nx(n),minBound:Kx(t),maxBound:Jx(t),screenRange:Qx(t)};return px(o)},hw=function(u){return function(t,n){return(e=u,o=t,r=n,i=(0<e?mx:dx)(Px(r).y(),bx(r),Sx(r),Dx(r)),mw(o,gw(i)),tt.some(i)).map(function(){return!0});var e,o,r,i}},vw=function(t,n,e,o,r,i){var u,a,c,s,f,l,d,m,g,p=(a=i,c=e,s=o,f=r,l=Qx(u=n),d=s.bind(function(t){return tt.some(nw(t,u))}).getOr(0),m=f.bind(function(t){return tt.some(nw(t,u))}).getOr(l),g={min:bx(a),max:Sx(a),range:Ex(a),value:c,hasMinEdge:Hx(a),hasMaxEdge:Nx(a),minBound:Kx(u),minOffset:0,maxBound:Jx(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m},hx(g));return Kx(n)-Kx(t)+p},bw=tt.none,yw=tt.none,xw=hw(-1),ww=hw(1),Sw={"top-left":tt.none(),top:tt.some(function(t,n){Ux(t,Lx(xx(n)))}),"top-right":tt.none(),right:tt.none(),"bottom-right":tt.none(),bottom:tt.some(function(t,n){Ux(t,Lx(Cx(n)))}),"bottom-left":tt.none(),left:tt.none()},kw=Object.freeze({setValueFrom:function(t,n,e){var o=pw(t,n,e),r=gw(o);return mw(t,r),o},setToMin:function(t,n){var e=bx(n);mw(t,gw(e))},setToMax:function(t,n){var e=Sx(n);mw(t,gw(e))},findValueOfOffset:pw,getValueFromEvent:function(t){return lx(t).map(function(t){return t.top()})},findPositionOfValue:vw,setPositionFromValue:function(t,n,e,o){var r=Px(e),i=vw(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),u=Za(n.element())/2;zu(n.element(),"top",i-u+"px")},onLeft:bw,onRight:yw,onUp:xw,onDown:ww,edgeActions:Sw}),Cw=function(t,n){Si(t,fx(),{value:n})},Ow=function(t,n){return{x:Z(t),y:Z(n)}},Tw=function(s,f){return function(t,n){return(e=s,o=f,r=t,i=n,u=0<e?mx:dx,a=o?Px(i).x():u(Px(i).x(),vx(i),wx(i),Dx(i)),c=o?u(Px(i).y(),bx(i),Sx(i),Dx(i)):Px(i).y(),Cw(r,Ow(a,c)),tt.some(a)).map(function(){return!0});var e,o,r,i,u,a,c}},Ew=Tw(-1,!1),Bw=Tw(1,!1),Aw=Tw(-1,!0),Dw=Tw(1,!0),_w={"top-left":tt.some(function(t,n){Ux(t,jx(yx(n),xx(n)))}),top:tt.some(function(t,n){Ux(t,jx(Bx(n),xx(n)))}),"top-right":tt.some(function(t,n){Ux(t,jx(kx(n),xx(n)))}),right:tt.some(function(t,n){Ux(t,jx(kx(n),Ax(n)))}),"bottom-right":tt.some(function(t,n){Ux(t,jx(kx(n),Cx(n)))}),bottom:tt.some(function(t,n){Ux(t,jx(Bx(n),Cx(n)))}),"bottom-left":tt.some(function(t,n){Ux(t,jx(yx(n),Cx(n)))}),left:tt.some(function(t,n){Ux(t,jx(yx(n),Ax(n)))})},Mw=Object.freeze({setValueFrom:function(t,n,e){var o=rw(t,n,e.left()),r=pw(t,n,e.top()),i=Ow(o,r);return Cw(t,i),i},setToMin:function(t,n){var e=vx(n),o=bx(n);Cw(t,Ow(e,o))},setToMax:function(t,n){var e=wx(n),o=Sx(n);Cw(t,Ow(e,o))},getValueFromEvent:function(t){return lx(t)},setPositionFromValue:function(t,n,e,o){var r=Px(e),i=uw(t,o.getSpectrum(t),r.x(),o.getLeftEdge(t),o.getRightEdge(t),e),u=vw(t,o.getSpectrum(t),r.y(),o.getTopEdge(t),o.getBottomEdge(t),e),a=Ja(n.element())/2,c=Za(n.element())/2;zu(n.element(),"left",i-a+"px"),zu(n.element(),"top",u-c+"px")},onLeft:Ew,onRight:Bw,onUp:Aw,onDown:Dw,edgeActions:_w}),Fw=ee.detect().deviceType.isTouch(),Iw=[si("stepSize",1),si("onChange",Q),si("onChoose",Q),si("onInit",Q),si("onDragStart",Q),si("onDragEnd",Q),si("snapToGrid",!1),si("rounded",!0),oi("snapStart"),Jr("model",Lr("mode",{x:[si("minX",0),si("maxX",100),vi("value",function(t){return an(t.mode.minX)}),Kr("getInitialValue"),Oa("manager",dw)],y:[si("minY",0),si("maxY",100),vi("value",function(t){return an(t.mode.minY)}),Kr("getInitialValue"),Oa("manager",kw)],xy:[si("minX",0),si("maxX",100),si("minY",0),si("maxY",100),vi("value",function(t){return an({x:Z(t.mode.minX),y:Z(t.mode.minY)})}),Kr("getInitialValue"),Oa("manager",Mw)]})),Bf("sliderBehaviours",[Um,ag])].concat(Fw?[]:[vi("mouseIsDown",function(){return an(!1)})]),Vw=ee.detect().deviceType.isTouch(),Rw=_l({name:"Slider",configFields:Iw,partFields:cx,factory:function(r,t){var i=function(t){return vl(t,r,"thumb")},u=function(t){return vl(t,r,"spectrum")},e=function(t){return hl(t,r,"left-edge")},o=function(t){return hl(t,r,"right-edge")},a=function(t){return hl(t,r,"top-edge")},c=function(t){return hl(t,r,"bottom-edge")},s=r.model,f=s.manager,l=function(t,n){f.setPositionFromValue(t,n,r,{getLeftEdge:e,getRightEdge:o,getTopEdge:a,getBottomEdge:c,getSpectrum:u})},d=function(t,n){s.value.set(n);var e=i(t);return l(t,e),r.onChange(t,e,n),tt.some(!0)},n=[Ni(mn(),function(t){r.onDragStart(t,i(t))}),Ni(pn(),function(t){r.onDragEnd(t,i(t))})],m=[Ni(hn(),function(t,n){n.stop(),r.onDragStart(t,i(t)),r.mouseIsDown.set(!0)}),Ni(yn(),function(t){r.onDragEnd(t,i(t))})],g=Vw?n:m;return{uid:r.uid,dom:r.dom,components:t,behaviours:Df(r.sliderBehaviours,xt([Vw?[]:[Um.config({mode:"special",focusIn:function(t){return hl(t,r,"spectrum").map(Um.focusIn).map(Z(!0))}})],[ag.config({store:{mode:"manual",getValue:function(){return s.value.get()}}}),La.config({channels:{"mouse.released":{onReceive:function(e){var t=r.mouseIsDown.get();r.mouseIsDown.set(!1),t&&hl(e,r,"thumb").each(function(t){var n=s.value.get();r.onChoose(e,t,n)})}}}})]])),events:Ii([Ni(fx(),function(t,n){d(t,n.event().value())}),Yi(function(t){var n=s.getInitialValue();s.value.set(n);var e=i(t);l(t,e);var o=u(t);r.onInit(t,e,o,s.value.get())})].concat(g)),apis:{resetToMin:function(t){f.setToMin(t,r)},resetToMax:function(t){f.setToMax(t,r)},changeValue:d,refresh:l},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),Hw=function(t,n){var e=Rw.parts().spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Rw.parts().thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return Rw.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:Z({y:Z(0)})},components:[e,o],sliderBehaviours:Fa([dg.config({})]),onChange:function(t,n,e){Si(t,Jy(),{value:e})}})},Nw=[Bf("formBehaviours",[ag])],Pw=function(t){return"<alloy.field."+t+">"},zw=function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:Df(o.formBehaviours,[ag.config({store:{mode:"manual",getValue:function(t){var n=yl(t,o);return It(n,function(t){return t().bind(function(t){var n,e=Vl.getCurrent(t);return n="missing current",e.fold(function(){return Xt.error(n)},Xt.value)}).map(ag.getValue)})},setValue:function(e,t){Ft(t,function(n,t){hl(e,o,t).each(function(t){Vl.getCurrent(t).each(function(t){ag.setValue(t,n)})})})}}})]),apis:{getField:function(t,n){return hl(t,o,n).bind(Vl.getCurrent)}}}},Lw={getField:gu(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var e,n=(e=[],{field:function(t,n){return e.push(t),ll("form",Pw(t),n)},record:function(){return e}}),o=t(n),r=n.record(),i=st(r,function(t){return el({name:t,pname:Pw(t)})});return Tl("form",Nw,i,zw,o)}},jw=Vo("valid-input"),Uw=Vo("invalid-input"),Ww=Vo("validating-input"),Gw="colorcustom.rgb.",Xw=function(d,m,g,p){var h=function(t,n,e,o,r){var i,u,a=d(Gw+"range"),c=[jv.parts().label({dom:{tag:"label",innerHtml:e,attributes:{"aria-label":o}}}),jv.parts().field({data:r,factory:Rb,inputAttributes:Ho({type:"text"},"hex"===n?{"aria-live":"polite"}:{}),inputClasses:[m("textfield")],inputBehaviours:Fa([(i=n,u=t,Jb.config({invalidClass:m("invalid"),notify:{onValidate:function(t){Si(t,Ww,{type:i})},onValid:function(t){Si(t,jw,{type:i,value:ag.getValue(t)})},onInvalid:function(t){Si(t,Uw,{type:i,value:ag.getValue(t)})}},validator:{validate:function(t){var n=ag.getValue(t),e=u(n)?Xt.value(!0):Xt.error(d("aria.input.invalid"));return tb.pure(e)},validateOnLoad:!1}})),Zb.config({})]),onSetValue:function(t){Jb.isInvalid(t)&&Jb.run(t).get(Q)}})],s="hex"!==n?[jv.parts()["aria-descriptor"]({text:a})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:c.concat(s)}},v=function(t,n){var e=n.red(),o=n.green(),r=n.blue();ag.setValue(t,{red:e,green:o,blue:r})},b=Kg({dom:{tag:"div",classes:[m("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),y=function(t,n){b.getOpt(t).each(function(t){zu(t.element(),"background-color","#"+n.value())})};return Dl({factory:function(){var e={red:Z(an(tt.some(255))),green:Z(an(tt.some(255))),blue:Z(an(tt.some(255))),hex:Z(an(tt.some("ffffff")))},o=function(t){return e[t]().get()},i=function(t,n){e[t]().set(n)},r=function(t){var n=t.red(),e=t.green(),o=t.blue();i("red",tt.some(n)),i("green",tt.some(e)),i("blue",tt.some(o))},n=function(t,n){var e=n.event();"hex"!==e.type()?i(e.type(),tt.none()):p(t)},u=function(r,t,n){var e=parseInt(n,10);i(t,tt.some(e)),o("red").bind(function(e){return o("green").bind(function(n){return o("blue").map(function(t){return dy(e,n,t,1)})})}).each(function(t){var n,e,o=(n=r,e=uy(t),Lw.getField(n,"hex").each(function(t){dg.isFocused(t)||ag.setValue(n,{hex:e.value()})}),e);y(r,o)})},a=function(t,n){var e=n.event();"hex"===e.type()?function(t,n){g(t);var e=ty(n);i("hex",tt.some(n));var o=py(e);v(t,o),r(o),Si(t,Ky(),{hex:e}),y(t,e)}(t,e.value()):u(t,e.type(),e.value())},t=function(t){return{label:d(Gw+t+".label"),description:d(Gw+t+".description")}},c=t("red"),s=t("green"),f=t("blue"),l=t("hex");return Jt(Lw.sketch(function(t){return{dom:{tag:"form",classes:[m("rgb-form")],attributes:{"aria-label":d("aria.color.picker")}},components:[t.field("red",jv.sketch(h(my,"red",c.label,c.description,255))),t.field("green",jv.sketch(h(my,"green",s.label,s.description,255))),t.field("blue",jv.sketch(h(my,"blue",f.label,f.description,255))),t.field("hex",jv.sketch(h(oy,"hex",l.label,l.description,"ffffff"))),b.asSpec()],formBehaviours:Fa([Jb.config({invalidClass:m("form-invalid")}),_g("rgb-form-events",[Ni(jw,a),Ni(Uw,n),Ni(Ww,n)])])}}),{apis:{updateHex:function(t,n){var e,o;ag.setValue(t,{hex:n.value()}),e=t,o=py(n),v(e,o),r(o),y(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},Yw=function(t,e){var o=Rw.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[e("sv-palette-spectrum")]}}),r=Rw.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette-thumb")],innerHtml:"<div class="+e("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return Dl({factory:function(){var t=Z({x:Z(0),y:Z(0)}),n=Fa([Vl.config({find:tt.some}),dg.config({})]);return Rw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[o,r],onChange:function(t,n,e){Si(t,$y(),{value:e})},onInit:function(t,n,e){i(e.element().dom(),vy(by()))},sliderBehaviours:n})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r;o=e,r=n.components()[0].element().dom(),i(r,vy(o))}},extraApis:{}})},qw=function(c,s){return Dl({name:"ColourPicker",configFields:[Kr("dom"),si("onValidHex",Q),si("onInvalidHex",Q)],factory:function(t){var u,h,e=Xw(c,s,t.onValidHex,t.onInvalidHex),o=Yw(c,s),v={paletteRgba:Z(an(by()))},n=Kg(o.sketch({})),r=Kg(e.sketch({})),i=function(t,e){n.getOpt(t).each(function(t){var n=py(e);v.paletteRgba().set(n),o.setRgba(t,n)})},a=function(t,n){r.getOpt(t).each(function(t){e.updateHex(t,n)})},b=function(n,e,t){ft(t,function(t){t(n,e)})};return{uid:t.uid,dom:t.dom,components:[n.asSpec(),Hw(c,s),r.asSpec()],behaviours:Fa([_g("colour-picker-events",[Ni($y(),(h=[a],function(t,n){var e,o,r,i,u,a,c,s,f,l=n.event().value(),d=(i=r=0,u=(e=v.paletteRgba().get()).red()/255,a=e.green()/255,c=e.blue()/255,(s=Math.min(u,Math.min(a,c)))===(f=Math.max(u,Math.max(a,c)))?qy(0,0,100*(i=s)):(r=60*((r=u===s?3:c===s?1:5)-(u===s?a-c:c===s?u-a:c-u)/(f-s)),o=(f-s)/f,i=f,qy(Math.round(r),Math.round(100*o),Math.round(100*i)))),m=qy(d.hue(),l.x(),100-l.y()),g=gy(m),p=uy(g);b(t,p,h)})),Ni(Jy(),(u=[i,a],function(t,n){var e,o,r,i=(e=n.event().value().y(),o=qy((100-e)/100*360,100,100),r=gy(o),uy(r));b(t,i,u)}))]),Vl.config({find:function(t){return r.getOpt(t)}}),Um.config({mode:"acyclic"})])}}})},Kw=function(){return Vl.config({find:tt.some})},Jw=function(t){return Vl.config({find:t.getOpt})},$w=function(t){return Vl.config({find:function(n){return Ze(n.element(),t).bind(function(t){return n.getSystem().getByDom(t).toOption()})}})},Qw={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Zw=function(t){return Qw[t]},tS=Sr([si("preprocess",U),si("postprocess",U)]),nS=function(t,n,e){return ag.config(Jt({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},eS=function(t,n,e){return nS(t,function(t){return n(t.element())},function(t,n){return e(t.element(),n)})},oS=function(r,t){var i=Pr("RepresentingConfigs.memento processors",tS,t);return ag.config({store:{mode:"manual",getValue:function(t){var n=r.get(t),e=ag.getValue(n);return i.postprocess(e)},setValue:function(t,n){var e=i.preprocess(n),o=r.get(t);ag.setValue(o,e)}}})},rS=nS,iS=function(t){return eS(t,ao,co)},uS=function(t){return ag.config({store:{mode:"memory",initialValue:t}})},aS=function(r,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){ft(t,function(t){t(n,e)})}},i=function(t,n){if(!ah.isDisabled(t)){var e=n.event().raw();a(t,e.dataTransfer.files)}},u=function(t,n){var e=n.event().raw().target.files;a(t,e)},a=function(t,n){var e,o;ag.setValue(t,(e=n,o=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),mt(Dt(e),function(t){return o.test(t.name)}))),Si(t,_v,{name:r.name})},c=Kg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Fa([_g("input-file-events",[Wi(le())])])}),t=r.label.map(function(t){return Ab(t,n)}),s=jv.parts().field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Fa([uS([]),Kw(),ah.config({}),Cg.config({toggleClass:"dragenter",toggleOnExecute:!1}),_g("dropzone-events",[Ni("dragenter",o([e,Cg.toggle])),Ni("dragleave",o([e,Cg.toggle])),Ni("dragover",e),Ni("drop",o([e,i])),Ni(Tn(),u)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},qg.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[c.asSpec()],action:function(t){c.get(t).element().dom().click()},buttonBehaviours:Fa([Zb.config({})])})]}]}}}});return Ob(t,s,["tox-form__group--stretched"])},cS=Vo("alloy-fake-before-tabstop"),sS=Vo("alloy-fake-after-tabstop"),fS=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Fa([dg.config({ignore:!0}),Zb.config({})])}},lS=function(t,n){Si(t,kn(),{raw:{which:9,shiftKey:n}})},dS=function(t){return iv(t,["."+cS,"."+sS].join(","),Z(!1))},mS=function(t,n){var e=n.element();Iu(e,cS)?lS(t,!0):Iu(e,sS)&&lS(t,!1)},
gS=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[fS([cS]),t,fS([sS])],behaviours:Fa([$w(1)])}},pS=!(ee.detect().browser.isIE()||ee.detect().browser.isEdge()),hS=function(t,n){var o,r,e=pS&&t.sandboxed,i=Ho({},t.label.map(function(t){return{title:t}}).getOr({}),e?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(o=e,r=an(""),{getValue:function(){return r.get()},setValue:function(t,n){if(o)vo(t.element(),"src","data:text/html;charset=utf-8,"+encodeURIComponent(n));else{vo(t.element(),"src","javascript:''");var e=t.element().dom().contentWindow.document;e.open(),e.write(n),e.close()}r.set(n)}}),a=t.label.map(function(t){return Ab(t,n)}),c=jv.parts().field({factory:{sketch:function(t){return gS({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Fa([Zb.config({}),dg.config({}),rS(tt.none(),u.getValue,u.setValue)])})}}});return Ob(a,c,["tox-form__group--stretched"])},vS={create:r,clone:function ZD(t){var n;return i(n=r(t.width,t.height)).drawImage(t,0,0),n},resize:u,get2dContext:i,get3dContext:function t_(t){var n=null;try{n=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(M){}return n||(n=null),n}},bS={getWidth:function n_(t){return t.naturalWidth||t.width},getHeight:function e_(t){return t.naturalHeight||t.height}},yS=window.Promise?window.Promise:function(){function c(t,n){return function(){t.apply(n,arguments)}}function i(e){var o=this;null!==this._state?t(function(){var t=o._state?e.onFulfilled:e.onRejected;if(null!==t){var n;try{n=t(o._value)}catch(f){return void e.reject(f)}e.resolve(n)}else(o._state?e.resolve:e.reject)(o._value)}):this._deferreds.push(e)}function r(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void a(c(n,t),c(r,this),c(e,this))}this._state=!0,this._value=t,o.call(this)}catch(f){e.call(this,f)}}function e(t){this._state=!1,this._value=t,o.call(this)}function o(){for(var t=0,n=this._deferreds.length;t<n;t++)i.call(this,this._deferreds[t]);this._deferreds=null}function u(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function a(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(r){if(o)return;o=!0,e(r)}}var s=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],a(t,c(r,this),c(e,this))},t=s.immediateFn||"function"==typeof window.setImmediate&&window.setImmediate||function(t){x.setTimeout(t,1)},f=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};return s.prototype["catch"]=function(t){return this.then(null,t)},s.prototype.then=function(e,o){var r=this;return new s(function(t,n){i.call(r,new u(e,o,t,n))})},s.all=function(t){var a=Array.prototype.slice.call(1===arguments.length&&f(t)?arguments[0]:arguments);return new s(function(o,r){function i(n,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void e.call(t,function(t){i(n,t)},r)}a[n]=t,0==--u&&o(a)}catch(c){r(c)}}if(0===a.length)return o([]);for(var u=a.length,t=0;t<a.length;t++)i(t,a[t])})},s.resolve=function(n){return n&&"object"==typeof n&&n.constructor===s?n:new s(function(t){t(n)})},s.reject=function(e){return new s(function(t,n){n(e)})},s.race=function(r){return new s(function(t,n){for(var e=0,o=r.length;e<o;e++)r[e].then(t,n)})},s}(),xS={atob:function(t){return He.getOrDie("atob")(t)},requestAnimationFrame:function(t){He.getOrDie("requestAnimationFrame")(t)}},wS={blobToImage:f,imageToBlob:function o_(t){var n=t.src;return 0===n.indexOf("data:")?m(n):l(n)},blobToArrayBuffer:function r_(e){return new yS(function(t){var n=a();n.onloadend=function(){t(n.result)},n.readAsArrayBuffer(e)})},blobToDataUri:g,blobToBase64:function i_(t){return g(t).then(function(t){return t.split(",")[1]})},dataUriToBlobSync:d,canvasToBlob:function u_(t,e,o){return e=e||"image/png",x.HTMLCanvasElement.prototype.toBlob?new yS(function(n){t.toBlob(function(t){n(t)},e,o)}):m(t.toDataURL(e,o))},canvasToDataURL:function a_(t,n,e){return n=n||"image/png",t.then(function(t){return t.toDataURL(n,e)})},blobToCanvas:function c_(t){return f(t).then(function(t){var n;return function M(n){x.URL.revokeObjectURL(n.src)}(t),n=vS.create(bS.getWidth(t),bS.getHeight(t)),vS.get2dContext(n).drawImage(t,0,0),n})},uriToBlob:function s_(t){return 0===t.indexOf("blob:")?l(t):0===t.indexOf("data:")?m(t):null}},SS={fromBlob:y,fromCanvas:function f_(n,t){return wS.canvasToBlob(n,t).then(function(t){return p(yS.resolve(n),t,n.toDataURL())})},fromImage:function l_(t){return wS.imageToBlob(t).then(function(t){return y(t)})},fromBlobAndUrlSync:function(t,n){return p(wS.blobToCanvas(t),t,n)}},kS=function(t){return SS.fromBlob(t)},CS=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],OS={identity:function d_(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:k,multiply:S,adjustContrast:function m_(t,n){var e;return n=w(n,-1,1),S(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?CS[n]:CS[Math.floor(n)]*(1-e)+CS[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function g_(t,n){return S(t,[1,0,0,0,n=w(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function p_(t,n){var e;return S(t,[.3086*(1-(e=1+(0<(n=w(n,-1,1))?3*n:n)))+e,.6094*(1-e),.082*(1-e),0,0,.3086*(1-e),.6094*(1-e)+e,.082*(1-e),0,0,.3086*(1-e),.6094*(1-e),.082*(1-e)+e,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function h_(t,n){var e,o;return n=w(n,-180,180)/180*Math.PI,S(t,[.213+.787*(e=Math.cos(n))+-.213*(o=Math.sin(n)),.715+-.715*e+-.715*o,.072+-.072*e+.928*o,0,0,.213+-.213*e+.143*o,.715+e*(1-.715)+.14*o,.072+-.072*e+-.283*o,0,0,.213+-.213*e+-.787*o,.715+-.715*e+.715*o,.072+.928*e+.072*o,0,0,0,0,0,1,0,0,0,0,0,1])},adjustColors:function v_(t,n,e,o){return S(t,[n=w(n,0,2),0,0,0,0,0,e=w(e,0,2),0,0,0,0,0,o=w(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function b_(t,n){return S(t,k([.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0,0,0,0,0,1],n=w(n,0,1)))},adjustGrayscale:function y_(t,n){return S(t,k([.33,.34,.33,0,0,.33,.34,.33,0,0,.33,.34,.33,0,0,0,0,0,1,0,0,0,0,0,1],n=w(n,0,1)))}},TS={invert:function x_(n){return function(t){return C(t,n)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:E(OS.adjustBrightness),hue:E(OS.adjustHue),saturate:E(OS.adjustSaturation),contrast:E(OS.adjustContrast),grayscale:E(OS.adjustGrayscale),sepia:E(OS.adjustSepia),colorize:function(t,n,e,o){return C(t,OS.adjustColors(OS.identity(),n,e,o))},sharpen:B([0,-1,0,-1,5,-1,0,-1,0]),emboss:B([-2,-1,0,-1,1,1,0,1,2]),gamma:T(function(t,n){return 255*Math.pow(t/255,1-n)}),exposure:T(function(t,n){return 255*(1-Math.exp(-t/255*n))}),colorFilter:C,convoluteFilter:O},ES={scale:function w_(t,n,e){var o=bS.getWidth(t),r=bS.getHeight(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=function s(u,a,c){return new yS(function(t){var n=bS.getWidth(u),e=bS.getHeight(u),o=Math.floor(n*a),r=Math.floor(e*c),i=vS.create(o,r);vS.get2dContext(i).drawImage(u,0,0,n,e,0,0,o,r),t(i)})}(t,i,u);return a?c.then(function(t){return w_(t,n,e)}):c}},BS={rotate:function S_(n,e){return n.toCanvas().then(function(t){return function a(t,n,e){var o=vS.create(t.width,t.height),r=vS.get2dContext(o),i=0,u=0;return 90!=(e=e<0?360+e:e)&&270!=e||vS.resize(o,o.height,o.width),90!=e&&180!=e||(i=o.width),270!=e&&180!=e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),SS.fromCanvas(o,n)}(t,n.getType(),e)})},flip:function k_(n,e){return n.toCanvas().then(function(t){return function i(t,n,e){var o=vS.create(t.width,t.height),r=vS.get2dContext(o);return"v"==e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),SS.fromCanvas(o,n)}(t,n.getType(),e)})},crop:function C_(n,e,o,r,i){return n.toCanvas().then(function(t){return function a(t,n,e,o,r,i){var u=vS.create(r,i);return vS.get2dContext(u).drawImage(t,-e,-o),SS.fromCanvas(u,n)}(t,n.getType(),e,o,r,i)})},resize:function O_(n,e,o){return n.toCanvas().then(function(t){return ES.scale(t,e,o).then(function(t){return SS.fromCanvas(t,n.getType())})})}},AS=(function(){function t(t){this.littleEndian=!1,this._dv=new DataView(t)}t.prototype.readByteAt=function(t){return this._dv.getUint8(t)},t.prototype.read=function(t,n){if(t+n>this.length())return null;for(var e=this.littleEndian?0:-8*(n-1),o=0,r=0;o<n;o++)r|=this.readByteAt(t+o)<<Math.abs(e+8*o);return r},t.prototype.BYTE=function(t){return this.read(t,1)},t.prototype.SHORT=function(t){return this.read(t,2)},t.prototype.LONG=function(t){return this.read(t,4)},t.prototype.SLONG=function(t){var n=this.read(t,4);return 2147483647<n?n-4294967296:n},t.prototype.CHAR=function(t){return String.fromCharCode(this.read(t,1))},t.prototype.STRING=function(t,n){return this.asArray("CHAR",t,n).join("")},t.prototype.SEGMENT=function(t,n){var e=this._dv.buffer;switch(arguments.length){case 2:return e.slice(t,t+n);case 1:return e.slice(t);default:return e}},t.prototype.asArray=function(t,n,e){for(var o=[],r=0;r<e;r++)o[r]=this[t](n+r);return o},t.prototype.length=function(){return this._dv?this._dv.byteLength:0}}(),function(t,n){return BS.rotate(t,n)}),DS=function(t){return TS.invert(t)},_S=function(t){return TS.sharpen(t)},MS=function(t,n){return TS.brightness(t,n)},FS=function(t,n){return TS.contrast(t,n)},IS=function(t,n,e,o){return TS.colorize(t,n,e,o)},VS=function(t,n){return TS.gamma(t,n)},RS=function(t,n){return BS.flip(t,n)},HS=function(t,n,e,o,r){return BS.crop(t,n,e,o,r)},NS=function(t,n,e){return BS.resize(t,n,e)},PS=AS,zS=function(t,n){return Ho({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},LS=function(t,n){return zS($g(t,n),{})},jS=function(t,n){return zS($g(t,n),{behaviours:Fa([qm.config({})])})},US=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Fa([qm.config({})])}},WS=function(t,n,e,o,r){void 0===e&&(e=[]);var i=n.fold(function(){return{}},function(t){return{action:t}}),u=Ho({buttonBehaviours:Fa([sh(t.disabled),Zb.config({}),_g("button press",[Hi("click"),Hi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=Jt(u,{dom:o});return Jt(a,{components:r})},GS=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return LS(t,e.icons)}),u=bh([i]);return WS(t,n,o,r,u)},XS=function(t,n,e,o){void 0===o&&(o=[]);var r=GS(t,tt.some(n),e,o);return qg.sketch(r)},YS=function(t,n,e,o){void 0===o&&(o=[]);var r=e.translate(t.text),i=t.icon?t.icon.map(function(t){return LS(t,e.icons)}):tt.none(),u=i.isSome()?bh([i]):[],a=i.isSome()?{}:{innerHtml:r},c=(t.primary?["tox-button"]:["tox-button","tox-button--secondary"]).concat(i.isSome()?["tox-button--icon"]:[]);return function(t,n,e,o,r){void 0===e&&(e=[]);var i=WS(t,tt.some(n),e,o,r);return qg.sketch(i)}(t,n,o,Ho({tag:"button",classes:c},a,{attributes:{title:r}}),u)},qS=function(n,e){return function(t){"custom"===e?Si(t,Iv,{name:n,value:{}}):"submit"===e?wi(t,Vv):"cancel"===e?wi(t,Fv):x.console.error("Unknown button type: ",e)}},KS=function(t,n,e){var o=qS(t.name,n);return YS(t,o,e,[])},JS=Z([si("field1Name","field1"),si("field2Name","field2"),ka("onLockedChange"),ya(["lockClass"]),si("locked",!1),_f.field("coupledFieldBehaviours",[Vl,ag])]),$S=function(t,i){return el({factory:jv,name:t,overrides:function(r){return{fieldBehaviours:Fa([_g("coupled-input-behaviour",[Ni(On(),function(e){var t,n,o;(t=e,n=r,o=i,hl(t,n,o).bind(Vl.getCurrent)).each(function(n){hl(e,r,"lock").each(function(t){Cg.isOn(t)&&r.onLockedChange(e,n,t)})})})])])}}})},QS=Z([$S("field1","field2"),$S("field2","field1"),el({factory:qg,schema:[Kr("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Fa([Cg.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),ZS=_l({name:"FormCoupledInputs",configFields:JS(),partFields:QS(),factory:function(o,t){return{uid:o.uid,dom:o.dom,components:t,behaviours:_f.augment(o.coupledFieldBehaviours,[Vl.config({find:tt.some}),ag.config({store:{mode:"manual",getValue:function(t){var n,e=wl(t,o,["field1","field2"]);return(n={})[o.field1Name]=ag.getValue(e.field1()),n[o.field2Name]=ag.getValue(e.field2()),n},setValue:function(t,n){var e=wl(t,o,["field1","field2"]);un(n,o.field1Name)&&ag.setValue(e.field1(),n[o.field1Name]),un(n,o.field2Name)&&ag.setValue(e.field2(),n[o.field2Name])}}})]),apis:{getField1:function(t){return hl(t,o,"field1")},getField2:function(t){return hl(t,o,"field2")},getLock:function(t){return hl(t,o,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),tk=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return Xt.error(t);var e=parseFloat(n[1]),o=n[2];return Xt.value({value:e,unit:o})},nk=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?tt.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?tt.some(t.value):tt.some(t.value/e[t.unit]*e[n]):tt.none()},ek=function(){return tt.none()},ok=function(t,n){var e=tk(t).toOption(),o=tk(n).toOption();return fn([e,o],function(t,o){return nk(t,o.unit).map(function(t){return o.value/t}).map(function(t){return n=t,e=o.unit,function(t){return nk(t,e).map(function(t){return{value:t*n,unit:e}})};var n,e}).getOr(ek)}).getOr(ek)},rk=function(e,n){var a=ek,o=Vo("ratio-event"),t=ZS.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(e.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:$g("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:$g("unlock",n.icons)}}],buttonBehaviours:Fa([Zb.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},i=function(n){return jv.parts().field({factory:Rb,inputClasses:["tox-textfield"],inputBehaviours:Fa([Zb.config({}),_g("size-input-events",[Ni(wn(),function(t){Si(t,o,{isField1:n})}),Ni(Tn(),function(t){Si(t,_v,{name:e.name})})])]),selectOnFocus:!1})},u=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=ZS.parts().field1(r([jv.parts().label(u("Width")),i(!0)])),s=ZS.parts().field2(r([jv.parts().label(u("Height")),i(!1)]));return ZS.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,r([u("&nbsp;"),t])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,i){tk(ag.getValue(t)).each(function(t){a(t).each(function(t){var n,e,o,r;ag.setValue(i,(o={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},-1!==(r=(n=t).value.toFixed((e=n.unit)in o?o[e]:1)).indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+n.unit))})})},coupledFieldBehaviours:Fa([ah.config({}),_g("size-input-events2",[Ni(o,function(t,n){var e=n.event().isField1(),o=e?ZS.getField1(t):ZS.getField2(t),r=e?ZS.getField2(t):ZS.getField1(t),i=o.map(ag.getValue).getOr(""),u=r.map(ag.getValue).getOr("");a=ok(i,u)})])])})},ik={undo:Z(Vo("undo")),redo:Z(Vo("redo")),zoom:Z(Vo("zoom")),back:Z(Vo("back")),apply:Z(Vo("apply")),swap:Z(Vo("swap")),transform:Z(Vo("transform")),tempTransform:Z(Vo("temp-transform")),transformApply:Z(Vo("transform-apply"))},uk=Z("save-state"),ak=Z("disable"),ck=Z("enable"),sk={formActionEvent:Iv,saveState:uk,disable:ak,enable:ck},fk=function(r,c){var t=function(t,n,e,o){return Kg(YS({name:t,text:t,disabled:e,primary:o},n,c))},n=function(t,n,e,o){return Kg(XS({name:t,icon:tt.some(t),tooltip:tt.some(n),disabled:o},e,c))},u=function(t,e){t.map(function(t){var n=t.get(e);n.hasConfigured(ah)&&ah.disable(n)})},a=function(t,e){t.map(function(t){var n=t.get(e);n.hasConfigured(ah)&&ah.enable(n)})},s={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},e=tt.none(),o=Q,i=function(t,n,e){Si(t,n,e)},f=function(t){return wi(t,sk.disable())},l=function(t){return wi(t,sk.enable())},d=function(t,n){f(t),i(t,ik.transform(),{transform:n}),l(t)},m=function(t){return function(){$.getOpt(t).each(function(t){qm.set(t,[K])})}},g=function(t,n){f(t),i(t,ik.transformApply(),{transform:n,swap:m(t)}),l(t)},p=function(){return t("Back",function(t){return i(t,ik.back(),{swap:m(t)})},!1,!1)},h=function(){return Kg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Fa([ah.config({})])})},v=function(){return t("Apply",function(t){return i(t,ik.apply(),{swap:m(t)})},!0,!0)},b=[p(),h(),t("Apply",function(t){g(t,function(t){var n=r.getRect();return HS(t,n.x,n.y,n.w,n.h)}),r.hideCrop()},!1,!0)],y=yv.sketch({dom:s,components:b.map(function(t){return t.asSpec()}),containerBehaviours:Fa([_g("image-tools-crop-buttons-events",[Ni(sk.disable(),function(t){u(b,t)}),Ni(sk.enable(),function(t){a(b,t)})])])}),x=Kg(rk({name:"size",label:e,type:"sizeinput",constrain:!0},c)),w=[p(),h(),x,h(),t("Apply",function(a){x.getOpt(a).each(function(t){var n,e,o=ag.getValue(t),r=parseInt(o.width,10),i=parseInt(o.height,10),u=(n=r,e=i,function(t){return NS(t,n,e)});g(a,u)})},!1,!0)],S=yv.sketch({dom:s,components:w.map(function(t){return t.asSpec()}),containerBehaviours:Fa([_g("image-tools-resize-buttons-events",[Ni(sk.disable(),function(t){u(w,t)}),Ni(sk.enable(),function(t){a(w,t)})])])}),k=function(n,e){return function(t){return n(t,e)}},C=k(RS,"h"),O=k(RS,"v"),T=k(PS,-90),E=k(PS,90),B=function(t,n){var e,o;o=n,f(e=t),i(e,ik.tempTransform(),{transform:o}),l(e)},A=[p(),h(),n("flip-horizontally","Flip horizontally",function(t){B(t,C)},!1),n("flip-vertically","Flip vertically",function(t){B(t,O)},!1),n("rotate-left","Rotate counterclockwise",function(t){B(t,T)},!1),n("rotate-right","Rotate clockwise",function(t){B(t,E)},!1),h(),v()],D=yv.sketch({dom:s,components:A.map(function(t){return t.asSpec()}),containerBehaviours:Fa([_g("image-tools-fliprotate-buttons-events",[Ni(sk.disable(),function(t){u(A,t)}),Ni(sk.enable(),function(t){a(A,t)})])])}),_=function(t,n,e,o,r){var i=Rw.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:c.translate(t)}}),u=Rw.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),a=Rw.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Kg(Rw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:e,maxX:r,getInitialValue:Z({x:Z(o)})},components:[i,u,a],sliderBehaviours:Fa([dg.config({})]),onChoose:n}))},M=function(t,n,e,o,r){return[p(),(i=t,u=n,a=e,c=o,s=r,_(i,function(t,n,e){var o=k(u,e.x()/100);d(t,o)},a,c,s)),v()];var i,u,a,c,s},F=function(t,n,e,o,r){var i=M(t,n,e,o,r);return yv.sketch({dom:s,components:i.map(function(t){return t.asSpec()}),containerBehaviours:Fa([_g("image-tools-filter-panel-buttons-events",[Ni(sk.disable(),function(t){u(i,t)}),Ni(sk.enable(),function(t){a(i,t)})])])})},I=[p(),h(),v()],V=yv.sketch({dom:s,components:I.map(function(t){return t.asSpec()})}),R=F("Brightness",MS,-100,0,100),H=F("Contrast",FS,-100,0,100),N=F("Gamma",VS,-100,0,100),P=function(t){return _(t,function(f){var t=z.getOpt(f),n=j.getOpt(f),e=L.getOpt(f);t.each(function(s){n.each(function(c){e.each(function(t){var n,e,o,r=ag.getValue(s).x()/100,i=ag.getValue(t).x()/100,u=ag.getValue(c).x()/100,a=(n=r,e=i,o=u,function(t){return IS(t,n,e,o)});d(f,a)})})})},0,100,200)},z=P("R"),L=P("G"),j=P("B"),U=[p(),z,L,j,v()],W=yv.sketch({dom:s,components:U.map(function(t){return t.asSpec()})}),G=function(n,e,o){return function(t){i(t,ik.swap(),{transform:e,swap:function(){$.getOpt(t).each(function(t){qm.set(t,[n]),o(t)})}})}},X=tt.some(_S),Y=tt.some(DS),q=[n("crop","Crop",G(y,e,function(){r.showCrop()}),!1),n("resize","Resize",G(S,e,function(t){x.getOpt(t).each(function(t){var n=r.getMeasurements(),e=n.width,o=n.height;ag.setValue(t,{width:e,height:o})})}),!1),n("orientation","Orientation",G(D,e,o),!1),n("brightness","Brightness",G(R,e,o),!1),n("sharpen","Sharpen",G(V,X,o),!1),n("contrast","Contrast",G(H,e,o),!1),n("color-levels","Color levels",G(W,e,o),!1),n("gamma","Gamma",G(N,e,o),!1),n("invert","Invert",G(V,Y,o),!1)],K=yv.sketch({dom:s,components:q.map(function(t){return t.asSpec()})}),J=yv.sketch({dom:{tag:"div"},components:[K],containerBehaviours:Fa([qm.config({})])}),$=Kg(J);return{memContainer:$,getApplyButton:function(t){return $.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})}}},lk=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),dk=tinymce.util.Tools.resolve("tinymce.geom.Rect"),mk=tinymce.util.Tools.resolve("tinymce.util.Observable"),gk=tinymce.util.Tools.resolve("tinymce.util.Tools"),pk=tinymce.util.Tools.resolve("tinymce.util.VK"),hk=0,vk=function(n){var f=Kg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),l=an(1),d=an(tt.none()),m=an({x:0,y:0,w:1,h:1}),c=an({x:0,y:0,w:1,h:1}),s=function(t,s){g.getOpt(t).each(function(t){var e=l.get(),o=Ja(t.element()),r=Za(t.element()),i=s.dom().naturalWidth*e,u=s.dom().naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),n={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};Lu(s,n),f.getOpt(t).each(function(t){Lu(t.element(),n)}),d.get().each(function(t){var n=m.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})})})},e=function(t,n){var e,a=Be.fromTag("img");return vo(a,"src",n),(e=a.dom(),new ip(function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})).then(function(){return g.getOpt(t).map(function(t){var n=ra({element:a});qm.replaceAt(t,1,tt.some(n));var e=c.get(),o={x:0,y:0,w:a.dom().naturalWidth,h:a.dom().naturalHeight};c.set(o);var r,u,i=dk.inflate(o,-20,-20);return m.set(i),e.w===o.w&&e.h===o.h||(r=t,u=a,g.getOpt(r).each(function(t){var n=Ja(t.element()),e=Za(t.element()),o=u.dom().naturalWidth,r=u.dom().naturalHeight,i=Math.min(n/o,e/r);1<=i?l.set(1):l.set(i)})),s(t,a),a})})},t=yv.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[f.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:Fa([_g("image-panel-crop-events",[Yi(function(t){g.getOpt(t).each(function(t){var n=function S(s,e,f,o,r){function l(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}function u(t,n,e,o){var r,i,u,a,c;r=n.x,i=n.y,u=n.w,a=n.h,r+=e*t.deltaX,i+=o*t.deltaY,(u+=e*t.deltaW)<20&&(u=20),(a+=o*t.deltaH)<20&&(a=20),c=s=dk.clamp({x:r,y:i,w:u,h:a},f,"move"===t.name),c=l(f,c),m.fire("updateRect",{rect:c}),d(c)}function n(n){function t(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),lk("#"+h+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}gk.each(a,function(t){lk("#"+h+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})}),t("top",{x:e.x,y:e.y,w:e.w,h:n.y-e.y}),t("right",{x:n.x+n.w,y:n.y,w:e.w-n.x-n.w+e.x,h:n.h}),t("bottom",{x:e.x,y:n.y+n.h,w:e.w,h:e.h-n.y-n.h+e.y}),t("left",{x:e.x,y:n.y,w:n.x-e.x,h:n.h}),t("move",n)}function i(t){n(s=t)}function d(t){i(function e(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}}(f,t))}var m,a,c,g,p="tox-",h="tox-crid-"+hk++;return a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],g=["top","right","bottom","left"],function v(){lk('<div id="'+h+'" class="'+p+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),gk.each(g,function(t){lk("#"+h,o).append('<div id="'+h+"-"+t+'"class="'+p+'croprect-block" style="display: none" data-mce-bogus="all">')}),gk.each(a,function(t){lk("#"+h,o).append('<div id="'+h+"-"+t.name+'" class="'+p+"croprect-handle "+p+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),c=gk.map(a,function t(n){var e;return new D(h,{document:o.ownerDocument,handle:h+"-"+n.name,start:function(){e=s},drag:function(t){u(n,e,t.deltaX,t.deltaY)}})}),n(s),lk(o).on("focusin focusout",function(t){lk(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),lk(o).on("keydown",function(n){function t(t,n,e,o,r){t.stopPropagation(),t.preventDefault(),u(i,e,o,r)}var i;switch(gk.each(a,function(t){if(n.target.id===h+"-"+t.name)return i=t,!1}),n.keyCode){case pk.LEFT:t(n,0,s,-10,0);break;case pk.RIGHT:t(n,0,s,10,0);break;case pk.UP:t(n,0,s,0,-10);break;case pk.DOWN:t(n,0,s,0,10);break;case pk.ENTER:case pk.SPACEBAR:n.preventDefault(),r()}})}(),m=gk.extend({toggleVisibility:function b(t){var n;n=gk.map(a,function(t){return"#"+h+"-"+t.name}).concat(gk.map(g,function(t){return"#"+h+"-"+t})).join(","),t?lk(n,o).show():lk(n,o).hide()},setClampRect:function y(t){f=t,n(s)},setRect:i,getInnerRect:function t(){return l(f,s)},setInnerRect:d,setViewPortRect:function x(t){e=t,n(s)},destroy:function w(){gk.each(c,function(t){t.destroy()}),c=[]}},mk)}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t.element().dom(),function(){});n.toggleVisibility(!1),n.on("updateRect",function(t){var n=t.rect,e=l.get(),o={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};m.set(o)}),d.set(tt.some(n))})})])])}],containerBehaviours:Fa([qm.config({}),_g("image-panel-events",[Yi(function(t){e(t,n)})])])}),g=Kg(t);return{memContainer:g,updateSrc:e,zoom:function(t,n){var e=l.get(),o=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);l.set(o),g.getOpt(t).each(function(t){var n=t.components()[1].element();s(t,n)})},showCrop:function(){d.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){d.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return m.get()},getMeasurements:function(){var t=c.get();return{width:t.w,height:t.h}}}},bk=function(t,n,e,o,r){return XS({name:t,icon:tt.some(n),disabled:e,tooltip:tt.some(t)},o,r)},yk=function(t,n){n?ah.enable(t):ah.disable(t)},xk=function(t){var o=Kg(bk("Undo","undo",!0,function(t){Si(t,ik.undo(),{direction:1})},t)),r=Kg(bk("Redo","redo",!0,function(t){Si(t,ik.redo(),{direction:1})},t));return{container:yv.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),r.asSpec(),bk("Zoom in","zoom-in",!1,function(t){Si(t,ik.zoom(),{direction:1})},t),bk("Zoom out","zoom-out",!1,function(t){Si(t,ik.zoom(),{direction:-1})},t)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){yk(t,n)}),r.getOpt(t).each(function(t){yk(t,e)})}}},wk=function(){return He.getOrDie("URL")},Sk=function(t){return wk().createObjectURL(t)},kk=function(t){wk().revokeObjectURL(t)},Ck=function(t){var n=an(t),e=an(tt.none()),o=function s(){function t(){return 0<o}function n(){return-1!==o&&o<e.length-1}var e=[],o=-1;return{data:e,add:function r(t){var n;return n=e.splice(++o),e.push(t),{state:t,removed:n}},undo:function i(){if(t())return e[--o]},redo:function u(){if(n())return e[++o]},canUndo:t,canRedo:n}}();o.add(t);var r=function(t){n.set(t)},i=function(t){return{blob:t,url:Sk(t)}},u=function(t){kk(t.url)},a=function(){e.get().each(u),e.set(tt.none())},c=function(t){var n,e=i(t);return r(e),n=o.add(e).removed,gk.each(n,u),e.url};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().fold(function(){return n.get()},function(t){return t})},updateTempState:function(t){var n=i(t);return a(),e.set(tt.some(n)),n.url},addTempState:function(t){var n=i(t);return e.set(tt.some(n)),n.url},applyTempState:function(n){return e.get().fold(function(){},function(t){c(t.blob),n()})},destroyTempState:a,undo:function(){var t=o.undo();return r(t),t.url},redo:function(){var t=o.redo();return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},Ok=function(t,n){var u=Ck(t.currentState),i=function(t){var n=u.getHistoryStates();g.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Si(t,sk.formActionEvent,{name:sk.saveState(),value:n.undoEnabled})},a=function(t){return t.toBlob()},c=function(t){Si(t,sk.formActionEvent,{name:sk.disable(),value:{}})},s=function(t){e.getApplyButton(t).each(function(t){ah.enable(t)}),Si(t,sk.formActionEvent,{name:sk.enable(),value:{}})},f=function(t,n){return c(t),r.updateSrc(t,n)},l=function(n,t,e,o,r){return c(n),kS(t).then(e).then(a).then(o).then(function(t){return f(n,t).then(function(t){return i(n),r(),s(n),t})})["catch"](function(t){x.console.log(t),s(n)})},d=function(t,n,e){var o=u.getBlobState().blob;l(t,o,n,function(t){return u.updateTempState(t)},e)},m=function(t){var n=u.getBlobState().url;return u.destroyTempState(),i(t),n},r=vk(t.currentState.url),g=xk(n),e=fk(r,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[e.memContainer.asSpec(),r.memContainer.asSpec(),g.container],behaviours:Fa([ag.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),_g("image-tools-events",[Ni(ik.undo(),function(t){var n=u.undo();f(t,n).then(function(){s(t),i(t)})}),Ni(ik.redo(),function(t){var n=u.redo();f(t,n).then(function(){s(t),i(t)})}),Ni(ik.zoom(),function(t,n){var e=n.event().direction();r.zoom(t,e)}),Ni(ik.back(),function(t,n){var e,o;o=m(e=t),f(e,o).then(function(){s(e)}),n.event().swap()(),r.hideCrop()}),Ni(ik.apply(),function(t,n){u.applyTempState(function(){m(t),n.event().swap()()})}),Ni(ik.transform(),function(t,n){return d(t,n.event().transform(),Q)}),Ni(ik.tempTransform(),function(t,n){return e=t,o=n.event().transform(),r=u.getTempState().blob,void l(e,r,o,function(t){return u.addTempState(t)},Q);var e,o,r}),Ni(ik.transformApply(),function(t,n){return e=t,o=n.event().transform(),r=n.event().swap(),i=u.getBlobState().blob,void l(e,i,o,function(t){var n=u.addBlobState(t);return m(e),n},r);var e,o,r,i}),Ni(ik.swap(),function(n,t){var e;e=n,g.updateButtonUndoStates(e,!1,!1);var o=t.event().transform(),r=t.event().swap();o.fold(function(){r()},function(t){d(n,t,r)})})]),Kw()])}},Tk=Dl({name:"HtmlSelect",configFields:[Kr("options"),Bf("selectBehaviours",[dg,ag]),si("selectClasses",[]),si("selectAttributes",{}),oi("data")],factory:function(e){var t=st(e.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),n=e.data.map(function(t){return en("initialValue",t)}).getOr({});return{uid:e.uid,dom:{tag:"select",classes:e.selectClasses,attributes:e.selectAttributes},components:t,behaviours:Df(e.selectBehaviours,[dg.config({}),ag.config({store:Ho({mode:"manual",getValue:function(t){return Ku(t.element())},setValue:function(t,n){ht(e.options,function(t){return t.value===n}).isSome()&&Ju(t.element(),n)}},n)})])}}}),Ek=function(n,e){var t=n.label.map(function(t){return Ab(t,e)}),o=[Um.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(t){return wi(t,Vv),tt.some(!0)}}),_g("textfield-change",[Ni(On(),function(t){Si(t,_v,{name:n.name})}),Ni(ue(),function(t){Si(t,_v,{name:n.name})})]),Zb.config({})],r=n.validation.map(function(o){return Jb.config({getRoot:function(t){return Je(t.element())},invalidClass:"tox-invalid",validator:{validate:function(t){var n=ag.getValue(t),e=o.validator(n);return tb.pure(!0===e?Xt.value(n):Xt.error(e))},validateOnLoad:o.validateOnLoad}})}).toArray(),i=jv.parts().field({tag:!0===n.multiline?"textarea":"input",inputAttributes:n.placeholder.fold(function(){},function(t){return{placeholder:e.translate(t)}}),inputClasses:[n.classname],
inputBehaviours:Fa(xt([o,r])),selectOnFocus:!1,factory:Rb}),u=n.flex?["tox-form__group--stretched"]:[];return Ob(t,i,u)},Bk=function(i){return Ho({},i,{toCached:function(){return Bk(i.toCached())},bindFuture:function(n){return Bk(i.bind(function(t){return t.fold(function(t){return tb.pure(Xt.error(t))},function(t){return n(t)})}))},bindResult:function(n){return Bk(i.map(function(t){return t.bind(n)}))},mapResult:function(n){return Bk(i.map(function(t){return t.map(n)}))},mapError:function(n){return Bk(i.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return i.map(function(t){return t.fold(n,e)})},withTimeout:function(t,r){return Bk(tb.nu(function(n){var e=!1,o=x.setTimeout(function(){e=!0,n(Xt.error(r()))},t);i.get(function(t){e||(x.clearTimeout(o),n(t))})}))}})},Ak=function(t){return Bk(tb.nu(t))},Dk={type:"separator"},_k=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},Mk=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:undefined},onAction:function(){}}},Fk=function(t,n){return o=t,e=mt(n,function(t){return t.type===o}),st(e,_k);var e,o},Ik=function(t,n){var e=t.toLowerCase();return mt(n,function(t){var n=t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.text;return Kn(n.toLowerCase(),e)||Kn(t.value.toLowerCase(),e)})},Vk=function(c,t,s){var n=ag.getValue(t),f=n.meta.text!==undefined?n.meta.text:n.value;return s.getLinkInformation().fold(function(){return[]},function(t){var n,e,o,r,i,u,a=Ik(f,(n=s.getHistory(c),st(n,function(t){return Mk(t,t)})));return"file"===c?(e=[a,Ik(f,(u=t,Fk("header",u.targets))),Ik(f,xt([(i=t,tt.from(i.anchorTop).map(function(t){return Mk("<top>",t)}).toArray()),(r=t,Fk("anchor",r.targets)),(o=t,tt.from(o.anchorBottom).map(function(t){return Mk("<bottom>",t)}).toArray())]))],pt(e,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(Dk,n)},[])):a})},Rk=function(i,u,o){var t,n=function(t){var n=ag.getValue(t);o.addToHistory(n.value,i.filetype)},e=jv.parts().field({factory:Cb,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],minChars:0,responseTime:0,fetch:function(t){var n=Vk(i.filetype,t,o),e=Vb(n,hh.BUBBLE_TO_SANDBOX,u.providers);return tb.pure(e)},getHotspot:function(t){return l.getOpt(t)},onSetValue:function(t){t.hasConfigured(Jb)&&Jb.run(t).get(Q)},typeaheadBehaviours:Fa(xt([o.getValidationHandler().map(function(o){return Jb.config({getRoot:function(t){return Je(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{},validator:{validate:function(n){var e=ag.getValue(n);return Ak(function(t){o({type:i.filetype,url:e.value},function(e){l.getOpt(n).each(function(t){var n=function(t,n,e){(e?Mu:Fu)(t.element(),n)};n(t,"tox-control-wrap--status-valid","valid"===e.status),n(t,"tox-control-wrap--status-unknown","unknown"===e.status)}),t(("invalid"===e.status?Xt.error:Xt.value)(e.message))})})},validateOnLoad:!1}})}).toArray(),[Zb.config({}),_g("urlinput-events",xt(["file"===i.filetype?[Ni(On(),function(t){Si(t,_v,{name:i.name})})]:[],[Ni(Tn(),function(t){Si(t,_v,{name:i.name}),n(t)}),Ni(ue(),function(t){Si(t,_v,{name:i.name}),n(t)})]]))]])),eventOrder:(t={},t[On()]=["streaming","urlinput-events","invalidating"],t),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"dog"},lazySink:u.getSink,parts:{menu:Rh(0,0,"normal")},onExecute:function(t,n){Si(n,Vv,{})},onItemExecute:function(t){n(t),Si(t,_v,{name:i.name})}}),r=i.label.map(function(t){return Ab(t,u.providers)}),a=function(t,n,e){return void 0===n&&(n=t),void 0===e&&(e=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:$g(n,u.providers.icons),attributes:{title:u.providers.translate(e)}}}},c=Kg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[a("valid","checkmark","valid"),a("unknown","warning"),a("invalid","warning")]}),s=o.getUrlPicker(i.filetype),f=Vo("browser.url.event"),l=Kg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[e,c.asSpec()]});return jv.sketch({dom:Bb([]),components:r.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:xt([[l.asSpec()],s.map(function(){return t=i.label,n=f,e="tox-browse-url",o="browse",r=u.providers,qg.sketch({dom:{tag:"button",classes:["tox-tbtn",e],innerHtml:$g(o,r.icons),attributes:{title:r.translate(t.getOr(""))}},buttonBehaviours:Fa([Zb.config({})]),action:function(t){wi(t,n)}});var t,n,e,o,r}).toArray()])}]),fieldBehaviours:Fa([_g("url-input-events",[Ni(f,function(o){Vl.getCurrent(o).each(function(n){var e=ag.getValue(n);s.each(function(t){t(e).get(function(t){ag.setValue(n,t),Si(o,_v,{name:i.name})})})})})])])})},Hk=function(u,n){var t,e,o=u.label.map(function(t){return Ab(t,n)}),r=function(e){return function(n,t){la(t.event().target(),"[data-collection-item-value]").each(function(t){e(n,t,yo(t,"data-collection-item-value"))})}},i=[Ni(xn(),r(function(t,n){ud(n)})),Ni(le(),r(function(t,n,e){Si(t,Iv,{name:u.name,value:e})})),Ni(wn(),r(function(t,n){fa(t.element(),"."+Np).each(function(t){Fu(t,Np)}),Mu(n,Np)})),Ni(Sn(),r(function(t){fa(t.element(),"."+Np).each(function(t){Fu(t,Np)})})),Ji(r(function(t,n,e){Si(t,Iv,{name:u.name,value:e})}))],a=jv.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==u.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:U},behaviours:Fa([qm.config({}),ag.config({store:{mode:"memory",initialValue:[]},onSetValue:function(o,t){var n,e,r,i;n=o,e=st(t,function(t){var n,e=1===u.columns?'<div class="tox-collection__item-label">'+t.text+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",r={_:" "," - ":" ","-":" "},i=t.text.replace(/\_| \- |\-/g,function(t){return r[t]});return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+('"'===(n=t.value)?"&quot;":n)+'" title="'+i+'" aria-label="'+i+'">'+o+e+"</div>"}),r=1<u.columns&&"auto"!==u.columns?ct(e,u.columns):[e],i=st(r,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}),co(n.element(),i.join("")),"auto"===u.columns&&bp(o,5,"tox-collection__item").each(function(t){var n=t.numRows,e=t.numColumns;Um.setGridSize(o,n,e)}),wi(o,Pv)}}),Zb.config({}),Um.config((t=u.columns,e="normal",1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===e?".tox-swatches__row":".tox-collection__group",cell:"color"===e?"."+Fp:"."+Mp}})),_g("collection-events",i)])});return Ob(o,a,["tox-form__group--collection"])},Nk=function(r){return function(n,e,o){return nn(e,"name").fold(function(){return r(e,o)},function(t){return n.field(t,r(e,o))})}},Pk={bar:Nk(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar"]},components:st(e.items,o.interpreter)};var e,o}),collection:Nk(function(t,n){return Hk(t,n.shared.providers)}),alloy:Nk(U),alertbanner:Nk(function(t,n){return e=t,o=n.shared.providers,yv.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[qg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:$g(e.icon,o.icons),attributes:{title:o.translate(e.actionLabel)}},action:function(t){Si(t,Iv,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o}),input:Nk(function(t,n){return e=t,o=n.shared.providers,Ek({name:e.name,multiline:!1,label:e.label,placeholder:e.placeholder,flex:!1,classname:"tox-textfield",validation:tt.none()},o);var e,o}),textarea:Nk(function(t,n){return e=t,o=n.shared.providers,Ek({name:e.name,multiline:!0,label:e.label,placeholder:e.placeholder,flex:!0,classname:"tox-textarea",validation:tt.none()},o);var e,o}),listbox:Nk(function(t,n){return e=t,o=n.shared.providers,r=Ab(e.label,o),i=jv.parts().field({factory:Tk,dom:{classes:["mce-select-field"]},selectBehaviours:Fa([Zb.config({})]),options:e.values,data:e.initialValue.getOr(undefined)}),Tb(tt.some(r),i);var e,o,r,i}),label:Nk(function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=st(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:Fa([Kw(),qm.config({}),iS(tt.none()),Um.config({mode:"acyclic"})])};var e,o,r,i}),iframe:(ob=function(t,n){return hS(t,n.shared.providers)},function(t,n,e){var o=Jt(n,{source:"dynamic"});return Nk(ob)(t,o,e)}),autocomplete:Nk(function(t,n){return r=t,i=n.shared,e=Ab(r.label.getOr("?"),i.providers),o=jv.parts().field({factory:Cb,dismissOnBlur:!1,inputClasses:["tox-textfield"],minChars:1,fetch:function(t){var n=ag.getValue(t),e=r.getItems(n),o=Vb(e,hh.BUBBLE_TO_SANDBOX,i.providers);return tb.pure(o)},markers:{openClass:"dog"},lazySink:i.getSink,parts:{menu:Rh(0,0,"normal")}}),Tb(tt.some(e),o);var r,i,e,o}),button:Nk(function(t,n){return e=t,o=n.shared.providers,r=qS(e.name,"custom"),YS(e,r,o,[uS(""),Kw()]);var e,o,r}),checkbox:Nk(function(t,n){return e=t,o=n.shared.providers,r=ag.config({store:{mode:"manual",getValue:function(t){return t.element().dom().checked},setValue:function(t,n){t.element().dom().checked=n}}}),i=function(t){return t.element().dom().click(),tt.some(!0)},u=jv.parts().field({factory:{sketch:U},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Fa([Kw(),Zb.config({}),dg.config({}),r,Um.config({mode:"special",onEnter:i,onSpace:i,stopSpaceKeyup:!0}),_g("checkbox-events",[Ni(Tn(),function(t){Si(t,_v,{name:e.name})})])])}),a=jv.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:Fa([Uy.config({})])}),s=Kg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(c=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:$g("checked"===t?"selected":"unselected",o.icons)}}})("checked"),c("unchecked")]}),jv.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[u,s.asSpec(),a]});var e,o,r,i,u,a,c,s}),colorinput:Nk(function(t,n){return Yy(t,n.shared,n.colorinput)}),colorpicker:Nk(function(){var t=function(t){return"tox-"+t},n=qw(Zw,t),r=Kg(n.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){Si(t,Iv,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Si(t,Iv,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[r.asSpec()],behaviours:Fa([ag.config({store:{mode:"manual",getValue:function(t){var n=r.get(t);return Vl.getCurrent(n).bind(function(t){return ag.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),o=r.get(t);Vl.getCurrent(o).fold(function(){x.console.log("Can not find form")},function(t){ag.setValue(t,{hex:tt.from(e[1]).getOr("")}),Lw.getField(t,"hex").each(function(t){wi(t,On())})})}}}),Kw()])}}),dropzone:Nk(function(t,n){return aS(t,n.shared.providers)}),grid:Nk(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:st(e.items,o.interpreter)};var e,o}),selectbox:Nk(function(t,n){return e=t,o=n.shared.providers,r=st(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),i=e.label.map(function(t){return Ab(t,o)}),u=jv.parts().field({dom:{},selectAttributes:{size:e.size},options:r,factory:Tk,selectBehaviours:Fa([Zb.config({}),_g("selectbox-change",[Ni(Tn(),function(t){Si(t,_v,{name:e.name})})])])}),a=1<e.size?tt.none():tt.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:$g("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:xt([[u],a.toArray()])},jv.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:xt([i.toArray(),[c]])});var e,o,r,i,u,a,c}),sizeinput:Nk(function(t,n){return rk(t,n.shared.providers)}),urlinput:Nk(function(t,n){return Rk(t,n.shared,n.urlinput)}),customeditor:Nk(function(n){var e=an(tt.none()),o=Kg({dom:{tag:n.tag}}),r=an(tt.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Fa([_g("editor-foo-events",[Yi(function(t){o.getOpt(t).each(function(t){n.init(t.element().dom()).then(function(n){r.get().each(function(t){n.setValue(t)}),r.set(tt.none()),e.set(tt.some(n))})})})]),ag.config({store:{mode:"manual",getValue:function(){return e.get().fold(function(){return r.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,n){e.get().fold(function(){r.set(tt.some(n))},function(t){return t.setValue(n)})}}}),Kw()]),components:[o.asSpec()]}}),htmlpanel:Nk(function(t){return"presentation"===t.presets?yv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):yv.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Fa([Zb.config({}),dg.config({})])})}),imagetools:Nk(function(t,n){return Ok(t,n.shared.providers)}),table:Nk(function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:st(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:st(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:st(r,c)})],behaviours:Fa([Zb.config({}),dg.config({})])};var e,o,r,i,u,a,c})},zk={field:function(t,n){return n}},Lk=function(n,t,e){var o=Jt(e,{shared:{interpreter:function(t){return jk(n,t,o)}}});return jk(n,t,o)},jk=function(n,e,o){return nn(Pk,e.type).fold(function(){return x.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e},function(t){return t(n,e,o)})},Uk=function(t){return t.y()},Wk=function(t,n,e){return Pc(t.x(),Uk(t),e.northeast(),uc(),"layout-ne")},Gk=function(t,n,e){return Pc((r=n,(o=t).x()+o.width()-r.width()),Uk(t),e.northwest(),ac(),"layout-nw");var o,r},Xk=function(t,n,e){return Pc((r=n,(o=t).x()+o.width()/2-r.width()/2),Uk(t),e.north(),sc(),"layout-n");var o,r},Yk={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},qk=function(t,n,e){var o,r,i,u,a,c,s,f,l,d,m=Dv(t),g=function(){return Be.fromDom(t.getBody())};return{toolbar:(f=g,l=n,d=m,d?function(){return{anchor:"node",root:f(),node:tt.from(f()),bubble:Hc(-12,-12,Yk),layouts:{onRtl:function(){return[Wk]},onLtr:function(){return[Gk]}}}}:function(){return{anchor:"hotspot",hotspot:l(),bubble:Hc(-12,12,Yk),layouts:{onRtl:function(){return[Xc]},onLtr:function(){return[Yc]}}}}),toolbarOverflow:(s=e,function(){return{anchor:"hotspot",hotspot:s(),layouts:{onRtl:function(){return[Xc]},onLtr:function(){return[Yc]}}}}),banner:(u=g,a=n,c=e,c?function(){return{anchor:"node",root:u(),node:tt.from(u()),layouts:{onRtl:function(){return[Xk]},onLtr:function(){return[Xk]}}}}:function(){return{anchor:"hotspot",hotspot:a(),layouts:{onRtl:function(){return[$c]},onLtr:function(){return[$c]}}}}),cursor:(r=t,i=g,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return tt.some(fs(Be.fromDom(t.startContainer),t.startOffset,Be.fromDom(t.endContainer),t.endOffset))}}}),node:(o=g,function(t){return{anchor:"node",root:o(),node:t}})}},Kk=function(t){return{colorPicker:(o=t,function(t,n){Py.colorPickerDialog(o)(t,n)}),hasCustomColors:(e=t,function(){return Ey(e)}),getColors:(n=t,function(){return By(n)})};var n,e,o},Jk=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],$k=function(t){return pt(t,function(t,n){if(zt(n,"items")){var e=$k(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(zt(n,"inline")||zt(n,"block")||zt(n,"selector")){var o="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return Ho({},t,{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},Qk=function(i){return(t=i,tt.from(t.getParam("style_formats")).filter($)).map(function(t){var n,e,o,r=(n=i,e=$k(t),o=function(t){ft(t,function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)})},n.formatter?o(e.customFormats):n.on("init",function(){o(e.customFormats)}),e.formats);return i.getParam("style_formats_merge",!1,"boolean")?Jk.concat(r):r}).getOr(Jk);var t},Zk=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return Jt(t,o)},tC=function(s,t,f,l){var d=function(t){return st(t,function(t){var n,e,o,r,i,u,a=_t(t);if(un(t,"items")){var c=d(t.items);return Jt((i=t,u={type:"submenu",isSelected:Z(!1),getStylePreview:function(){return tt.none()}},Jt(i,u)),{getStyleItems:function(){return c}})}return un(t,"format")?Zk(t,f,l):1===a.length&&ut(a,"title")?Jt(t,{type:"separator"}):(o={type:"formatter",format:e=Vo((n=t).title),isSelected:f(e),getStylePreview:l(e)},r=Jt(n,o),s.formatter.register(e,r),r)})};return d(t)},nC=gk.trim,eC=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},oC=eC("true"),rC=eC("false"),iC=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},uC=function(t){return t.innerText||t.textContent},aC=function(t){return(n=t)&&"A"===n.nodeName&&(n.id||n.name)!==undefined&&sC(t);var n},cC=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},sC=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return oC(t)}return!1}(t)&&!rC(t)},fC=function(t){return cC(t)&&sC(t)},lC=function(t){var n,e,o=(n=t).id?n.id:Vo("h");return iC("header",uC(t),"#"+o,cC(e=t)?parseInt(e.nodeName.substr(1),10):0,function(){t.id=o})},dC=function(t){var n=t.id||t.name,e=uC(t);return iC("anchor",e||"#"+n,"#"+n,0,Q)},mC=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,st(ws(Be.fromDom(e),n),function(t){return t.dom()})},gC=function(t){return 0<nC(t.title).length},pC=function(t){var n,e=mC(t);return mt((n=e,st(mt(n,fC),lC)).concat(st(mt(e,aC),dC)),gC)},hC="tinymce-url-history",vC=function(t){return K(t)&&/^https?/.test(t)},bC=function(t){return J(t)&&Ht(t,function(t){return!($(n=t)&&n.length<=5&&St(n,vC));var n}).isNone()},yC=function(){var t,n=x.localStorage.getItem(hC);if(null===n)return{};try{t=JSON.parse(n)}catch(M){if(M instanceof SyntaxError)return x.console.log("Local storage "+hC+" was not valid JSON",M),{};throw M}return bC(t)?t:(x.console.log("Local storage "+hC+" was not valid format",t),{})},xC=function(t){var n=yC();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},wC=function(n,t){if(vC(n)){var e=yC(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=mt(o,function(t){return t!==n});e[t]=[n].concat(r).slice(0,5),function(t){if(!bC(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));x.localStorage.setItem(hC,JSON.stringify(t))}(e)}},SC=Object.prototype.hasOwnProperty,kC=function(t){return!!t},CC=function(t){return It(gk.makeMap(t,/[, ]/),kC)},OC=function(t,n,e){var o,r,i=(o=t,r=n,SC.call(o,r)?tt.some(o[r]):tt.none()).getOr(e);return K(i)?tt.some(i):tt.none()},TC=function(t){return tt.some(t.file_picker_callback).filter(et)},EC=function(t,n){var e,o,r,i,u=(e=t,o=tt.some(e.file_picker_types).filter(kC),r=tt.some(e.file_browser_callback_types).filter(kC),i=o.or(r).map(CC),TC(e).fold(function(){return!1},function(){return i.fold(function(){return!0},function(t){return 0<_t(t).length&&t})}));return nt(u)?u?TC(t):tt.none():u[n]?TC(t):tt.none()},BC=function(n){return{getHistory:xC,addToHistory:wC,getLinkInformation:function(){return!1===(t=n).settings.typeahead_urls?tt.none():tt.some({targets:pC(t.getBody()),anchorTop:OC(t.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:OC(t.settings,"anchor_bottom","#bottom").getOrUndefined()});var t},getValidationHandler:function(){return t=n.settings.filepicker_validator_handler,et(t)?tt.some(t):tt.none();var t},getUrlPicker:function(t){return i=t,EC((r=n).settings,i).map(function(o){return function(n){return tb.nu(function(e){var t=gk.extend({filetype:i},tt.from(n.meta).getOr({}));o.call(r,function(t,n){if(!K(t))throw new Error("Expected value to be string");if(n!==undefined&&!J(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})},n.value,t)})}});var r,i}}},AC=function(t,n,e,o){var r,i,u,a,c,s,f,l,d,m={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Dp.translate},interpreter:function(t){return jk(zk,t,m)},anchors:qk(n,e,o),getSink:function(){return Xt.value(t)}},urlinput:BC(n),styleselect:(r=n,i=function(t){return function(){return r.formatter.match(t)}},u=function(n){return function(){var t=r.formatter.get(n);return t!==undefined?tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:r.formatter.getCssText(n)}):tt.none()}},a=function(t){var n=t.items;return n!==undefined&&0<n.length?wt(n,a):[t.format]},c=an([]),s=an([]),f=an([]),l=an([]),d=an(!1),r.on("init",function(){var t=Qk(r),n=tC(r,t,i,u);c.set(n),s.set(wt(n,a))}),r.on("addStyleModifications",function(t){var n=tC(r,t.items,i,u);f.set(n),d.set(t.replace),l.set(wt(n,a))}),{getData:function(){var t=d.get()?[]:c.get(),n=f.get();return t.concat(n)},getFlattenedKeys:function(){var t=d.get()?[]:s.get(),n=l.get();return t.concat(n)}}),colorinput:Kk(n)};return m},DC=Ae("within","extra","withinWidth"),_C=function(t,n,o){var e,r=(e=function(t,n){var e=o(t);return tt.some({element:Z(t),start:Z(n),finish:Z(n+e),width:Z(e)})},pt(t,function(n,t){return e(t,n.len).fold(Z(n),function(t){return{len:t.finish(),list:n.list.concat([t])}})},{len:0,list:[]}).list),i=mt(r,function(t){return t.finish()<=n}),u=gt(i,function(t,n){return t+n.width()},0),a=r.slice(i.length);return{within:Z(i),extra:Z(a),withinWidth:Z(u)}},MC=function(t){return st(t,function(t){return t.element()})},FC=function(t,n,e,o){var r,i,u,a,c,s,f,l,d,m,g,p,h=(r=t,i=n,u=e,a=_C(i,r,u),0===a.extra().length?tt.some(a):tt.none()).getOrThunk(function(){return _C(n,t-e(o),e)}),v=h.within(),b=h.extra(),y=h.withinWidth();return 1===b.length&&b[0].width()<=e(o)?(m=b,g=y,p=MC(v.concat(m)),DC(p,[],g)):1<=b.length?(s=b,f=o,l=y,d=MC(v).concat([f]),DC(d,MC(s),l)):(c=y,DC(MC(v),[],c))},IC=function(n,t){return t.getAnimationRoot.fold(function(){return n.element()},function(t){return t(n)})},VC=function(t){return t.dimension.property},RC=function(t,n){return t.dimension.getDimension(n)},HC=function(t,n){var e=IC(t,n);Ru(e,[n.shrinkingClass,n.growingClass])},NC=function(t,n){Fu(t.element(),n.openClass),Mu(t.element(),n.closedClass),zu(t.element(),VC(n),"0px"),qu(t.element())},PC=function(t,n){Fu(t.element(),n.closedClass),Mu(t.element(),n.openClass),Yu(t.element(),VC(n))},zC=function(t,n,e){e.setCollapsed(),zu(t.element(),VC(n),RC(n,t.element())),qu(t.element()),HC(t,n),NC(t,n),n.onStartShrink(t),n.onShrunk(t)},LC=function(t,n,e,o){var r=o.getOrThunk(function(){return RC(n,t.element())});e.setCollapsed(),zu(t.element(),VC(n),r),qu(t.element());var i=IC(t,n);Fu(i,n.growingClass),Mu(i,n.shrinkingClass),NC(t,n),n.onStartShrink(t)},jC=function(t,n,e){var o=RC(n,t.element());("0px"===o?zC:LC)(t,n,e,tt.some(o))},UC=function(t,n,e){var o=IC(t,n),r=Iu(o,n.shrinkingClass),i=RC(n,t.element());PC(t,n);var u=RC(n,t.element());(r?function(){zu(t.element(),VC(n),i),qu(t.element())}:function(){NC(t,n)})(),Fu(o,n.shrinkingClass),Mu(o,n.growingClass),PC(t,n),zu(t.element(),VC(n),u),e.setExpanded(),n.onStartGrow(t)},WC=function(t,n){var e=IC(t,n);return!0===Iu(e,n.growingClass)},GC=function(t,n){var e=IC(t,n);return!0===Iu(e,n.shrinkingClass)},XC=Object.freeze({refresh:function(t,n,e){if(e.isExpanded()){Yu(t.element(),VC(n));var o=RC(n,t.element());zu(t.element(),VC(n),o)}},grow:function(t,n,e){e.isExpanded()||UC(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&jC(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&zC(t,n,e,tt.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:WC,isShrinking:GC,isTransitioning:function(t,n){return!0===WC(t,n)||!0===GC(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?jC:UC)(t,n,e)},disableTransitions:HC}),YC=Object.freeze({exhibit:function(t,n){var e=n.expanded;return bu(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:en(n.dimension.property,"0px")})},events:function(e,o){return Ii([Xi(Bn(),function(t,n){n.event().raw().propertyName===e.dimension.property&&(HC(t,e),o.isExpanded()&&Yu(t.element(),e.dimension.property),(o.isExpanded()?e.onGrown:e.onShrunk)(t))})])}}),qC=[Kr("closedClass"),Kr("openClass"),Kr("shrinkingClass"),Kr("growingClass"),oi("getAnimationRoot"),wa("onShrunk"),wa("onStartShrink"),wa("onGrown"),wa("onStartGrow"),si("expanded",!1),Jr("dimension",Lr("property",{width:[Oa("property","width"),Oa("getDimension",function(t){return Ja(t)+"px"})],height:[Oa("property","height"),Oa("getDimension",function(t){return Za(t)+"px"})]}))],KC=Va({fields:qC,name:"sliding",active:YC,apis:XC,state:Object.freeze({init:function(t){var n=an(t.expanded);return hu({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:v(n.set,!1),setExpanded:v(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),JC=Z([si("shell",!0),Bf("toolbarBehaviours",[qm])]),$C=Z([rl({name:"groups",overrides:function(){return{behaviours:Fa([qm.config({})])}}})]),QC=_l({name:"Toolbar",configFields:JC(),partFields:$C(),factory:function(n,t){var e=function(t){return n.shell?tt.some(t):hl(t,n,"groups")},o=n.shell?{behaviours:[qm.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:o.components,behaviours:Df(n.toolbarBehaviours,o.behaviours),apis:{setGroups:function(t,n){e(t).fold(function(){throw x.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){qm.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),ZC=Z([ya(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Bf("splitToolbarBehaviours",[]),vi("builtGroups",function(){return an([])}),si("overflow",function(){return tt.none()}),gi("floating",!1)]),tO=[Kr("dom"),si("overflow",function(){return tt.none()}),gi("floating",!1)],nO=Z([el({factory:QC,schema:tO,name:"primary"}),rl({factory:QC,schema:tO,name:"overflow",overrides:function(n){return{toolbarBehaviours:Fa([KC.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass}),Um.config({mode:"acyclic",onEscape:function(t){return hl(t,n,"overflow-button").each(Um.focusIn),tt.some(!0)}})])}}}),ol({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Fa([Cg.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"}})])}}}),ol({name:"overflow-group"})]),eO=Z([Kr("items"),ya(["itemSelector"]),Bf("tgroupBehaviours",[Um])]),oO=Z([il({name:"items",unit:"item"})]),rO=_l({name:"ToolbarGroup",configFields:eO(),partFields:oO(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Df(t.tgroupBehaviours,[Um.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),iO=function(t,n){var e=st(n,function(t){return aa(t)});QC.setGroups(t,e)},uO=function(t,e,n,o){var r=vl(t,e,"primary"),i=hl(t,e,"overflow").orThunk(function(){return e.overflow(t)});zu(r.element(),"visibility","hidden"),i.each(function(t){QC.setGroups(t,[])});var u=e.builtGroups.get(),a=rO.sketch(Ho({},n["overflow-group"](),{items:[qg.sketch(Ho({},n["overflow-button"](),{action:function(){!0===e.floating?wi(t,o):i.each(function(t){KC.toggleGrow(t)})}}))]})),c=t.getSystem().build(a);iO(r,u.concat([c]));var s=Ja(r.element()),f=FC(s,u,function(t){return Ja(t.element())},c);0===f.extra().length?(qm.remove(r,c),i.each(function(t){QC.setGroups(t,[])})):(iO(r,f.within()),i.each(function(t){iO(t,f.extra())})),Yu(r.element(),"visibility"),qu(r.element()),i.each(function(n){e.floating||KC.refresh(n),hl(t,e,"overflow-button").each(function(t){e.floating?Cg.set(t,n.getSystem().isConnected()):(Cg.set(t,KC.hasGrown(n)),Um.focusIn(n))})})},aO=_l({name:"SplitToolbar",configFields:ZC(),partFields:nO(),factory:function(o,t,n,r){var i="alloy.toolbar.toggle";return{uid:o.uid,dom:o.dom,components:t,behaviours:Df(o.splitToolbarBehaviours,[]),apis:{setGroups:function(t,n){var e;e=st(n,t.getSystem().build),o.builtGroups.set(e),uO(t,o,r,i)},refresh:function(t){uO(t,o,r,i)},getMoreButton:function(t){return hl(t,o,"overflow-button")},getOverflow:function(t){return hl(n=t,o,"overflow").orThunk(function(){return o.overflow(n)});var n}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},getMoreButton:function(t,n){return t.getMoreButton(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),cO=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:Ho({tag:"div",classes:["tox-toolbar__group"]},n),components:[rO.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Fa([Zb.config({}),dg.config({})])}},sO=function(t){return rO.sketch(cO(t))},fO=function(r,t,n){var e=Yi(function(t){var n=st(r.initGroups,sO);QC.setGroups(t,n)}),o=n.fold(function(){return[e]},function(o){return[e,Ni("alloy.toolbar.toggle",function(e){r.getSink().toOption().each(function(n){o.getOpt(n).fold(function(){var t=ua(o.asSpec());of(n,t),tf.position(n,r.backstage.shared.anchors.toolbarOverflow(),t),aO.refresh(e),aO.getMoreButton(e).each(dg.focus),Um.focusIn(t)},function(t){sf(t)})})})]});return Fa([Um.config({mode:t,onEscape:r.onEscape,selector:".tox-toolbar__group"}),_g("toolbar-events",o)])},lO=function(o){var t=o.cyclicKeying?"cyclic":"acyclic",r=Kg(QC.sketch({dom:{tag:"div",classes:["tox-toolbar__overflow"]},toolbarBehaviours:Fa([Um.config({mode:"cyclic",onEscape:function(){return wi(o.moreDrawerData.lazyToolbar(),"alloy.toolbar.toggle"),Um.focusIn(o.moreDrawerData.lazyMoreButton()),tt.some(!0)}})])})),n=aO.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=o.moreDrawerData.floating?[n]:[n,aO.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}})];return aO.sketch({uid:o.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},floating:o.moreDrawerData.floating,overflow:function(e){return o.getSink().toOption().bind(function(n){return r.getOpt(n).bind(function(t){return aO.getMoreButton(e).bind(function(){return t.getSystem().isConnected()?(tf.position(n,o.backstage.shared.anchors.toolbarOverflow(),t),tt.some(t)):tt.none()})})})},parts:{"overflow-group":cO({title:tt.none(),items:[]}),"overflow-button":GS({name:"more",icon:tt.some("more-drawer"),disabled:!1,tooltip:tt.some("More...")},tt.none(),o.backstage.shared.providers)},components:e,markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},splitToolbarBehaviours:fO(o,t,tt.some(
r))})},dO=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return QC.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"]},components:[QC.parts().groups({})],toolbarBehaviours:fO(t,n,tt.none())})},mO=[gi("disabled",!1),ui("tooltip"),ui("icon"),ui("text"),pi("onSetup",function(){return Q})],gO=Sr([$r("type"),Zr("onAction")].concat(mO)),pO=function(t){return Hr("toolbarbutton",gO,t)},hO=Sr([$r("type"),ui("tooltip"),ui("icon"),ui("text"),Zr("fetch"),pi("onSetup",function(){return Q})]),vO=function(t){return Hr("menubutton",hO,t)},bO=Sr([$r("type"),ui("tooltip"),ui("icon"),ui("text"),ai("select"),Zr("fetch"),pi("onSetup",function(){return Q}),mi("presets","normal",["normal","color","listpreview"]),si("columns",1),Zr("onAction"),Zr("onItemAction")]),yO=[gi("active",!1)].concat(mO),xO=Sr(yO.concat([$r("type"),Zr("onAction")])),wO=function(t){return Hr("ToggleButton",xO,t)},SO=[pi("predicate",function(){return!1}),mi("scope","node",["node","editor"]),mi("position","selection",["node","selection","line"])],kO=mO.concat([si("type","contextformbutton"),si("primary",!1),Zr("onAction"),vi("original",U)]),CO=yO.concat([si("type","contextformbutton"),si("primary",!1),Zr("onAction"),vi("original",U)]),OO=mO.concat([si("type","contextformbutton")]),TO=yO.concat([si("type","contextformtogglebutton")]),EO=Lr("type",{contextformbutton:kO,contextformtogglebutton:CO}),BO=Sr([si("type","contextform"),pi("initValue",function(){return""}),ui("label"),ei("commands",EO),ri("launch",Lr("type",{contextformbutton:OO,contextformtogglebutton:TO}))].concat(SO)),AO=Sr([si("type","contexttoolbar"),$r("items")].concat(SO)),DO=Vo("toolbar.button.execute"),_O={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},MO=Object.freeze({getState:function(t,n,e){return e}}),FO=Object.freeze({events:function(r,i){var o=function(e,o){r.updateState.each(function(t){var n=t(e,o);i.set(n)}),r.renderComponents.each(function(t){var n=t(o,i.get());ff(e),ft(n,function(t){of(e,e.getSystem().build(t))})})};return Ii([Ni(ae(),function(t,n){var e=r.channel;ut(n.channels(),e)&&o(t,n.data())}),Yi(function(n){r.initialData.each(function(t){o(n,t)})})])}}),IO=Object.freeze({init:function(){var n=an(tt.none());return{readState:function(){return n.get().getOr("none")},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(tt.none())}}}}),VO=[Kr("channel"),oi("renderComponents"),oi("updateState"),oi("initialData")],RO=Va({fields:VO,name:"reflecting",active:FO,apis:MO,state:IO}),HO=Z([Kr("toggleClass"),Kr("fetch"),ka("onExecute"),si("getHotspot",tt.some),si("layouts",tt.none()),ka("onItemExecute"),oi("lazySink"),Kr("dom"),wa("onOpen"),Bf("splitDropdownBehaviours",[Gv,Um,dg]),si("matchWidth",!1),si("useMinWidth",!1),si("eventOrder",{}),oi("role")].concat(wb())),NO=el({factory:qg,schema:[Kr("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Fa([dg.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(ki)},buttonBehaviours:Fa([Cg.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),PO=el({factory:qg,schema:[Kr("dom")],name:"button",defaults:function(){return{buttonBehaviours:Fa([dg.revoke()])}},overrides:function(e){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(e.uid).each(function(t){e.onExecute(t,n)})}}}}),zO=Z([NO,PO,rl({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Kr("text")],name:"aria-descriptor"}),ol({schema:[ba()],name:"menu",defaults:function(o){return{onExecute:function(n,e){n.getSystem().getByUid(o.uid).each(function(t){o.onItemExecute(t,n,e)})}}}}),eb()]),LO=_l({name:"SplitDropdown",configFields:HO(),partFields:zO(),factory:function(o,t,n,e){var r=function(t){Vl.getCurrent(t).each(function(t){ql.highlightFirst(t),Um.focusIn(t)})},i=function(t){sb(o,function(t){return t},t,e,r,Tv.HighlightFirst).get(Q)},u=function(t){var n=vl(t,o,"button");return ki(n),tt.some(!0)},a=$t(Ii([Yi(function(e){hl(e,o,"aria-descriptor").each(function(t){var n=Vo("aria");vo(t.element(),"id",n),vo(e.element(),"aria-describedby",n)})})]),Yg(tt.some(i)));return{uid:o.uid,dom:o.dom,components:t,eventOrder:Ho({},o.eventOrder,{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:a,behaviours:Df(o.splitDropdownBehaviours,[Gv.config({others:{sandbox:function(t){var n=vl(t,o,"arrow");return db(o,t,{onOpen:function(){Cg.on(n),Cg.on(t)},onClose:function(){Cg.off(n),Cg.off(t)}})}}}),Um.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return i(t),tt.some(!0)}}),dg.config({}),Cg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:o.role.getOr("button"),"aria-haspopup":!0}}}}}),jO=Vo("update-menu-text"),UO=Vo("update-menu-icon"),WO=function(t,n,o){var e=an(Q),r=t.text.map(function(t){return Kg(US(t,n,o.providers))}),i=t.icon.map(function(t){return Kg(jS(t,o.providers.icons))}),u=function(t,n){var e=ag.getValue(t);return dg.focus(e),Si(e,"keydown",{raw:n.event().raw()}),jy.close(e),tt.some(!0)},a=t.role.fold(function(){return{}},function(t){return{role:t}}),c=t.tooltip.fold(function(){return{}},function(t){var n=o.providers.translate(t);return{title:n,"aria-label":n}});return Kg(jy.sketch(Ho({},a,{dom:{tag:"button",classes:[n,n+"--select"].concat(st(t.classes,function(t){return n+"--"+t})),attributes:Ho({},c)},components:bh([i.map(function(t){return t.asSpec()}),r.map(function(t){return t.asSpec()}),tt.some({dom:{tag:"div",classes:[n+"__select-chevron"],innerHtml:$g("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Fa(t.dropdownBehaviours.concat([sh(t.disabled),Uy.config({}),qm.config({}),_g("dropdown-events",[dh(t,e),mh(t,e)]),_g("menubutton-update-display-text",[Ni(jO,function(n,e){r.bind(function(t){return t.getOpt(n)}).each(function(t){qm.set(t,[oa(o.providers.translate(e.event().text()))])})}),Ni(UO,function(n,e){i.bind(function(t){return t.getOpt(n)}).each(function(t){qm.set(t,[jS(e.event().icon(),o.providers.icons)])})})])])),eventOrder:Jt(_O,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Fa([Um.config({mode:"special",onLeft:u,onRight:u})]),lazySink:o.getSink,toggleClass:n+"--active",parts:{menu:Rh(0,t.columns,t.presets)},fetch:function(){return tb.nu(t.fetch)}}))).asSpec()},GO=function(n){return{isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},XO=function(n){return{setActive:function(t){Cg.set(n,t)},isActive:function(){return Cg.isOn(n)},isDisabled:function(){return ah.isDisabled(n)},setDisabled:function(t){return ah.set(n,t)}}},YO=function(e){return{isDisabled:function(){return ah.isDisabled(e)},setDisabled:function(t){return ah.set(e,t)},setActive:function(t){var n=e.element();t?(Mu(n,"tox-tbtn--enabled"),vo(n,"aria-pressed",!0)):(Fu(n,"tox-tbtn--enabled"),wo(n,"aria-pressed"))},isActive:function(){return Iu(e.element(),"tox-tbtn--enabled")}}},qO=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},KO=Vo("focus-button"),JO=function(n,e,t,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]),attributes:qO(t,i)},components:bh([n.map(function(t){return LS(t,i.icons)}),e.map(function(t){return US(t,"tox-tbtn",i)})]),eventOrder:(u={},u[hn()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Fa([_g("common-button-display-events",[Ni(hn(),function(t,n){n.event().prevent(),wi(t,KO)})])].concat(o.map(function(t){return RO.config({channel:t,initialData:{icon:n,text:e},renderComponents:function(t){return bh([t.icon.map(function(t){return LS(t,i.icons)}),t.text.map(function(t){return US(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},$O=function(t,n,e){var o,r=an(Q),i=JO(t.icon,t.text,t.tooltip,tt.none(),tt.none(),e);return qg.sketch({dom:i.dom,components:i.components,eventOrder:_O,buttonBehaviours:Fa([_g("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Ji(function(n){lh(o,n)(function(t){Si(n,DO,{buttonApi:t}),o.onAction(t)})})),dh(n,r),mh(n,r)]),sh(t.disabled)].concat(n.toolbarButtonBehaviours))})},QO=function(t,n,e){return $O(t,{toolbarButtonBehaviours:[].concat(0<e.length?[_g("toolbarButtonWith",e)]:[]),getApi:GO,onSetup:t.onSetup},n)},ZO=function(t,n,e){return Jt($O(t,{toolbarButtonBehaviours:[qm.config({}),Cg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[_g("toolbarToggleButtonWith",e)]:[]),getApi:XO,onSetup:t.onSetup},n))},tT=function(n,t){var e,o,r,i,u=Vo("channel-update-split-dropdown-display"),a=function(e){return{isDisabled:function(){return ah.isDisabled(e)},setDisabled:function(t){return ah.set(e,t)},setIconFill:function(t,n){fa(e.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){vo(t,"fill",n)})},setIconStroke:function(t,n){fa(e.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each(function(t){vo(t,"stroke",n)})},setActive:function(n){vo(e.element(),"aria-pressed",n),fa(e.element(),"span").each(function(t){e.getSystem().getByDom(t).each(function(t){return Cg.set(t,n)})})},isActive:function(){return fa(e.element(),"span").exists(function(t){return e.getSystem().getByDom(t).exists(Cg.isOn)})}}},c=an(Q),s={getApi:a,onSetup:n.onSetup};return LO.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:$t({"aria-pressed":!1},qO(n.tooltip,t.providers))},onExecute:function(t){n.onAction(a(t))},onItemExecute:function(){},splitDropdownBehaviours:Fa([fh(!1),_g("split-dropdown-events",[Ni(KO,dg.focus),dh(s,c),mh(s,c)])]),eventOrder:(e={},e[be()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:(o=a,r=n,i=t.providers,function(n){return tb.nu(function(t){return r.fetch(t)}).map(function(t){return tt.from($h(Jt(Kh(Vo("menu-value"),t,function(t){r.onItemAction(o(n),t)},r.columns,r.presets,hh.CLOSE_ON_EXECUTE,r.select.getOr(function(){return!1}),i),{movement:Hh(r.columns,r.presets),menuBehaviours:xp("auto"!==r.columns?[]:[Yi(function(o){bp(o,4,Pp(r.presets)).each(function(t){var n=t.numRows,e=t.numColumns;Um.setGridSize(o,n,e)})})])})))})}),parts:{menu:Rh(0,n.columns,n.presets)},components:[LO.parts().button(JO(n.icon,n.text,tt.none(),tt.some(u),tt.some([Cg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),LO.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:$g("chevron-down",t.providers.icons)}}),LO.parts()["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},nT=function(t,n,e,o){return WO({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n){t.fetch(function(t){n(Vb(t,hh.CLOSE_ON_EXECUTE,e.providers))})},onSetup:t.onSetup,getApi:YO,columns:1,presets:"normal",classes:[],dropdownBehaviours:[]},n,e)},eT=function(i,u){return Ni(DO,function(t,n){var e,o=i.get(t),r=(e=o,{hide:function(){return wi(e,me())},getValue:function(){return ag.getValue(e)}});u.onAction(r,n.event().buttonApi())})},oT=function(t,n,e){var o,r,i,u,a,c,s,f,l,d,m,g,p={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?(s=t,l=p,(d=(f=n).original).primary,m=h(d,["primary"]),g=Nr(wO(Ho({},m,{type:"togglebutton",onAction:function(){}}))),ZO(g,l.backstage.shared.providers,[eT(s,f)])):(o=t,i=p,(u=(r=n).original).primary,a=h(u,["primary"]),c=Nr(pO(Ho({},a,{type:"button",onAction:function(){}}))),QO(c,i.backstage.shared.providers,[eT(o,r)]))},rT=function(t,n){var e,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),a=Kg(Rb.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:Fa([Um.config({mode:"special",onEnter:function(t){return c.findPrimary(t).map(function(t){return ki(t),!0})},onLeft:function(t,n){return n.cut(),tt.none()},onRight:function(t,n){return n.cut(),tt.none()}})])})),c=(e=a,o=t.commands,r=n.shared.providers,i=st(o,function(t){return Kg(oT(e,t,r))}),{asSpecs:function(){return st(i,function(t){return t.asSpec()})},findPrimary:function(e){return sn(o,function(t,n){return t.primary?tt.from(i[n]).bind(function(t){return t.getOpt(e)}).filter(N(ah.isDisabled)):tt.none()})}});return dO({uid:Vo("context-toolbar"),initGroups:[{title:tt.none(),items:[a.asSpec()]},{title:tt.none(),items:c.asSpecs()}],onEscape:tt.none,cyclicKeying:!0,backstage:n,getSink:function(){return Xt.error("")}})},iT=Vo("forward-slide"),uT=Vo("backward-slide"),aT=Vo("change-slide-event"),cT="tox-pop--resizing",sT=function(n,t){return sn(t,function(t){return t.predicate(n.dom())?tt.some({toolbarApi:t,elem:n}):tt.none()})},fT=function(n,e){var t=function(t){return t.dom()===e.getBody()},a=Be.fromDom(e.selection.getNode());return sT(a,n.inNodeScope).orThunk(function(){return sT(a,n.inEditorScope).orThunk(function(){return function(t,n,e){for(var o=a.dom(),r=et(e)?e:Z(!1);o.parentNode;){o=o.parentNode;var i=Be.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return tt.none()}(0,function(t){return sT(t,n.inNodeScope)},t)})})},lT=function(e,r){var t={},i=[],u=[],a={},c={},o=function(n,e){var o=Nr(Hr("ContextForm",BO,e));(t[n]=o).launch.map(function(t){a["form:"+n]=Ho({},e.launch,{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){r(o)}})}),"editor"===o.scope?u.push(o):i.push(o),c[n]=o},s=function(n,e){var t;(t=e,Hr("ContextToolbar",AO,t)).each(function(t){"editor"===e.scope?u.push(t):i.push(t),c[n]=t})},n=_t(e);return ft(n,function(t){var n=e[t];"contextform"===n.type?o(t,n):"contexttoolbar"===n.type&&s(t,n)}),{forms:t,inNodeScope:i,inEditorScope:u,lookupTable:c,formNavigators:a}},dT=function(o,r){return function(n){var e=an(tt.none()),t=function(){n.setActive(o.formatter.match(r));var t=o.formatter.formatChanged(r,n.setActive).unbind;e.set(tt.some(t))};return o.initialized?t():o.on("init",t),function(){return e.get().each(function(t){return t()})}}},mT=function(n){return function(t){return function(){n.undoManager.transact(function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)})}}},gT=function(t,n,e,o){var i,u,r,a,c,s="basic"===e.type?function(){return st(e.data,function(t){return Zk(t,o.isSelectedFor,o.getPreviewFor)})}:e.getData;return{items:(i=n,u=o,r=function(t,n,e){var o=i.shared.providers.translate(t.title);if("separator"===t.type)return tt.some({type:"separator",text:o});if("submenu"!==t.type)return tt.some(Ho({type:"togglemenuitem",text:o,active:t.isSelected(),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));var r=wt(t.getStyleItems(),function(t){return a(t,n)});return 0===n&&r.length<=0?tt.none():tt.some({type:"nestedmenuitem",text:o,disabled:r.length<=0,getSubmenuItems:function(){return wt(t.getStyleItems(),function(t){return a(t,n)})}})},a=function(t,n){var e="formatter"===t.type&&u.isInvalid(t);return 0===n?e?[]:r(t,n,!1).toArray():r(t,n,e).toArray()},c=function(t){var n=u.shouldHide?0:1;return wt(t,function(t){return a(t,n)})},{validateItems:c,getFetch:function(o,r){return function(t){var n=r(),e=c(n);t(Vb(e,hh.CLOSE_ON_EXECUTE,o.shared.providers))}}}),getStyleItems:s}},pT=function(o,t,n,r){var e=gT(0,t,n,r),i=e.items,u=e.getStyleItems;return WO({text:r.icon.isSome()?tt.none():tt.some(""),icon:r.icon,tooltip:tt.from(r.tooltip),role:tt.none(),fetch:i.getFetch(t,u),onSetup:function(e){return r.nodeChangeHandler.map(function(t){var n=t(e.getComponent());return o.on("NodeChange",n),function(){o.off("NodeChange",n)}}).getOr(Q)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)};(ib=rb||(rb={}))[ib.SemiColon=0]="SemiColon",ib[ib.Space=1]="Space";var hT,vT,bT=function(t,n,e,o){var r,i;return{type:"basic",data:(i=nn(t.settings,n).getOr(e),r=o===rb.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),st(r,function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}}))}},yT=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],xT=function(e){var t=tt.some(function(n){return function(){var t=ht(yT,function(t){return e.formatter.match(t.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});Si(n,UO,{icon:"align-"+t})}}),n={type:"basic",data:yT};return{tooltip:"Align",icon:tt.some("align-left"),isSelectedFor:function(t){return function(){return e.formatter.match(t)}},getPreviewFor:function(){return function(){return tt.none()}},onAction:mT(e),nodeChangeHandler:t,dataset:n,shouldHide:!1,isInvalid:function(t){return!e.formatter.canApply(t.format)}}},wT=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],ST=function(r){var o=function(){var e=function(t){return t?t.split(",")[0]:""},t=r.queryCommandValue("FontName"),n=i.data,o=t?t.toLowerCase():"";return ht(n,function(t){var n=t.format;return n.toLowerCase()===o||e(n).toLowerCase()===e(o).toLowerCase()}).orThunk(function(){return 0===(t=o).indexOf("-apple-system")&&(n=t.toLowerCase().split(/['"]?\s*,\s*['"]?/),St(wT,function(t){return-1<n.indexOf(t.toLowerCase())}))?tt.from({title:"System Font",format:o}):tt.none();var t,n})},t=tt.some(function(e){return function(){var t=r.queryCommandValue("FontName"),n=o().fold(function(){return t},function(t){return t.title});Si(e,jO,{text:n})}}),i=bT(r,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",rb.SemiColon);return{tooltip:"Fonts",icon:tt.none(),isSelectedFor:function(n){return function(){return o().exists(function(t){return t.format===n})}},getPreviewFor:function(t){return function(){return tt.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},onAction:function(t){return function(){r.undoManager.transact(function(){r.focus(),r.execCommand("FontName",!1,t.format)})}},nodeChangeHandler:t,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},kT=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):t;var e,o,r},CT=function(i){var u=function(){var e=tt.none(),o=a.data,r=i.queryCommandValue("FontSize");if(r)for(var t=function(t){var n=kT(r,t);e=ht(o,function(t){return t.format===r||t.format===n})},n=3;e.isNone()&&0<=n;n--)t(n);return{matchOpt:e,px:r}},t=tt.some(function(r){return function(){var t=u(),n=t.matchOpt,e=t.px,o=n.fold(function(){return e},function(t){return t.title});Si(r,jO,{text:o})}}),a=bT(i,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",rb.Space);return{tooltip:"Font sizes",icon:tt.none(),isSelectedFor:function(n){return function(){return u().matchOpt.exists(function(t){return t.format===n})}},getPreviewFor:function(){return function(){return tt.none()}},onAction:function(t){return function(){i.undoManager.transact(function(){i.focus(),i.execCommand("FontSize",!1,t.format)})}},nodeChangeHandler:t,dataset:a,shouldHide:!1,isInvalid:function(){return!1}}},OT=function(e,t,n){var o=n.parents,r=t();return sn(o,function(n){return ht(r,function(t){return e.formatter.matchNode(n,t.format)})}).orThunk(function(){return e.formatter.match("p")?tt.some({title:"Paragraph",format:"p"}):tt.none()})},TT=function(o){var t=tt.some(function(e){return function(t){var n=OT(o,function(){return r.data},t).fold(function(){return"Paragraph"},function(t){return t.title});Si(e,jO,{text:n})}}),r=bT(o,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",rb.SemiColon);return{tooltip:"Blocks",icon:tt.none(),isSelectedFor:function(t){return function(){return o.formatter.match(t)}},getPreviewFor:function(n){return function(){var t=o.formatter.get(n);return tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:o.formatter.getCssText(n)})}},onAction:mT(o),nodeChangeHandler:t,dataset:r,shouldHide:!1,isInvalid:function(t){return!o.formatter.canApply(t.format)}}},ET=function(i){var t=tt.some(function(e){var o=function(t){var n=t.items;return n!==undefined&&0<n.length?wt(n,o):[{title:t.title,format:t.format}]},r=wt(Qk(i),o);return function(t){var n=OT(i,function(){return r},t).fold(function(){return"Paragraph"},function(t){return t.title});Si(e,jO,{text:n})}});return{tooltip:"Formats",icon:tt.none(),isSelectedFor:function(t){return function(){return i.formatter.match(t)}},getPreviewFor:function(n){return function(){var t=i.formatter.get(n);return t!==undefined?tt.some({tag:0<t.length&&(t[0].inline||t[0].block)||"div",styleAttr:i.formatter.getCssText(n)}):tt.none()}},onAction:mT(i),nodeChangeHandler:t,shouldHide:i.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!i.formatter.canApply(t.format)}}},BT=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],AT=function(o,r){return function(t,n){var e=o(t).mapError(function(t){return zr(t)}).getOrDie();return r(e,n)}},DT={button:AT(pO,function(t,n){return e=t,o=n.backstage.shared.providers,QO(e,o,[]);var e,o}),togglebutton:AT(wO,function(t,n){return e=t,o=n.backstage.shared.providers,ZO(e,o,[]);var e,o}),menubutton:AT(vO,function(t,n){return nT(t,"tox-tbtn",n.backstage.shared,tt.none())}),splitbutton:AT(function(t){return Hr("SplitButton",bO,t)},function(t,n){return tT(t,n.backstage.shared)}),styleSelectButton:function(t,n){return e=t,r=(o=n.backstage).styleselect,pT(e,o,r,ET(e));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,r=CT(e),pT(e,o,r.dataset,r);var e,o,r},fontSelectButton:function(t,n){return e=t,o=n.backstage,r=ST(e),pT(e,o,r.dataset,r);var e,o,r},formatButton:function(t,n){return e=t,o=n.backstage,r=TT(e),pT(e,o,r.dataset,r);var e,o,r},alignMenuButton:function(t,n){return e=t,o=n.backstage,r=xT(e),pT(e,o,r.dataset,r);var e,o,r}},_T={styleselect:DT.styleSelectButton,fontsizeselect:DT.fontsizeSelectButton,fontselect:DT.fontSelectButton,formatselect:DT.formatButton,align:DT.alignMenuButton},MT=function(t){var n=t.split("|");return st(n,function(t){return{items:t.trim().split(" ")}})},FT=function(t){return!1===t.toolbar?[]:t.toolbar===undefined||!0===t.toolbar?(e=t.buttons,n=st(BT,function(t){var n=mt(t.items,function(t){return zt(e,t)||zt(_T,t)});return{name:t.name,items:n}}),mt(n,function(t){return 0<t.items.length})):K(t.toolbar)?MT(t.toolbar):$(t.toolbar)&&K(t.toolbar[0])?MT(t.toolbar.join(" | ")):t.toolbar;var e,n},IT=function(n,e,o,r,t){return Pt(e,o.toLowerCase()).orThunk(function(){return t.bind(function(t){return sn(t,function(t){return Pt(e,t+o.toLowerCase())})})}).fold(function(){return Pt(_T,o.toLowerCase()).map(function(t){return t(n,r)}).orThunk(function(){return tt.none()})},function(t){return e=r,Pt(DT,(n=t).type).fold(function(){return x.console.error("skipping button defined by",n),tt.none()},function(t){return tt.some(t(n,e))});var n,e})},VT=function(e,o,r,i){var t=FT(o),n=st(t,function(t){var n=wt(t.items,function(t){return 0===t.trim().length?[]:IT(e,o.buttons,t,r,i).toArray()});return{title:tt.from(e.translate(t.name)),items:n}});return mt(n,function(t){return 0<t.items.length})},RT=function(i,t,u,a){var n,e,c=ua((n={sink:u,onEscape:function(){return i.focus(),tt.some(!0)}},e=an([]),Xg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){e.set([]),Xg.getContent(t).each(function(t){Yu(t.element(),"visibility")}),Fu(t.element(),cT),Yu(t.element(),"width")},inlineBehaviours:Fa([_g("context-toolbar-events",[Xi(Bn(),function(t){Xg.getContent(t).each(function(){}),Fu(t.element(),cT),Yu(t.element(),"width")}),Ni(aT,function(n,e){Yu(n.element(),"width");var t=Ja(n.element());Xg.setContent(n,e.event().contents()),Mu(n.element(),cT);var o=Ja(n.element());zu(n.element(),"width",t+"px"),Xg.getContent(n).each(function(t){e.event().focus().bind(function(t){return ud(t),cd(n.element())}).orThunk(function(){return Um.focusIn(t),ad()})}),tp.setTimeout(function(){zu(n.element(),"width",o+"px")},0)}),Ni(iT,function(t,n){Xg.getContent(t).each(function(t){e.set(e.get().concat([{bar:t,focus:ad()}]))}),Si(t,aT,{contents:n.event().forwardContents(),focus:tt.none()})}),Ni(uT,function(n){At(e.get()).each(function(t){e.set(e.get().slice(0,e.get().length-1)),Si(n,aT,{contents:aa(t.bar),focus:t.focus})})})]),Um.config({mode:"special",onEscape:function(t){return At(e.get()).fold(function(){return n.onEscape()},function(){return wi(t,uT),tt.some(!0)})}})]),lazySink:function(){return Xt.value(n.sink)}}))),s=function(){return tt.some(Be.fromDom(i.contentAreaContainer))};i.on("init",function(){var t=i.getBody().ownerDocument.defaultView,n=ov(Be.fromDom(t),"scroll",function(){f.get().each(function(t){var n=l.get().getOr(i.selection.getNode()).getBoundingClientRect(),e=i.contentAreaContainer.getBoundingClientRect(),o=n.bottom<0,r=n.top>e.height;o||r?zu(c.element(),"display","none"):(Yu(c.element(),"display"),tf.positionWithin(u,t,c,s()))})});i.on("remove",function(){n.unbind()})});var f=an(tt.none()),l=an(tt.none()),o=an(null),d=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:Fa([Um.config({mode:"acyclic"}),_g("pop-dialog-wrap-events",[Yi(function(t){i.shortcuts.add("ctrl+F9","focus statusbar",function(){return Um.focusIn(t)})}),qi(function(){i.shortcuts.remove("ctrl+F9")})])])}},m=Dn(function(){return lT(t,function(t){var n=g(t);Si(c,iT,{forwardContents:d(n)})})}),g=function(t){var n,e,o=i.ui.registry.getAll().buttons,r=m();return"contexttoolbar"===t.type?(n=$t(o,r.formNavigators),e=VT(i,{buttons:n,toolbar:t.items},a,tt.some(["form:"])),dO({uid:Vo("context-toolbar"),initGroups:e,onEscape:tt.none,cyclicKeying:!0,backstage:a.backstage,getSink:function(){return Xt.error("")}})):rT(t,a.backstage)};i.on("contexttoolbar-show",function(n){var t=m();nn(t.lookupTable,n.toolbarKey).each(function(t){b(t,n.target===i?tt.none():tt.some(n)),Xg.getContent(c).each(Um.focusIn)})});var r={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},p={maxHeightFunction:Mc()},h={bubble:Hc(12,0,r),layouts:{onLtr:function(){return[Qc]},onRtl:function(){return[Zc]}},overrides:p},v={bubble:Hc(0,12,r),layouts:{onLtr:function(){return[Jc,$c,qc,Xc,Kc,Yc]},onRtl:function(){return[Jc,$c,Kc,Yc,qc,Xc]}},overrides:p},b=function(t,n){x();var e,o,r,i=g(t),u=(o=n.map(Be.fromDom),r="node"===(e=t.position)?a.backstage.shared.anchors.node(o):a.backstage.shared.anchors.cursor(),Jt(r,"line"===e?h:v));f.set(tt.some(u)),l.set(n),Xg.showWithin(c,u,d(i),s()),Yu(c.element(),"display")},y=function(){var t=m();fT(t,i).fold(function(){f.set(tt.none()),Xg.hide(c)},function(t){b(t.toolbarApi,tt.some(t.elem.dom()))})},x=function(){var t=o.get();null!==t&&(tp.clearTimeout(t),o.set(null))},w=function(t){x(),o.set(t)};i.on("init",function(){i.on("click keyup SetContent ObjectResized ResizeEditor",function(){w(tp.setEditorTimeout(i,y,0))}),i.on("focusout",function(){tp.setEditorTimeout(i,function(){cd(u.element()).isNone()&&cd(c.element()).isNone()&&(f.set(tt.none()),Xg.hide(c))},0)}),i.on("NodeChange",function(){cd(c.element()).fold(function(){w(tp.setEditorTimeout(i,y,0))},function(){})})})},HT=function(t,e,o){var n=ov(Be.fromDom(x.document),"mousedown",function(n){ft([e,o],function(t){t.broadcastOn([kf()],{target:n.target()})})}),r=ov(Be.fromDom(x.document),"touchstart",function(n){ft([e,o],function(t){t.broadcastOn([kf()],{target:n.target()})})}),i=ov(Be.fromDom(x.document),"mouseup",function(n){0===n.raw().button&&ft([e,o],function(t){t.broadcastOn([Cf()],{target:n.target()})})}),u=function(n){ft([e,o],function(t){t.broadcastOn([kf()],{target:Be.fromDom(n.target)})})};t.on("mousedown",u),t.on("touchstart",u);var a=function(n){0===n.button&&ft([e,o],function(t){t.broadcastOn([Cf()],{target:Be.fromDom(n.target)})})};t.on("mouseup",a);var c=function(n){ft([e,o],function(t){t.broadcastEvent(he(),n)})};t.on("ScrollWindow",c);var s=function(n){ft([e,o],function(t){t.broadcastEvent(ve(),n)})};t.on("ResizeWindow",s),t.on("remove",function(){t.off("mousedown",u),t.off("touchstart",u),t.off("mouseup",a),t.off("ResizeWindow",s),t.off("ScrollWindow",c),n.unbind(),r.unbind(),i.unbind()}),t.on("detach",function(){mf(e),mf(o),e.destroy(),o.destroy()})},NT=Cl,PT=al,zT=Dl({factory:function(o){var t={focus:Um.focusIn,setMenus:function(t,n){var e=st(n,function(n){var t={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},e=vO(t).mapError(function(t){return zr(t)}).getOrDie();return nT(e,"tox-mbtn",{getSink:o.getSink,providers:o.providers},tt.some("menuitem"))});qm.set(t,e)}};return{uid:o.uid,dom:o.dom,components:[],behaviours:Fa([qm.config({}),_g("menubar-events",[Yi(function(t){o.onSetup(t)}),Ni(xn(),function(e,t){fa(e.element(),".tox-mbtn--active").each(function(n){la(t.event().target(),".tox-mbtn").each(function(t){Ye(n,t)||e.getSystem().getByDom(n).each(function(n){e.getSystem().getByDom(t).each(function(t){jy.expand(t),jy.close(n),dg.focus(t)})})})})}),Ni(we(),function(e,t){t.event().prevFocus().bind(function(t){return e.getSystem().getByDom(t).toOption()}).each(function(n){t.event().newFocus().bind(function(t){return e.getSystem().getByDom(t).toOption()}).each(function(t){jy.isOpen(n)&&(jy.expand(t),jy.close(n))})})})]),Um.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return o.onEscape(t),tt.some(!0)}}),Zb.config({})]),apis:t,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Kr("dom"),Kr("uid"),Kr("onEscape"),Kr("getSink"),Kr("providers"),si("onSetup",Q)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),LT="container",jT=[Bf("slotBehaviours",[])],UT=function(t){return"<alloy.field."+t+">"},WT=function(r,t){var e,n=function(){return xl(r)},o=function(e,o){return void 0===o&&(o=undefined),function(t,n){return hl(t,r,n).map(function(t){return e(t,n)}).getOr(o)}},i=function(t){return"true"!==yo(t.element(),"aria-hidden")},u=o(i,!1),a=o(function(t,n){if(i(t)){var e=t.element();zu(e,"display","none"),vo(e,"aria-hidden","true"),Si(t,Se(),{name:n,visible:!1})}}),c=(e=a,function(n,t){ft(t,function(t){return e(n,t)})}),s=o(function(t,n){if(!i(t)){var e=t.element();Yu(e,"display"),wo(e,"aria-hidden"),Si(t,Se(),{name:n,visible:!0})}}),f={getSlotNames:n,getSlot:function(t,n){return hl(t,r,n)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,n())},showSlot:s};return{uid:r.uid,dom:r.dom,components:t,behaviours:Af(r.slotBehaviours),apis:f}},GT=It({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},gu),XT=Ho({},GT,{sketch:function(t){var e,n=(e=[],{slot:function(t,n){return e.push(t),ll(LT,UT(t),n)},record:function(){return e}}),o=t(n),r=n.record(),i=st(r,function(t){return el({name:t,pname:UT(t)})});return Tl(LT,jT,i,WT,o)}}),YT=Sr([ui("icon"),ui("tooltip"),pi("onShow",Q),pi("onHide",Q),pi("onSetup",function(){return Q})]),qT=function(t){return{element:function(){return t.element().dom()}}},KT=function(e,o){var r=st(_t(o),function(t){var n=o[t],e=Nr(Hr("sidebar",YT,n));return{name:t,getApi:qT,onSetup:e.onSetup,onShow:e.onShow,onHide:e.onHide}});return st(r,function(t){var n=an(Q);return e.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:xp([dh(t,n),mh(t,n),Ni(Se(),function(n,t){var e=t.event();ht(r,function(t){return t.name===e.name(
)}).each(function(t){(e.visible()?t.onShow:t.onHide)(t.getApi(n))})})])})})},JT=function(t,e){Vl.getCurrent(t).each(function(t){return qm.set(t,[(n=e,XT.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:KT(t,n),slotBehaviours:xp([Yi(function(t){return XT.hideAllSlots(t)})])}}))]);var n})},$T=function(t){return Vl.getCurrent(t).bind(function(t){return KC.isGrowing(t)||KC.hasGrown(t)?Vl.getCurrent(t).bind(function(n){return ht(XT.getSlotNames(n),function(t){return XT.isShowing(n,t)})}):tt.none()})},QT=Vo("FixSizeEvent"),ZT=Vo("AutoSizeEvent"),tE=function(t,n,e){var o,r=t.element();!0===n?(qm.set(t,[(o=e,{dom:{tag:"div",attributes:{"aria-label":o.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:Ap('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Fa([Um.config({mode:"special",onTab:function(){return tt.some(!0)},onShiftTab:function(){return tt.some(!0)}}),dg.config({})])})]),Yu(r,"display"),wo(r,"aria-hidden")):(qm.set(t,[]),zu(r,"display","none"),vo(r,"aria-hidden","true"))},nE=PT.optional({factory:zT,name:"menubar",schema:[Kr("dom"),Kr("getSink")]}),eE=PT.optional({factory:{sketch:function(t){return(t.split===zh.sliding||t.split===zh.floating?lO:dO)({uid:t.uid,onEscape:function(){return t.onEscape(),tt.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{floating:t.split===zh.floating,lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton}})}},name:"toolbar",schema:[Kr("dom"),Kr("onEscape"),Kr("getSink")]}),oE=PT.optional({name:"socket",schema:[Kr("dom")]}),rE=PT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Fa([Zb.config({}),dg.config({}),KC.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Vl.getCurrent(t).each(XT.hideAllSlots),wi(t,ZT)},onGrown:function(t){wi(t,ZT)},onStartGrow:function(t){Si(t,QT,{width:Gu(t.element(),"width").getOr("")})},onStartShrink:function(t){Si(t,QT,{width:Ja(t.element())+"px"})}}),qm.config({}),Vl.config({find:function(t){var n=qm.contents(t);return Bt(n)}})])}],behaviours:Fa([$w(0),_g("sidebar-sliding-events",[Ni(QT,function(t,n){zu(t.element(),"width",n.event().width())}),Ni(ZT,function(t){Yu(t.element(),"width")})])])}}},name:"sidebar",schema:[Kr("dom")]}),iE=PT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Fa([qm.config({})]),components:[]}}},name:"throbber",schema:[Kr("dom")]}),uE=_l({name:"OuterContainer",factory:function(e,t){var n={getSocket:function(t){return NT.getPart(t,e,"socket")},setSidebar:function(t,n){NT.getPart(t,e,"sidebar").each(function(t){return JT(t,n)})},toggleSidebar:function(t,o){NT.getPart(t,e,"sidebar").each(function(t){return n=t,e=o,void Vl.getCurrent(n).each(function(n){Vl.getCurrent(n).each(function(t){KC.hasGrown(n)?XT.isShowing(t,e)?KC.shrink(n):(XT.hideAllSlots(t),XT.showSlot(t,e)):(XT.hideAllSlots(t),XT.showSlot(t,e),KC.grow(n))})});var n,e})},whichSidebar:function(t){return NT.getPart(t,e,"sidebar").bind($T).getOrNull()},getToolbar:function(t){return NT.getPart(t,e,"toolbar")},setToolbar:function(t,n){NT.getPart(t,e,"toolbar").each(function(t){QC.setGroups(t,n)})},getMoreButton:function(t){return NT.getPart(t,e,"toolbar").bind(function(t){return aO.getMoreButton(t)})},getThrobber:function(t){return NT.getPart(t,e,"throbber")},focusToolbar:function(t){NT.getPart(t,e,"toolbar").each(function(t){Um.focusIn(t)})},setMenubar:function(t,n){NT.getPart(t,e,"menubar").each(function(t){zT.setMenus(t,n)})},focusMenubar:function(t){NT.getPart(t,e,"menubar").each(function(t){zT.focus(t)})}};return{uid:e.uid,dom:e.dom,components:t,apis:n,behaviours:e.behaviours}},configFields:[Kr("dom"),Kr("behaviours")],partFields:[nE,eE,oE,rE,iE],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=st(e,function(t){return sO(t)});t.setToolbar(n,o)},getMoreButton:function(t,n){return t.getMoreButton(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),aE={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable tableprops deletetable row column cell"},help:{title:"Help",items:"help"}},cE=function(t){return"string"==typeof t?t.split(" "):t},sE=function(u,a){var c=$t(aE,a.menus),n=0<_t(a.menus).length,t=a.menubar===undefined||!0===a.menubar?cE("file edit view insert format tools table help"):cE(!1===a.menubar?"":a.menubar),e=mt(t,function(t){return n&&a.menus.hasOwnProperty(t)&&a.menus[t].hasOwnProperty("items")||aE.hasOwnProperty(t)}),o=st(e,function(t){var n,e,o,r,i=c[t];return n={title:i.title,items:cE(i.items)},e=a,r=(o=u,o.getParam("removed_menuitems","")).split(/[ ,]/),{text:n.title,getItems:function(){return wt(n.items,function(t){var n=t.toLowerCase();return 0===n.trim().length?[]:at(r,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]})}}});return mt(o,function(t){return 0<t.getItems().length&&at(t.getItems(),function(t){return"separator"!==t.type})})},fE=function(t){return t.fire("SkinLoaded")},lE=function(t){return t.fire("ResizeEditor")},dE=function(t){return t.fire("ResizeContent")},mE=function(t){var n=function(){t._skinLoaded=!0,fE(t)};return function(){t.initialized?n():t.on("init",n)}},gE=function(t,n){var e,o=function(t){var n=t.settings,e=n.skin,o=n.skin_url;if(!1!==e){var r=e||"oxide";o=o?t.documentBaseURI.toAbsolute(o):Sv.baseURL+"/skins/ui/"+r}return o}(n);o&&(e=o+"/skin.min.css",n.contentCSS.push(o+(t?"/content.inline":"/content")+".min.css")),0==(!1===n.getParam("skin"))&&e?wv.DOM.styleSheetLoader.load(e,mE(n)):mE(n)()},pE=v(gE,!1),hE=v(gE,!0),vE=wv.DOM,bE=function(t){return function(n){var e=t.outerContainer;Ge("*",e.element()).forEach(function(t){e.getSystem().getByDom(t).each(function(t){t.hasConfigured(ah)&&("readonly"===n.mode?ah.disable(t):ah.enable(t))})})}},yE={render:function(r,i,n,u,t){var e,o;pE(r),e=Be.fromDom(t.targetNode),o=i.mothership,df(e,o,no),lf(Bi(),i.uiMothership),r.on("init",function(){uE.setToolbar(i.outerContainer,VT(r,n,{backstage:u},tt.none())),uE.setMenubar(i.outerContainer,sE(r,n)),uE.setSidebar(i.outerContainer,n.sidebar),r.readonly&&bE(i)({mode:"readonly"});var e=an(Wa(0,0)),o=r.contentWindow,t=function(){var t=e.get();if(t.left()!==o.innerWidth||t.top()!==o.innerHeight){var n=Wa(o.innerWidth,o.innerHeight);e.set(n),dE(r)}};vE.bind(o,"resize",t),r.on("remove",function(){vE.unbind(o,"resize",t)})});var a=uE.getSocket(i.outerContainer).getOrDie("Could not find expected socket element");r.on("SwitchMode",bE(i)),r.getParam("readonly",!1,"boolean")&&r.setMode("readonly"),r.addCommand("ToggleSidebar",function(t,n){uE.toggleSidebar(i.outerContainer,n),r.fire("ToggleSidebar")}),r.addQueryValueHandler("ToggleSidebar",function(){return uE.whichSidebar(i.outerContainer)});var c=Bv(r);return c!==zh.sliding&&c!==zh.floating||r.on("ResizeContent",function(){uE.getToolbar(i.outerContainer).each(aO.refresh)}),{iframeContainer:a.element().dom(),editorContainer:i.outerContainer.element().dom()}},getBehaviours:function(){return[]}},xE=function(e,n){return $e(e).orThunk(function(){var t=Be.fromTag("span");to(e,t);var n=$e(t);return uo(t),n}).map(function(t){return Xa(t).translate(-n.left(),-n.top())}).getOrThunk(function(){return Wa(0,0)})},wE=Yt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),SE=function(n){return function(t){return t.translate(-n.left(),-n.top())}},kE=function(n){return function(t){return t.translate(n.left(),n.top())}},CE=function(e){return function(t,n){return pt(e,function(t,n){return n(t)},Wa(t,n))}},OE=function(t,n,e){return t.fold(CE([kE(e),SE(n)]),CE([SE(n)]),CE([]))},TE=function(t,n,e){return t.fold(CE([kE(e)]),CE([]),CE([kE(n)]))},EE=function(t,n,e){return t.fold(CE([]),CE([SE(e)]),CE([kE(n),SE(e)]))},BE=function(t,n,e){return t.fold(function(t,n){return{position:"absolute",left:t+"px",top:n+"px"}},function(t,n){return{position:"absolute",left:t-e.left()+"px",top:n-e.top()+"px"}},function(t,n){return{position:"fixed",left:t+"px",top:n+"px"}})},AE=wE.offset,DE=wE.absolute,_E=wE.fixed,ME=function(t,n){Mu(t.element(),n.transitionClass),Fu(t.element(),n.fadeOutClass),Mu(t.element(),n.fadeInClass)},FE=function(t,n){Mu(t.element(),n.transitionClass),Fu(t.element(),n.fadeInClass),Mu(t.element(),n.fadeOutClass)},IE=function(t,n){return t.y()>=n.y()&&t.bottom()<=n.bottom()},VE=function(t,n){return xo(t,n)?tt.some(parseInt(yo(t,n),10)):tt.none()},RE=function(o,r,i){return(u=o,t=r,n=u.element(),VE(n,t.leftAttr).bind(function(o){return VE(n,t.topAttr).map(function(t){var n=Ja(u.element()),e=Za(u.element());return gc(o,t,n,e)})})).bind(function(t){return IE(t,i)?(n=r,e=o.element(),wo(e,n.leftAttr),wo(e,n.topAttr),tt.some(DE(t.x(),t.y()))):tt.none();var n,e});var u,t,n},HE=function(t,n,e,o,r){var i=Xa(t.element()),u=gc(i.left(),i.top(),Ja(t.element()),Za(t.element()));if(IE(u,e))return tt.none();a=t,c=n,s=i.left(),f=i.top(),l=a.element(),vo(l,c.leftAttr,s),vo(l,c.topAttr,f);var a,c,s,f,l,d=DE(i.left(),i.top()),m=OE(d,o,r),g=DE(e.x(),e.y()),p=OE(g,o,r),h=u.y()<=e.y()?p.top():p.top()+e.height()-u.height();return tt.some(_E(m.left(),h))},NE=function(i,t){var u=t.lazyViewport(i);t.contextual.each(function(r){r.lazyContext(i).each(function(t){var n,e,o=pc(t);e=u,((n=o).y()<e.bottom()&&n.bottom()>e.y()?ME:FE)(i,r)})});var n,e,o,r,a,c=qe(i.element()),s=qa(c),f=xE(i.element(),s);(n=i,e=t,o=u,r=s,a=f,Gu(n.element(),"position").is("fixed")?RE(n,e,o):HE(n,e,o,r,a)).each(function(t){var n=BE(t,0,f);Lu(i.element(),n)})},PE=Object.freeze({refresh:NE}),zE=Object.freeze({events:function(o){return Ii([Ni(Bn(),function(n,e){o.contextual.each(function(t){Ye(n.element(),e.event().target())&&(Fu(n.element(),t.transitionClass),e.stop())})}),Ni(he(),function(t){NE(t,o)})])}}),LE=[ci("contextual",[Kr("fadeInClass"),Kr("fadeOutClass"),Kr("transitionClass"),Kr("lazyContext")]),si("lazyViewport",function(){var t=qa();return gc(t.left(),t.top(),x.window.innerWidth,x.window.innerHeight)}),Kr("leftAttr"),Kr("topAttr")],jE=Va({fields:LE,name:"docking",active:zE,apis:PE}),UE={render:function(e,n,o,r){var i,t=wv.DOM,u=Dv(e),a=Bv(e),c=a===zh.sliding||a===zh.floating,s=a===zh.floating;hE(e);var f=function(t){var n=c?t.fold(function(){return 0},function(t){return 1<t.components().length?Za(t.components()[1].element()):0}):0;Lu(i.element(),function(t){void 0===t&&(t=0);var n=Xa(Be.fromDom(e.getBody()));return{top:Math.round(n.top()-Za(i.element()))+t+"px",left:Math.round(n.left())+"px"}}(n)),jE.refresh(i)},l=function(){var t=uE.getToolbar(n.outerContainer);c&&t.each(aO.refresh),u||f(t)},d=function(){zu(n.outerContainer.element(),"display","flex"),t.addClass(e.getBody(),"mce-edit-focus"),l(),s&&uE.getToolbar(n.outerContainer).each(function(t){aO.getOverflow(t).each(function(t){Fu(t.element(),"tox-toolbar__overflow--closed")})})},m=function(){n.outerContainer&&(zu(n.outerContainer.element(),"display","none"),t.removeClass(e.getBody(),"mce-edit-focus"),s&&uE.getToolbar(n.outerContainer).each(function(t){aO.getOverflow(t).each(function(t){Mu(t.element(),"tox-toolbar__overflow--closed")})}))},g=function(){if(i)d();else{i=n.outerContainer;var t=Av(e).getOr(Bi());lf(t,n.mothership),lf(t,n.uiMothership),uE.setToolbar(n.outerContainer,VT(e,o,{backstage:r},tt.none())),uE.setMenubar(n.outerContainer,sE(e,o)),u||zu(i.element(),"position","absolute"),l(),d(),e.on("NodeChange ResizeWindow",l),e.on("activate",d),e.on("deactivate",m),e.nodeChanged()}};return e.on("focus",g),e.on("blur hide",m),e.on("init",function(){e.hasFocus()&&g()}),{editorContainer:n.outerContainer.element().dom()}},getBehaviours:function(t){return Dv(t)?[]:[jE.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",contextual:{lazyContext:function(){return tt.from(t).map(function(t){return Be.fromDom(t.getBody())})},fadeInClass:"tox-toolbar-dock-fadein",fadeOutClass:"tox-toolbar-dock-fadeout",transitionClass:"tox-toolbar-dock-transition"}}),dg.config({})]}},WE=function(t,n){return{anchor:"makeshift",x:t,y:n}},GE=function(t,n){var e,o,r,i=wv.DOM.getPos(t);return e=n,o=i.x,r=i.y,WE(e.x+o,e.y+r)},XE=function(t,n){return"contextmenu"===n.type?t.inline?WE((o=n).pageX,o.pageY):GE(t.getContentAreaContainer(),WE((e=n).clientX,e.clientY)):YE(t);var e,o},YE=function(t){return{anchor:"selection",root:Be.fromDom(t.selection.getNode())}},qE=function(t){return"string"==typeof t?t.split(/[ ,]/):t},KE=function(t){return t.settings.contextmenu_never_use_native||!1},JE=function(t){return e="contextmenu",o="link linkchecker image imagetools table spellchecker configurepermanentpen",r=(n=t).ui.registry.getAll().contextMenus,Pt(n.settings,e).map(qE).getOrThunk(function(){return mt(qE(o),function(t){return zt(r,t)})});var n,e,o,r},$E=function(t){return K(t)?"|"===t:"separator"===t.type},QE={type:"separator"},ZE=function(n){if(K(n))return n;switch(n.type){case"separator":return QE;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return K(t)?t:st(t,ZE)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:R(n.onAction)}}},tB=function(t,n){if(0===n.length)return t;var e=At(t).filter(function(t){return!$E(t)}).fold(function(){return[]},function(){return[QE]});return t.concat(e).concat(n).concat([QE])},nB=function(d,t,m){var g=ua(Xg.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return d.focus()},fireDismissalEventInstead:{},inlineBehaviours:Fa([_g("dismissContextMenu",[Ni(xe(),function(t){Sf.close(t),d.focus()})])])}));d.on("init",function(){d.on("contextmenu",function(n){if(t=d,!n.ctrlKey||KE(t)){var t,e,r,i,o,u=2!==n.button||n.target===d.getBody(),a=u?(e=d,{anchor:"node",node:tt.some(Be.fromDom(e.selection.getNode())),root:Be.fromDom(e.getBody())}):XE(d,n),c=d.ui.registry.getAll(),s=JE(d),f=u?d.selection.getStart(!0):n.target,l=(r=c.contextMenus,i=f,0<(o=pt(s,function(t,n){if(zt(r,n)){var e=r[n].update(i);if(K(e))return tB(t,e.split(" "));if(0<e.length){var o=st(e,ZE);return tB(t,o)}return t}return t.concat([n])},[])).length&&$E(o[o.length-1])&&o.pop(),o);Vb(l,hh.CLOSE_ON_EXECUTE,m.providers).map(function(t){n.preventDefault(),Xg.showMenuAt(g,a,{menu:{markers:Ih("normal")},data:t})})}})})},eB=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?tt.some(parseInt(t,10)):tt.none()},oB=function(t){return ot(t)?t+"px":t},rB="data-initial-z-index",iB=function(t,n){var e;t.getSystem().addToGui(n),Je((e=n).element()).each(function(n){Gu(n,"z-index").each(function(t){vo(n,rB,t)}),zu(n,"z-index",Uu(e.element(),"z-index"))})},uB=function(t){Je(t.element()).each(function(t){var n=yo(t,rB);xo(t,rB)?zu(t,"z-index",n):Yu(t,"z-index"),wo(t,rB)}),t.getSystem().removeFromGui(t)},aB=function(t,n,e,o){return(r=t,i=n,u=r.element(),a=parseInt(yo(u,i.leftAttr),10),c=parseInt(yo(u,i.topAttr),10),isNaN(a)||isNaN(c)?tt.none():tt.some(Wa(a,c))).fold(function(){return e},function(t){return _E(t.left()+o.left(),t.top()+o.top())});var r,i,u,a,c},cB=function(t,n,e,o,r,i){var u,a,c,s=aB(t,n,e,o),f=fB(t,n,s,r,i),l=OE(s,r,i);return u=n,a=l,c=t.element(),vo(c,u.leftAttr,a.left()+"px"),vo(c,u.topAttr,a.top()+"px"),f.fold(function(){return{coord:_E(l.left(),l.top()),extra:tt.none()}},function(t){return{coord:t.output(),extra:t.extra()}})},sB=function(t,n){var e,o;e=n,o=t.element(),wo(o,e.leftAttr),wo(o,e.topAttr)},fB=function(t,n,p,h,v){var e=n.getSnapPoints(t);return sn(e,function(t){var n,e,o,r,i,u,a,c,s,f,l,d,m,g=t.sensor();return n=p,e=g,o=t.range().left(),r=t.range().top(),a=TE(n,i=h,u=v),c=TE(e,i,u),Math.abs(a.left()-c.left())<=o&&Math.abs(a.top()-c.top())<=r?tt.some({output:Z((s=t.output(),f=p,l=h,d=v,m=function(o,r){return function(t,n){var e=o(f,l,d);return r(t.getOr(e.left()),n.getOr(e.top()))}},s.fold(m(EE,wE.offset),m(TE,wE.absolute),m(OE,wE.fixed)))),extra:t.extra}):tt.none()})},lB=function(e,t,i,u,a,c){return t.fold(function(){var t,e,o,n=(t=i,e=c.left(),o=c.top(),t.fold(function(t,n){return wE.offset(t+e,n+o)},function(t,n){return wE.absolute(t+e,n+o)},function(t,n){return wE.fixed(t+e,n+o)})),r=OE(n,u,a);return _E(r.left(),r.top())},function(n){var t=cB(e,n,i,c,u,a);return t.extra.each(function(t){n.onSensor(e,t)}),t.coord})},dB=function(t,n,e){var o,r=n.getTarget(t.element());if(n.repositionTarget){var i=qe(t.element()),u=qa(i),a=xE(r,u),c=Gu(o=r,"left").bind(function(e){return Gu(o,"top").bind(function(n){return Gu(o,"position").map(function(t){return("fixed"===t?_E:AE)(parseInt(e,10),parseInt(n,10))})})}).getOrThunk(function(){var t=Xa(o);return DE(t.left(),t.top())}),s=lB(t,n.snaps,c,u,a,e),f=BE(s,0,a);Lu(r,f)}n.onDrag(t,r,e)},mB=ci("snaps",[Kr("getSnapPoints"),wa("onSensor"),Kr("leftAttr"),Kr("topAttr"),si("lazyViewport",function(){var t=qa();return{x:t.left,y:t.top,width:Z(x.window.innerWidth),height:Z(x.window.innerHeight),bottom:Z(t.top()+x.window.innerHeight),right:Z(t.left()+x.window.innerWidth)}})]),gB=Object.freeze({getData:function(t){return tt.from(Wa(t.x(),t.y()))},getDelta:function(t,n){return Wa(n.left()-t.left(),n.top()-t.top())}}),pB=[si("useFixed",!1),Kr("blockerClass"),si("getTarget",U),si("onDrag",Q),si("repositionTarget",!0),wa("onDrop"),mB,Oa("dragger",{handlers:function(a,c){return Ii([Ni(hn(),function(n,t){if(0===t.event().raw().button){t.stop();var e,o={drop:function(){i()},delayDrop:function(){u.schedule()},forceDrop:function(){i()},move:function(t){u.cancel(),c.update(gB,t).each(function(t){dB(n,a,t)})}},r=n.getSystem().build(yv.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[a.blockerClass]},events:(e=o,Ii([Ni(hn(),e.forceDrop),Ni(yn(),e.drop),Ni(vn(),function(t,n){e.move(n.event())}),Ni(bn(),e.delayDrop)]))})),i=function(){uB(r),a.snaps.each(function(t){sB(n,t)});var t=a.getTarget(n.element());a.onDrop(n,t)},u=s(i,200);c.reset(),iB(n,r)}})])}})],hB=Object.freeze({getData:function(t){var n,e=t.raw().touches;return 1===e.length?(n=e[0],tt.some(Wa(n.clientX,n.clientY))):tt.none()},getDelta:function(t,n){return Wa(n.left()-t.left(),n.top()-t.top())}}),vB=pB,bB=[si("useFixed",!1),si("getTarget",U),si("onDrag",Q),si("repositionTarget",!0),si("onDrop",Q),mB,Oa("dragger",{handlers:function(e,o){return Ii([Gi(mn()),Ni(gn(),function(n,t){t.stop(),o.update(hB,t.event()).each(function(t){dB(n,e,t)})}),Ni(pn(),function(n){e.snaps.each(function(t){sB(n,t)});var t=e.getTarget(n.element());o.reset(),e.onDrop(n,t)})])}})],yB=Object.freeze({mouse:vB,touch:bB}),xB=Object.freeze({init:function(){var i=tt.none(),t=Z({});return hu({readState:t,reset:function(){i=tt.none()},update:function(r,t){return r.getData(t).bind(function(t){return n=r,e=t,o=i.map(function(t){return n.getDelta(t,e)}),i=tt.some(e),o;var n,e,o})}})}}),wB=Ha({branchKey:"mode",branches:yB,name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:Fe(["sensor","range","output"],["extra"])},state:xB});(vT=hT||(hT={}))[vT.None=0]="None",vT[vT.Both=1]="Both",vT[vT.Vertical=2]="Vertical";var SB,kB,CB,OB,TB,EB,BB=function(t,n,e,o){var r=t+n,i=e.filter(function(t){return r<t}),u=o.filter(function(t){return t<r});return i.or(u).getOr(r)},AB=function(t,n,e,o,r){var i,u,a={};return a.height=BB(o,n.top(),Cv(t),(i=t,tt.from(i.getParam("max_height")).filter(ot))),e===hT.Both&&(a.width=BB(r,n.left(),kv(t),(u=t,tt.from(u.getParam("max_width")).filter(ot)))),a},DB=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},_B=function(i,u){return u.delimiter||(u.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Fa([Um.config({mode:"flow",selector:"div[role=button]"}),Zb.config({}),qm.config({}),_g("elementPathEvents",[Yi(function(r){i.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return Um.focusIn(r)}),i.on("NodeChange",function(t){var n,o,e=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!DB(o)){var r=i.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(t.parents);0<e.length&&qm.set(r,(n=st(e||[],function(t,n){return qg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":n,"tab-index":-1,"aria-level":n+1},innerHtml:t.name},action:function(){i.focus(),i.selection.select(t.element),i.nodeChanged()}})}),o={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+u.delimiter+" "}},pt(n.slice(1),function(t,n){var e=t;return e.push(o),e.push(n),e},[n[0]])))})})])]),components:[]}},MB=function(s,t){var n,e,o,r,i,u,a,c,f,l,d,m=function(c){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize")},innerHtml:$g("resize-handle",t.icons)},behaviours:Fa([wB.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){var o,r,i,u,a;o=s,r=e,i=c,u=Be.fromDom(o.getContainer()),a=AB(o,r,i,Za(u),Ja(u)),Ft(a,function(t,n){return zu(u,n,oB(t))}),lE(o)},blockerClass:"tox-blocker"})])}};return{dom:{tag:"div",classes:["tox-statusbar"]},components:(d=[],s.getParam("elementpath",!0,"boolean")&&d.push(_B(s,{})),Kn(s.settings.plugins,"wordcount")&&d.push((u=s,a=t,f=function(t,n,e){return qm.set(t,[oa(a.translate(["{0} "+e,n[e]]))])},qg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Fa([Zb.config({}),qm.config({}),ag.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),_g("wordcount-events",[Ni(le(),function(t){var n=ag.getValue(t),e="words"===n.mode?"characters":"words";ag.setValue(t,{mode:e,count:n.count}),f(t,n.count,e)}),Yi(function(e){u.on("wordCountUpdate",function(t){var n=ag.getValue(e).mode;ag.setValue(e,{mode:n,count:t.wordCount}),f(e,t.wordCount,n)})})])]),eventOrder:(c={},c[le()]=["wordcount-events","alloy.base.behaviour"],c)}))),s.getParam("branding",!0,"boolean")&&d.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(l=Dp.translate(["Powered by {0}","Tiny"]))+'">'+l+"</a>"}}),r=0<d.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:d}]:[],e=!Kn((n=s).settings.plugins,"autoresize"),i=!1===(o=n.getParam("resize",e))?hT.None:"both"===o?hT.Both:hT.Vertical,i!==hT.None&&r.push(m(i)),r)}},FB=function(b){var t,n,e=b.getParam("inline",!1,"boolean"),y=e?UE:yE,o=tt.none(),r=Dp.isRtl()?{attributes:{dir:"rtl"}}:{},x=ua({dom:Ho({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"]},r),behaviours:Fa([tf.config({useFixed:!1})])}),i=Kg({dom:{tag:"div",classes:["tox-anchorbar"]}}),u=function(){return o.bind(function(t){return uE.getMoreButton(t)}).getOrDie("Could not find more button element")},w=function(){return o.bind(function(t){return uE.getThrobber(t)}).getOrDie("Could not find throbber element")},S=AC(x,b,function(){return o.bind(function(t){return i.getOpt(t)}).getOrDie("Could not find a anchor bar element")},u),k=function(){return Xt.value(x)},a=uE.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},getSink:k,providers:S.shared.providers,onEscape:function(){b.focus()}}),c=uE.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:k,backstage:S,onEscape:function(){b.focus()},split:Bv(b),lazyToolbar:function(){return o.bind(function(t){return uE.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyMoreButton:u}),s=uE.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),f=uE.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),l=uE.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:S}),d=b.getParam("statusbar",!0,"boolean")&&!e?tt.some(MB(b,S.shared.providers)):tt.none(),m={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[s,f]},g=(n=(t=b).getParam("toolbar"),($(n)?0<n.length:!1!==t.getParam("toolbar",!0,"boolean"))||Ov(b).isSome()),p=!1!==b.getParam("menubar",!0,"boolean"),h=xt([p?[a]:[],g?[c]:[],Dv(b)?[]:[i.asSpec()],e?[]:[m]]),v=xt([[{dom:{tag:"div",classes:["tox-editor-container"]},components:h}],e?[]:d.toArray(),[l]]),C=Ho({role:"application"},Dp.isRtl()?{dir:"rtl"}:{}),O=ua(uE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]),styles:{visibility:"hidden"},attributes:C},components:v,behaviours:Fa(y.getBehaviours(b).concat([Um.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})]))}));o=tt.some(O),b.shortcuts.add("alt+F9","focus menubar",function(){uE.focusMenubar(O)}),b.shortcuts.add("alt+F10","focus toolbar",function(){uE.focusToolbar(O)});var T=xv(O),E=xv(x);HT(b,T,E);var B=function(t){var n,e=wv.DOM,o=b.getParam("width",e.getStyle(t,"width")),r=(n=b).getParam("height",Math.max(n.getElement().offsetHeight,200)),i=kv(b),u=Cv(b),a=eB(o).bind(function(n){return oB(i.map(function(t){return Math.max(n,t)}))}).getOr(oB(o)),c=eB(r).bind(function(n){return u.map(function(t){return Math.max(n,t)})}).getOr(r),s=oB(a);if(Xu("div","width",s)&&zu(O.element(),"width",s),!b.inline){var f=oB(c);Xu("div","height",f)?zu(O.element(),"height",f):zu(O.element(),"height","200px")}return c};return{mothership:T,uiMothership:E,backstage:S,renderUI:function(){var o,r,e,n,i,u,a,c;nB(b,k,S.shared),r=(o=b).ui.registry.getAll().sidebars,ft(_t(r),function(n){var t=r[n],e=function(){return tt.from(o.queryCommandValue("ToggleSidebar")).is(n)};o.ui.registry.addToggleButton(n,{icon:t.icon,tooltip:t.tooltip,onAction:function(t){o.execCommand("ToggleSidebar",!1,n),t.setActive(e())},onSetup:function(t){var n=function(){return t.setActive(e())};return o.on("ToggleSidebar",n),function(){o.off("ToggleSidebar",n)}}})}),e=b,n=w,i=S.shared,u=an(!1),a=an(tt.none()),c=function(t){t!==u.get()&&(tE(n(),t,i.providers),u.set(t))},e.on("ProgressState",function(t){if(a.get().each(tp.clearTimeout),ot(t.time)){var n=tp.setEditorTimeout(e,function(){return c(t.state)},t.time);a.set(tt.some(n))}else c(t.state),a.set(tt.none())});var t=b.ui.registry.getAll(),s=t.buttons,f=t.menuItems,l=t.contextToolbars,d=t.sidebars,m={menuItems:f,buttons:s,menus:b.settings.menu?It(b.settings.menu,function(t){return $t(t,{items:t.items})}):{},menubar:b.settings.menubar,toolbar:Ov(b).getOr(b.getParam("toolbar",!0)),sidebar:d};RT(b,l,x,{backstage:S});var g=b.getElement(),p=B(g),h={mothership:T,uiMothership:E,outerContainer:O},v={targetNode:g,height:p};return y.render(b,h,m,S,v)},getUi:function(){return{channels:{broadcastAll:E.broadcast,broadcastOn:E.broadcastOn,register:function(){}}}}}},IB=function(n){gk.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:dT(n,t.name)})});var t="alignnone",e="No alignment",o="JustifyNone",r="align-none";n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})},VB=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},RB=function(t){var n,e;!function(n){gk.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:dT(n,t.name),onAction:VB(n,t.name)})});for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:dT(n,e),onAction:VB(n,e)})}}(t),n=t,gk.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}),e=t,gk.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:dT(e,t.name)})})},HB=function(t){var n;RB(t),n=t,gk.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:VB(n,"code")})},NB=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.readonly||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},PB=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return NB(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return NB(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return NB(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return NB(t,e,"hasRedo")},onAction:function(){
return e.execCommand("redo")}})},zB=function(t){var n,e;(n=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}}),(e=t).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,e)},onAction:function(){e.execCommand("mceToggleVisualAid")}})},LB=function(t){var n;(n=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},jB=function(t,n){var e,o,r,i,u,a,c,s,f,l,d,m,g,p,h,v,b,y,x,w;o=n,r=xT(e=t),i=gT(0,o,r.dataset,r),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return i.items.validateItems(i.getStyleItems())}}),a=n,c=ST(u=t),s=gT(0,a,c.dataset,c),u.ui.registry.addNestedMenuItem("fontformats",{text:a.shared.providers.translate("Fonts"),getSubmenuItems:function(){return s.items.validateItems(s.getStyleItems())}}),f=t,d=(l=n).styleselect,m=gT(0,l,d,ET(f)),f.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return m.items.validateItems(m.getStyleItems())}}),p=n,h=TT(g=t),v=gT(0,p,h.dataset,h),g.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return v.items.validateItems(v.getStyleItems())}}),y=n,x=CT(b=t),w=gT(0,y,x.dataset,x),b.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return w.items.validateItems(w.getStyleItems())}})},UB=function(t,n){IB(t),HB(t),jB(t,n),PB(t),Py.register(t),zB(t),LB(t)},WB=function(t,n){var e=tt.from(yo(t,"id")).fold(function(){var t=Vo("dialog-label");return vo(n,"id",t),t},U);vo(t,"aria-labelledby",e)},GB=Z([Kr("lazySink"),oi("dragBlockClass"),si("useTabstopAt",Z(!0)),si("eventOrder",{}),Bf("modalBehaviours",[Um]),Sa("onExecute"),Ca("onEscape")]),XB={sketch:U},YB=Z([rl({name:"draghandle",overrides:function(t,n){return{behaviours:Fa([wB.config({mode:"mouse",getTarget:function(t){return sa(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+mr(n,null,2)).message)})])}}}),el({schema:[Kr("dom")],name:"title"}),el({factory:XB,schema:[Kr("dom")],name:"close"}),el({factory:XB,schema:[Kr("dom")],name:"body"}),rl({factory:XB,schema:[Kr("dom")],name:"footer"}),ol({factory:{sketch:function(t,n){return Ho({},t,{dom:n.dom,components:n.components})}},schema:[si("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),si("components",[])],name:"blocker"})]),qB=_l({name:"ModalDialog",configFields:GB(),partFields:YB(),factory:function(r,t,n,o){var a=Vo("alloy.dialog.busy"),c=Vo("alloy.dialog.idle"),s=Fa([Um.config({mode:"special",onTab:function(){return tt.some(!0)},onShiftTab:function(){return tt.some(!0)}}),dg.config({})]),e=Vo("modal-events"),i=Ho({},r.eventOrder,{"alloy.system.attached":[e].concat(r.eventOrder["alloy.system.attached"]||[])});return{uid:r.uid,dom:r.dom,components:t,apis:{show:function(i){var t=r.lazySink(i).getOrDie(),u=an(tt.none()),n=o.blocker(),e=t.getSystem().build(Ho({},n,{components:n.components.concat([aa(i)]),behaviours:Fa([_g("dialog-blocker-events",[Ni(c,function(){xo(i.element(),"aria-busy")&&(wo(i.element(),"aria-busy"),u.get().each(function(t){return qm.remove(i,t)}))}),Ni(a,function(t,n){vo(i.element(),"aria-busy","true");var e=n.event().getBusySpec();u.get().each(function(t){qm.remove(i,t)});var o=e(i,s),r=t.getSystem().build(o);u.set(tt.some(r)),qm.append(i,aa(r)),r.hasConfigured(Um)&&Um.focusIn(r)})])])}));of(t,e),Um.focusIn(i)},hide:function(n){Je(n.element()).each(function(t){n.getSystem().getByDom(t).each(function(t){sf(t)})})},getBody:function(t){return vl(t,r,"body")},getFooter:function(t){return vl(t,r,"footer")},setIdle:function(t){wi(t,c)},setBusy:function(t,n){Si(t,a,{getBusySpec:n})}},eventOrder:i,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Df(r.modalBehaviours,[qm.config({}),Um.config({mode:"cyclic",onEnter:r.onExecute,onEscape:r.onEscape,useTabstopAt:r.useTabstopAt}),_g(e,[Yi(function(t){var n,e,o;WB(t.element(),vl(t,r,"title").element()),n=t.element(),e=vl(t,r,"body").element(),o=tt.from(yo(n,"id")).fold(function(){var t=Vo("dialog-describe");return vo(e,"id",t),t},U),vo(n,"aria-describedby",o)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),KB=[$r("type"),$r("text"),Qr("level",["info","warn","error","success"]),$r("icon"),si("url","")],JB=[$r("type"),$r("text"),gi("primary",!1),Br("name","name",Wo(function(){return Vo("button-name")}),Gr),ui("icon")],$B=[$r("type"),$r("name"),$r("label")],QB=Xr,ZB=[$r("type"),$r("name"),ui("label")],tA=ZB,nA=Gr,eA=ZB,oA=Gr,rA=ZB,iA=Fr(),uA=ZB.concat([gi("sandboxed",!0)]),aA=Gr,cA=ZB.concat([ui("placeholder")]),sA=Gr,fA=ZB.concat([ni("items",[$r("text"),$r("value")]),li("size",1)]),lA=Gr,dA=ZB.concat([gi("constrain",!0)]),mA=Sr([$r("width"),$r("height")]),gA=ZB.concat([ui("placeholder")]),pA=Gr,hA=ZB.concat([mi("filetype","file",["image","media","file"])]),vA=Sr([$r("value"),si("meta",{})]),bA=ZB.concat([$r("type"),di("tag","textarea"),Zr("init")]),yA=Gr,xA=[$r("type"),$r("html"),mi("presets","presentation",["presentation","document"])],wA=ZB.concat([Jr("currentState",Sr([Kr("blob"),$r("url")]))]),SA=ZB.concat([si("columns","auto")]),kA=Mr([$r("value"),$r("text"),$r("icon")]),CA=[$r("type"),ei("header",Gr),ei("cells",kr(Gr))],OA=function(n){return Br("items","items",jo(),kr(Ir(function(t){return Hr("Checking item of "+n,TA,t).fold(function(t){return Xt.error(zr(t))},function(t){return Xt.value(t)})})))},TA=Lr("type",{alertbanner:KB,bar:(OB=OA("bar"),[$r("type"),OB]),button:JB,checkbox:$B,colorinput:tA,colorpicker:eA,dropzone:rA,grid:(kB=OA("grid"),[$r("type"),(CB="columns",Jr(CB,Wr)),kB]),iframe:uA,input:cA,selectbox:fA,sizeinput:dA,textarea:gA,urlinput:hA,customeditor:bA,htmlpanel:xA,imagetools:wA,collection:SA,label:(SB=OA("label"),[$r("type"),$r("label"),SB]),table:CA}),EA=[$r("type"),ei("items",TA)],BA=[$r("title"),ei("items",TA)],AA=[$r("type"),ni("tabs",BA)],DA=[Br("name","name",Wo(function(){return Vo("button-name")}),Gr),$r("text"),ui("icon"),mi("align","end",["start","end"]),gi("primary",!1),gi("disabled",!1)],_A=Sr([Qr("type",["submit","cancel","custom"])].concat(DA)),MA=Sr([$r("title"),Jr("body",Lr("type",{panel:EA,tabpanel:AA})),di("size","normal"),ei("buttons",_A),si("initialData",{}),pi("onAction",Q),pi("onChange",Q),pi("onSubmit",Q),pi("onClose",Q),pi("onCancel",Q),si("onTabChange",Q)]),FA=function(t){return J(t)?[t].concat(wt(Nt(t),FA)):$(t)?wt(t,FA):[]},IA=function(t){return K(t.type)&&K(t.name)},VA={checkbox:QB,colorinput:nA,colorpicker:oA,dropzone:iA,input:sA,iframe:aA,sizeinput:mA,selectbox:lA,size:mA,textarea:pA,urlinput:vA,customeditor:yA,collection:kA},RA=function(t){var n=wt(mt(FA(t),IA),function(n){return(t=n,tt.from(VA[t.type])).fold(function(){return[]},function(t){return[Jr(n.name,t)]});var t});return Sr(n)},HA=Sr([Qr("type",["cancel","custom"])].concat(DA)),NA=Sr([$r("title"),$r("url"),ii("height"),ii("width"),(TB="buttons",EB=HA,ri(TB,kr(EB))),pi("onAction",Q),pi("onCancel",Q),pi("onClose",Q),pi("onMessage",Q)]),PA=function(t){return{internalDialog:Nr(Hr("dialog",MA,t)),dataValidator:RA(t),initialData:t.initialData}},zA={open:function(t,n){var e=PA(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Nr(Hr("dialog",NA,n)))},redial:function(t){return PA(t)}},LA=function(t){var e=[],o={};return Ft(t,function(t,n){t.fold(function(){e.push(n)},function(t){o[n]=t})}),0<e.length?Xt.error(e):Xt.value(o)},jA=Dl({name:"TabButton",configFields:[si("uid",undefined),Kr("value"),Br("dom","dom",Go(function(){return{attributes:{role:"tab",id:Vo("aria"),"aria-selected":"false"}}}),jr()),oi("action"),si("domModification",{}),Bf("tabButtonBehaviours",[dg,Um,ag]),Kr("view")],factory:function(t){return{uid:t.uid,dom:t.dom,components:t.components,events:Yg(t.action),behaviours:Df(t.tabButtonBehaviours,[dg.config({}),Um.config({mode:"execution",useSpace:!0,useEnter:!0}),ag.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),UA=Z([Kr("tabs"),Kr("dom"),si("clickToDismiss",!1),Bf("tabbarBehaviours",[ql,Um]),ya(["tabClass","selectedClass"])]),WA=il({factory:jA,name:"tabs",unit:"tab",overrides:function(o){var r=function(t,n){ql.dehighlight(t,n),Si(t,Ce(),{tabbar:t,button:n})},i=function(t,n){ql.highlight(t,n),Si(t,ke(),{tabbar:t,button:n})};return{action:function(t){var n=t.getSystem().getByUid(o.uid).getOrDie(),e=ql.isHighlighted(n,t);(e&&o.clickToDismiss?r:e?Q:i)(n,t)},domModification:{classes:[o.markers.tabClass]}}}}),GA=Z([WA]),XA=_l({name:"Tabbar",configFields:UA(),partFields:GA(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Df(t.tabbarBehaviours,[ql.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){vo(n.element(),"aria-selected","true")},onDehighlight:function(t,n){vo(n.element(),"aria-selected","false")}}),Um.config({mode:"flow",getInitial:function(t){return ql.getHighlighted(t).map(function(t){return t.element()})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),YA=Dl({name:"Tabview",configFields:[Bf("tabviewBehaviours",[qm])],factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Df(t.tabviewBehaviours,[qm.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),qA=Z([si("selectFirst",!0),wa("onChangeTab"),wa("onDismissTab"),si("tabs",[]),Bf("tabSectionBehaviours",[])]),KA=el({factory:XA,schema:[Kr("dom"),ti("markers",[Kr("tabClass"),Kr("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),JA=el({factory:YA,name:"tabview"}),$A=Z([KA,JA]),QA=_l({name:"TabSection",configFields:qA(),partFields:$A(),factory:function(i,t){var n=function(t,n){hl(t,i,"tabbar").each(function(t){n(t).each(ki)})};return{uid:i.uid,dom:i.dom,components:t,behaviours:Af(i.tabSectionBehaviours),events:Ii(xt([i.selectFirst?[Yi(function(t){n(t,ql.getFirst)})]:[],[Ni(ke(),function(t,n){var o,r,e=n.event().button();o=e,r=ag.getValue(o),hl(o,i,"tabview").each(function(e){ht(i.tabs,function(t){return t.value===r}).each(function(t){var n=t.view();vo(e.element(),"aria-labelledby",yo(o.element(),"id")),qm.set(e,n),i.onChangeTab(e,o,n)})})}),Ni(Ce(),function(t,n){var e=n.event().button();i.onDismissTab(t,e)})]])),apis:{getViewItems:function(t){return hl(t,i,"tabview").map(function(t){return qm.contents(t)}).getOr([])},showTab:function(t,e){n(t,function(n){var t=ql.getCandidates(n);return ht(t,function(t){return ag.getValue(t)===e}).filter(function(t){return!ql.isHighlighted(n,t)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),ZA=function(i,u,t){sa(i,'[role="dialog"]').each(function(r){t.get().map(function(t){return zu(u,"height","0"),Math.min(t,(e=i,o=sa(n=r,".tox-dialog-wrap").getOr(n),("fixed"===Uu(o,"position")?Math.max(x.document.documentElement.clientHeight,x.window.innerHeight):Math.max(x.document.documentElement.offsetHeight,x.document.documentElement.scrollHeight))-(n.dom().getBoundingClientRect().height-e.dom().getBoundingClientRect().height)));var n,e,o}).each(function(t){zu(u,"height",t+"px")})})},tD=function(a){var c;return{smartTabHeight:(c=an(tt.none()),{extraEvents:[Yi(function(t){fa(t.element(),'[role="tabpanel"]').each(function(u){var n;zu(u,"visibility","hidden"),t.getSystem().getByDom(u).toOption().each(function(t){var o,r,i,n=(r=u,i=t,st(o=a,function(t,n){qm.set(i,o[n].view());var e=r.dom().getBoundingClientRect();return qm.set(i,[]),e.height})),e=Bt(Et(n,function(t,n){return n<t?-1:t<n?1:0}));c.set(e)}),ZA(t.element(),u,c),Yu(u,"visibility"),n=t,Bt(a).each(function(t){return QA.showTab(n,t.value)}),tp.requestAnimationFrame(function(){ZA(t.element(),u,c)})})}),Ni(ve(),function(n){fa(n.element(),'[role="tabpanel"]').each(function(t){ZA(n.element(),t,c)})}),Ni(Pv,function(r){fa(r.element(),'[role="tabpanel"]').each(function(n){var t=ad();zu(n,"visibility","hidden");var e=Gu(n,"height").map(function(t){return parseInt(t,10)});Yu(n,"height");var o=n.dom().getBoundingClientRect().height;e.forall(function(t){return t<o})?(c.set(tt.from(o)),ZA(r.element(),n,c)):e.each(function(t){zu(n,"height",t+"px")}),Yu(n,"visibility"),t.each(ud)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},nD="send-data-to-section",eD="send-data-to-view",oD=Vo("update-dialog"),rD=Vo("update-title"),iD=Vo("update-body"),uD=Vo("update-footer"),aD=Vo("body-send-message"),cD=function(t,n,d,e){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:Ho({},n.map(function(t){return{id:t}}).getOr({}),e?{"aria-live":"polite"}:{})},components:[],behaviours:Fa([$w(0),RO.config({channel:iD,updateState:function(t,n){return tt.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(r={tabs:t.body.tabs},i=d,u=an({}),a=function(t){var n=ag.getValue(t),e=LA(n).getOr({}),o=u.get(),r=Jt(o,e);u.set(r)},c=function(t){var n=u.get();ag.setValue(t,n)},s=an(null),f=st(r.tabs,function(t){return{value:t.title,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:i.shared.providers.translate(t.title)},view:function(){return[Lw.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:st(t.items,function(t){return Lk(n,t,i)}),formBehaviours:Fa([Um.config({mode:"acyclic",useTabstopAt:N(dS)}),_g("TabView.form.events",[Yi(c),qi(a)]),La.config({channels:on([{key:nD,value:{onReceive:a}},{key:eD,value:{onReceive:c}}])})])}})]}}}),l=tD(f).smartTabHeight,QA.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n){var e=ag.getValue(n);Si(t,Nv,{title:e,oldTitle:s.get()}),s.set(e)},tabs:f,components:[QA.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[XA.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Fa([Zb.config({})])}),QA.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:l.selectFirst,tabSectionBehaviours:Fa([_g("tabpanel",l.extraEvents),Um.config({mode:"acyclic"}),Vl.config({find:function(t){return Bt(QA.getViewItems(t))}}),ag.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([nD],{}),u.get()},setValue:function(t,n){u.set(n),t.getSystem().broadcastOn([eD],{})}}})])}))];default:return[(e={items:t.body.items},o=d,n=Kg(Lw.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:st(e.items,function(t){return Lk(n,t,o)})}})),{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[n.asSpec()]}],behaviours:Fa([Um.config({mode:"acyclic",useTabstopAt:N(dS)}),Jw(n),oS(n,{postprocess:function(t){return LA(t).fold(function(t){return x.console.error(t),{}},function(t){return t})}})])})]}var e,o,n,r,i,u,a,c,s,f,l},initialData:t})])}},sD=function(t,e){return[Ui(wn(),mS),t(Mv,function(t,n){e.onClose(),n.onClose()}),t(Fv,function(t,n,e,o){n.onCancel(t),wi(o,Mv)}),Ni(Hv,function(){return e.onUnblock()}),Ni(Rv,function(t,n){return e.onBlock(n.event())})]},fD=function(r,t){var n=function(t,o){return Ni(t,function(n,e){i(n,function(t){o(r(),t,e.event(),n)})})},i=function(n,e){RO.getState(n).get().each(function(t){e(t,n)})};return sD(n,t).concat([n(Iv,function(t,n,e){n.onAction(t,{name:e.name()})})])},lD=function(r,t){var n=function(t,o){return Ni(t,function(n,e){i(n,function(t){o(r(),t,e.event(),n)})})},i=function(n,e){RO.getState(n).get().each(function(t){e(t.internalDialog,n)})};return sD(n,t).concat([n(Vv,function(t,n){return n.onSubmit(t)}),n(_v,function(t,n,e){n.onChange(t,{name:e.name()})}),n(Iv,function(t,n,e){n.onAction(t,{name:e.name(),value:e.value()})}),n(Nv,function(t,n,e){n.onTabChange(t,e.title())}),qi(function(t){var n=r();ag.setValue(t,n.getData())})])},dD=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),o=dt(e,function(t){return"start"===t.align}),r=function(t,n){return yv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:st(n,function(t){return t.memento.asSpec()})})};return[r("start",o.pass),r("end",o.fail)]},mD=function(t,i){return{dom:Ap('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Fa([RO.config({channel:uD,initialData:t,updateState:function(t,n){var r=st(n.buttons,function(t){var n,e,o=Kg((e=i,KS(n=t,n.type,e)));return{name:t.name,align:t.align,memento:o}});return tt.some({lookupByName:function(t,n){return e=t,o=n,ht(r,function(t){return t.name===o}).bind(function(t){return t.memento.getOpt(e)});var e,o},footerButtons:r})},renderComponents:dD})])}},gD=function(t,n){return qB.parts().footer(mD(t,n))},pD=function(n,e){if(n.getRoot().getSystem().isConnected()){var o=Vl.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return Lw.getField(o,e).fold(function(){var t=n.getFooter();return RO.getState(t).get().bind(function(t){return t.lookupByName(o,e)})},function(t){return tt.some(t)})}return tt.none()},hD=function(a,o){var t=function(t){var n=a.getRoot();n.getSystem().isConnected()&&t(n)},c={getData:function(){var t=a.getRoot(),n=t.getSystem().isConnected()?a.getFormWrapper():t;return ag.getValue(n)},setData:function(u){t(function(){var n,t,e=c.getData(),o=$t(e,u),r=(n=o,t=a.getRoot(),RO.getState(t).get().map(function(t){return Nr(Hr("data",t.dataValidator,n))}).getOr(n)),i=a.getFormWrapper();ag.setValue(i,r)})},disable:function(t){pD(a,t).each(ah.disable)},enable:function(t){pD(a,t).each(ah.enable)},focus:function(t){pD(a,t).each(dg.focus)},block:function(n){if(!K(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t(function(t){Si(t,Rv,{message:n})})},unblock:function(){t(function(t){wi(t,Hv)})},showTab:function(n){t(function(){var t=a.getBody();RO.getState(t).get().exists(function(t){return t.isTabPanel()})&&Vl.getCurrent(t).each(function(t){QA.showTab(t,n)})})},redial:function(e){t(function(t){var n=o(e);t.getSystem().broadcastOn([oD],n),t.getSystem().broadcastOn([rD],n.internalDialog),t.getSystem().broadcastOn([iD],n.internalDialog),t.getSystem().broadcastOn([uD],n.internalDialog),c.setData(n.initialData)})},close:function(){t(function(t){wi(t,Mv)})}};return c},vD=function(t){return qg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){wi(t,Fv)}})},bD=function(t,n,e){var o=function(t){return[oa(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:Ho({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:Fa([RO.config({channel:rD,renderComponents:o})])}},yD=function(t,n){return e={title:n.shared.providers.translate(t),draggable:!0},o=n.shared.providers,r=qB.parts().title(bD(e,tt.none(),o)),i=qB.parts().draghandle({dom:Ap('<div class="tox-dialog__draghandle"></div>')}),u=qB.parts().close(vD(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),yv.sketch({dom:Ap('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},xD=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(e){qB.setBusy(t(),function(t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:Ap('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})},onUnblock:function(){qB.setIdle(t())}}},wD=function(t,n,e,o){var r;return ua(qB.sketch({lazySink:o.shared.getSink,onEscape:function(t){return wi(t,Fv),tt.some(!0)},useTabstopAt:function(t){return!dS(t)&&("button"!==so(t)||"disabled"!==yo(t,"disabled"))},modalBehaviours:Fa([RO.config({channel:oD,updateState:function(t,n){return tt.some(n)},initialData:n}),uS({}),dg.config({}),_g("execute-on-form",e.concat([Xi(wn(),function(t){Um.focusIn(t)})])),_g("scroll-lock",[Yi(function(){Mu(Bi(),"tox-dialog__disable-scroll")}),qi(function(){Fu(Bi(),"tox-dialog__disable-scroll")})])].concat(t.extraBehaviours)),eventOrder:(r={},r[ce()]=["execute-on-form"],r[ae()]=["reflecting","receiving"],r[be()]=["scroll-lock","reflecting","messages","execute-on-form","alloy.base.behaviour"],r[ye()]=["alloy.base.behaviour","execute-on-form","messages","reflecting","scroll-lock"],r),dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses),styles:Ho({position:"relative"},t.extraStyles)},components:[t.header,t.body].concat(t.footer.toArray()),dragBlockClass:"tox-dialog-wrap",parts:{blocker:{dom:Ap('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}}}))},SD=function(t,n,e){var o,r,i,u=yD(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=cD(o,tt.none(),r,!1),qB.parts().body(i)),c=gD({buttons:t.internalDialog.buttons},e.shared.providers),s=lD(function(){return m},xD(function(){return d},n)),f="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],l={header:u,body:a,footer:tt.some(c),extraClasses:f,extraBehaviours:[],extraStyles:{}},d=wD(l,t,s,e),m=hD({getRoot:function(){return d},getBody:function(){return qB.getBody(d)},getFooter:function(){return qB.getFooter(d)},getFormWrapper:function(){var t=qB.getBody(d);return Vl.getCurrent(t).getOr(t)}},n.redial);return{dialog:d,instanceApi:m}},kD=tinymce.util.Tools.resolve("tinymce.util.URI"),CD=["insertContent","setContent","execCommand","close","block","unblock"],OD=function(t){return J(t)&&-1!==CD.indexOf(t.mceAction)},TD=function(o,t,r,n){var e,i,u,a,c=yD(o.title,n),s=(i={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[gS({dom:{tag:"iframe",attributes:{src:o.url}},behaviours:Fa([Zb.config({}),dg.config({})])})]}],behaviours:Fa([Um.config({mode:"acyclic",useTabstopAt:N(dS)})])},qB.parts().body(i)),f=o.buttons.bind(function(t){return 0===t.length?tt.none():tt.some(gD({buttons:t},n.shared.providers))}),l=fD(function(){return y},xD(function(){return b},t)),d=Ho({},o.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}}),o.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),m=o.width.isNone()&&o.height.isNone()?["tox-dialog--width-lg"]:[],g=new kD(o.url,{base_uri:new kD(x.window.location.href)}),p=g.protocol+"://"+g.host+(g.port?":"+g.port:""),h=an(tt.none()),v=[_g("messages",[Yi(function(){var t=ov(Be.fromDom(x.window),"message",function(t){if(g.isSameOrigin(new kD(t.raw().origin))){var n=t.raw().data;OD(n)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!nt(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(r,y,n):!OD(e=n)&&J(e)&&zt(e,"mceAction")&&o.onMessage(y,n)}var e});h.set(tt.some(t))}),qi(function(){h.get().each(function(t){return t.unbind()})})]),La.config({channels:(e={},e[aD]={onReceive:function(t,n){fa(t.element(),"iframe").each(function(t){t.dom().contentWindow.postMessage(n,p)})}},e)})],b=wD({header:c,body:s,footer:f,extraClasses:m,extraBehaviours:v,extraStyles:d},o,l,n),y=(u=b,a=function(t){u.getSystem().isConnected()&&t(u)},{block:function(n){if(!K(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");a(function(t){Si(t,Rv,{message:n})})},unblock:function(){a(function(t){wi(t,Hv)})},close:function(){a(function(t){wi(t,Mv)})},sendMessage:function(n){a(function(t){t.getSystem().broadcastOn([aD],n)})}});return{dialog:b,instanceApi:y}},ED=function(t,n,e,o){var r,i,u,a,c,s,f,l,d,m,g,p=Vo("dialog-label"),h=Vo("dialog-content"),v=Kg((u={title:t.internalDialog.title,draggable:!0},a=p,c=e.shared.providers,yv.sketch({dom:Ap('<div class="tox-dialog__header"></div>'),components:[bD(u,tt.some(a),c),vD(c)],containerBehaviours:Fa([wB.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return la(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),b=Kg((s={body:t.internalDialog.body},f=h,l=e,d=o,cD(s,tt.some(f),l,d))),y=Kg((m={buttons:t.internalDialog.buttons},g=e.shared.providers,mD(m,g))),x=lD(function(){return S},{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}}),w=ua({dom:{tag:"div",classes:["tox-dialog"],attributes:(r={role:"dialog"},r["aria-labelledby"]=p,r["aria-describedby"]=""+h,r)},eventOrder:(i={},i[ae()]=[RO.name(),La.name()],i[ce()]=["execute-on-form"],i[be()]=["reflecting","execute-on-form"],i),behaviours:Fa([Um.config({mode:"cyclic",onEscape:function(t){return wi(t,Mv),tt.some(!0)},useTabstopAt:function(t){return!dS(t)&&("button"!==so(t)||"disabled"!==yo(t,"disabled"))}}),RO.config({channel:oD,updateState:function(t,n){return tt.some(n)},initialData:t}),_g("execute-on-form",x),uS({})]),components:[v.asSpec(),b.asSpec(),y.asSpec()]}),S=hD({getRoot:function(){return w},getFooter:function(){return y.get(w)},getBody:function(){return b.get(w)},getFormWrapper:function(){var t=b.get(w);return Vl.getCurrent(t).getOr(t)}},n.redial);return{dialog:w,instanceApi:S}},BD=function(t,n){return qB.parts().close(qg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Fa([Zb.config({})])}))},AD=function(){return qB.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},DD=function(t,n){return qB.parts().body({dom:{tag:"div",classes:["tox-dialog__body","todo-tox-fit"]},components:[{dom:Ap("<p>"+n.translate(t)+"</p>")}]})},_D=function(t){return qB.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},MD=function(t,n){return[yv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),yv.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},FD=function(t){return qB.sketch({lazySink:t.lazySink,onEscape:function(){return t.onCancel(),tt.some(!0)},dom:{tag:"div",classes:["tox-dialog"].concat(t.extraClasses)},components:[{dom:{tag:"div",classes:["tox-dialog__header"]},components:[t.partSpecs.title,t.partSpecs.close]},t.partSpecs.body,t.partSpecs.footer],parts:{blocker:{dom:Ap('<div class="tox-dialog-wrap"></div>'),components:[{dom:{tag:"div",classes:["tox-dialog-wrap__backdrop"]}}]}},modalBehaviours:Fa([_g("basic-dialog-events",[Ni(Fv,function(){t.onCancel()}),Ni(Vv,function(){t.onSubmit()})])])})},ID=function(s){var u,a,e=(u=s.backstage.shared,{open:function(t,n){var e=function(){qB.hide(r),n()},o=Kg(KS({name:"close-alert",text:"OK",primary:!0,icon:tt.none()},"cancel",u.providers)),r=ua(FD({lazySink:function(){return u.getSink()},partSpecs:{title:AD(),close:BD(function(){e()},u.providers),body:DD(t,u.providers),footer:_D(MD([],[o.asSpec()]))},onCancel:function(){return e()},onSubmit:Q,extraClasses:["tox-alert-dialog"]}));qB.show(r);var i=o.get(r);dg.focus(i)}}),o=(a=s.backstage.shared,{open:function(t,n){var e=function(t){qB.hide(i),n(t)},o=Kg(KS({name:"yes",text:"Yes",primary:!0,icon:tt.none()},"submit",a.providers)),r=KS({name:"no",text:"No",primary:!0,icon:tt.none()},"cancel",a.providers),i=ua(FD({lazySink:function(){return a.getSink()},partSpecs:{title:AD(),close:BD(function(){e(!1)},a.providers),body:DD(t,a.providers),footer:_D(MD([],[r,o.asSpec()]))},onCancel:function(){return e(!1)},onSubmit:function(){return e(!0)},extraClasses:["tox-confirm-dialog"]}));qB.show(i);var u=o.get(i);dg.focus(u)}}),r=function(t,e){return zA.openUrl(function(t){var n=TD(t,{closeWindow:function(){qB.hide(n.dialog),e(n.instanceApi)}},s.editor,s.backstage);return qB.show(n.dialog),n.instanceApi},t)},i=function(t,i){return zA.open(function(t,n,e){var o=n,r=SD({dataValidator:e,initialData:o,internalDialog:t},{redial:zA.redial,closeWindow:function(){qB.hide(r.dialog),i(r.instanceApi)}},s.backstage);return qB.show(r.dialog),r.instanceApi.setData(o),r.instanceApi},t)},c=function(t,u,a,c){return zA.open(function(t,n,e){var o=Nr(Hr("data",e,n)),r=ED({dataValidator:e,initialData:o,internalDialog:t},{redial:zA.redial,closeWindow:function(){Xg.hide(i),a(r.instanceApi)}},s.backstage,c),i=ua(Xg.sketch({lazySink:s.backstage.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:Fa([_g("window-manager-inline-events",[Ni(xe(),function(){wi(r.dialog,Fv)})])])}));return Xg.showAt(i,u,aa(r.dialog)),r.instanceApi.setData(o),Um.focusIn(r.dialog),r.instanceApi},t)};return{open:function(t,n,e){return n!==undefined&&"toolbar"===n.inline?c(t,s.backstage.shared.anchors.toolbar(),e,n.ariaAttrs):n!==undefined&&"cursor"===n.inline?c(t,s.backstage.shared.anchors.cursor(),e,n.ariaAttrs):i(t,e)},openUrl:function(t,n){return r(t,n)},alert:function(t,n){e.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){o.open(t,function(t){n(t)})}}};Ro.add("silver",function(t){var n=FB(t),e=n.mothership,o=n.uiMothership,r=n.backstage,i=n.renderUI,u=n.getUi;UB(t,r),Mo(Vo("silver-demo"),e),Mo(Vo("silver-ui-demo"),o),Qh(t,r.shared);var a=ID({editor:t,backstage:r});return{renderUI:i,getWindowManagerImpl:Z(a),getNotificationManagerImpl:function(){return c(t,{backstage:r},o)},ui:u()}}),function T_(){}}(window);